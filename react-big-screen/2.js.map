{"version":3,"sources":["webpack://react-big-screen-[name]/./utils/flexible.js"],"names":["win","lib","tid","doc","document","docEl","documentElement","metaEl","querySelector","flexibleEl","dpr","scale","flexible","console","warn","match","getAttribute","parseFloat","parseInt","content","initialDpr","maximumDpr","toFixed","navigator","appVersion","isIPhone","devicePixelRatio","setAttribute","createElement","firstElementChild","appendChild","wrap","write","innerHTML","refreshRem","width","getBoundingClientRect","rem","style","fontSize","addEventListener","clearTimeout","setTimeout","e","persisted","readyState","body","rem2px","d","val","this","px2rem","window"],"mappings":"oHAAA,SAAUA,EAAKC,GACb,IAMIC,EANAC,EAAMH,EAAII,SACVC,EAAQF,EAAIG,gBACZC,EAASJ,EAAIK,cAAc,yBAC3BC,EAAaN,EAAIK,cAAc,yBAC/BE,EAAM,EACNC,EAAQ,EAERC,EAAWX,EAAIW,WAAaX,EAAIW,SAAW,IAE/C,GAAIL,EAAQ,CACVM,QAAQC,KAAK,uBACb,IAAIC,EAAQR,EACTS,aAAa,WAEbD,MAAM,4BACLA,IACFJ,EAAQM,WAAWF,EAAM,IACzBL,EAAMQ,SAAS,EAAIP,SAEhB,GAAIF,EAAY,CACrB,IAAIU,EAAUV,EAAWO,aAAa,WACtC,GAAIG,EAAS,CAEX,IAAIC,EAAaD,EAAQJ,MAAM,0BAE3BM,EAAaF,EAAQJ,MAAM,0BAC3BK,IACFV,EAAMO,WAAWG,EAAW,IAC5BT,EAAQM,YAAY,EAAIP,GAAKY,QAAQ,KAEnCD,IACFX,EAAMO,WAAWI,EAAW,IAC5BV,EAAQM,YAAY,EAAIP,GAAKY,QAAQ,MAK3C,IAAKZ,IAAQC,EAAO,CAEFX,EAAIuB,UAAUC,WAAWT,MAAM,aAA/C,IACIU,EAAWzB,EAAIuB,UAAUC,WAAWT,MAAM,YAC1CW,EAAmB1B,EAAI0B,iBAc3Bf,EAAQ,GAVJD,EAHAe,EAEEC,GAAoB,KAAOhB,GAAOA,GAAO,GACrC,EACGgB,GAAoB,KAAOhB,GAAOA,GAAO,GAC5C,EAEA,EAIF,GAMV,GADAL,EAAMsB,aAAa,WAAYjB,IAC1BH,EAaH,IAZAA,EAASJ,EAAIyB,cAAc,SACpBD,aAAa,OAAQ,YAC5BpB,EAAOoB,aACL,UACA,iBACEhB,EACA,mBACAA,EACA,mBACAA,EACA,sBAEAN,EAAMwB,kBACRxB,EAAMwB,kBAAkBC,YAAYvB,OAC/B,CACL,IAAIwB,EAAO5B,EAAIyB,cAAc,OAC7BG,EAAKD,YAAYvB,GACjBJ,EAAI6B,MAAMD,EAAKE,WAInB,SAASC,IACP,IAAIC,EAAQ9B,EAAM+B,wBAAwBD,MAEtCA,EAAQzB,EAAM,KAChByB,EAAQ,KAAOzB,EACNyB,EAAQzB,EAAM,OACvByB,EAAQ,KAAOzB,GAGjB,IAAI2B,EAAMF,EAAQ,GAClB9B,EAAMiC,MAAMC,SAAWF,EAAM,KAC7BzB,EAASyB,IAAMrC,EAAIqC,IAAMA,EAG3BrC,EAAIwC,iBACF,UACA,WACEC,aAAavC,GACbA,EAAMwC,WAAWR,EAAY,QAE/B,GAEFlC,EAAIwC,iBACF,YACA,SAASG,GACHA,EAAEC,YACJH,aAAavC,GACbA,EAAMwC,WAAWR,EAAY,SAGjC,GAGqB,aAAnB/B,EAAI0C,WACN1C,EAAI2C,KAAKR,MAAMC,SAAW,GAAK7B,EAAM,KAErCP,EAAIqC,iBACF,oBAEA,SAASG,GACPxC,EAAI2C,KAAKR,MAAMC,SAAW,GAAK7B,EAAM,QAEvC,GAIJwB,IAEAtB,EAASF,IAAMV,EAAIU,IAAMA,EACzBE,EAASsB,WAAaA,EACtBtB,EAASmC,OAAS,SAASC,GACzB,IAAIC,EAAMhC,WAAW+B,GAAKE,KAAKb,IAI/B,MAHiB,iBAANW,GAAkBA,EAAEjC,MAAM,UACnCkC,GAAO,MAEFA,GAETrC,EAASuC,OAAS,SAASH,GACzB,IAAIC,EAAMhC,WAAW+B,GAAKE,KAAKb,IAI/B,MAHiB,iBAANW,GAAkBA,EAAEjC,MAAM,SACnCkC,GAAO,OAEFA,GAhJX,CAkJGG,OAAQA,OAAY,MAAMA,OAAY,IAAI","file":"2.js","sourcesContent":["(function(win, lib) {\r\n  var doc = win.document;\r\n  var docEl = doc.documentElement;\r\n  var metaEl = doc.querySelector('meta[name=\"viewport\"]');\r\n  var flexibleEl = doc.querySelector('meta[name=\"flexible\"]');\r\n  var dpr = 0;\r\n  var scale = 0;\r\n  var tid;\r\n  var flexible = lib.flexible || (lib.flexible = {});\r\n\r\n  if (metaEl) {\r\n    console.warn(\"将根据已有的meta标签来设置缩放比例\");\r\n    var match = metaEl\r\n      .getAttribute(\"content\")\r\n      // eslint-disable-next-line no-useless-escape\r\n      .match(/initial\\-scale=([\\d\\.]+)/);\r\n    if (match) {\r\n      scale = parseFloat(match[1]);\r\n      dpr = parseInt(1 / scale);\r\n    }\r\n  } else if (flexibleEl) {\r\n    var content = flexibleEl.getAttribute(\"content\");\r\n    if (content) {\r\n      // eslint-disable-next-line no-useless-escape\r\n      var initialDpr = content.match(/initial\\-dpr=([\\d\\.]+)/);\r\n      // eslint-disable-next-line no-useless-escape\r\n      var maximumDpr = content.match(/maximum\\-dpr=([\\d\\.]+)/);\r\n      if (initialDpr) {\r\n        dpr = parseFloat(initialDpr[1]);\r\n        scale = parseFloat((1 / dpr).toFixed(2));\r\n      }\r\n      if (maximumDpr) {\r\n        dpr = parseFloat(maximumDpr[1]);\r\n        scale = parseFloat((1 / dpr).toFixed(2));\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!dpr && !scale) {\r\n    // eslint-disable-next-line no-unused-vars\r\n    var isAndroid = win.navigator.appVersion.match(/android/gi);\r\n    var isIPhone = win.navigator.appVersion.match(/iphone/gi);\r\n    var devicePixelRatio = win.devicePixelRatio;\r\n    if (isIPhone) {\r\n      // iOS下，对于2和3的屏，用2倍的方案，其余的用1倍方案\r\n      if (devicePixelRatio >= 3 && (!dpr || dpr >= 3)) {\r\n        dpr = 3;\r\n      } else if (devicePixelRatio >= 2 && (!dpr || dpr >= 2)) {\r\n        dpr = 2;\r\n      } else {\r\n        dpr = 1;\r\n      }\r\n    } else {\r\n      // 其他设备下，仍旧使用1倍的方案\r\n      dpr = 1;\r\n    }\r\n    scale = 1 / dpr;\r\n  }\r\n\r\n  docEl.setAttribute(\"data-dpr\", dpr);\r\n  if (!metaEl) {\r\n    metaEl = doc.createElement(\"meta\");\r\n    metaEl.setAttribute(\"name\", \"viewport\");\r\n    metaEl.setAttribute(\r\n      \"content\",\r\n      \"initial-scale=\" +\r\n        scale +\r\n        \", maximum-scale=\" +\r\n        scale +\r\n        \", minimum-scale=\" +\r\n        scale +\r\n        \", user-scalable=no\"\r\n    );\r\n    if (docEl.firstElementChild) {\r\n      docEl.firstElementChild.appendChild(metaEl);\r\n    } else {\r\n      var wrap = doc.createElement(\"div\");\r\n      wrap.appendChild(metaEl);\r\n      doc.write(wrap.innerHTML);\r\n    }\r\n  }\r\n\r\n  function refreshRem() {\r\n    var width = docEl.getBoundingClientRect().width;\r\n    // 最小1366px，最大适配2560px\r\n    if (width / dpr < 1366) {\r\n      width = 1366 * dpr;\r\n    } else if (width / dpr > 2560) {\r\n      width = 2560 * dpr;\r\n    }\r\n    // 设置成24等份，设计稿时1920px的，这样1rem就是80px\r\n    var rem = width / 24;\r\n    docEl.style.fontSize = rem + \"px\";\r\n    flexible.rem = win.rem = rem;\r\n  }\r\n\r\n  win.addEventListener(\r\n    \"resize\",\r\n    function() {\r\n      clearTimeout(tid);\r\n      tid = setTimeout(refreshRem, 300);\r\n    },\r\n    false\r\n  );\r\n  win.addEventListener(\r\n    \"pageshow\",\r\n    function(e) {\r\n      if (e.persisted) {\r\n        clearTimeout(tid);\r\n        tid = setTimeout(refreshRem, 300);\r\n      }\r\n    },\r\n    false\r\n  );\r\n\r\n  if (doc.readyState === \"complete\") {\r\n    doc.body.style.fontSize = 12 * dpr + \"px\";\r\n  } else {\r\n    doc.addEventListener(\r\n      \"DOMContentLoaded\",\r\n      // eslint-disable-next-line no-unused-vars\r\n      function(e) {\r\n        doc.body.style.fontSize = 12 * dpr + \"px\";\r\n      },\r\n      false\r\n    );\r\n  }\r\n\r\n  refreshRem();\r\n\r\n  flexible.dpr = win.dpr = dpr;\r\n  flexible.refreshRem = refreshRem;\r\n  flexible.rem2px = function(d) {\r\n    var val = parseFloat(d) * this.rem;\r\n    if (typeof d === \"string\" && d.match(/rem$/)) {\r\n      val += \"px\";\r\n    }\r\n    return val;\r\n  };\r\n  flexible.px2rem = function(d) {\r\n    var val = parseFloat(d) / this.rem;\r\n    if (typeof d === \"string\" && d.match(/px$/)) {\r\n      val += \"rem\";\r\n    }\r\n    return val;\r\n  };\r\n})(window, window[\"lib\"] || (window[\"lib\"] = {}));\r\n"],"sourceRoot":""}