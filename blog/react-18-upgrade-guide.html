<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>如何升级到 React 18发布候选版 </title><meta name="robots" content="follow, index"/><meta name="description" content="上周 react 官网 发布了react@rc 版本，该版本是候选版本(Release Candidate)，这意味API已经基本稳定，跟最终版本不会有太大差别，官网也发布博客《如何升级到 react18 RC 版本》，鼓励大家尝试升级，所以我们可以在项目组中使用了！下面内容来自是官方文档的翻译。"/><meta property="og:url" content="https://github.com/balac2015/blog/react-18-upgrade-guide"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Coding 工坊 | 随风"/><meta property="og:description" content="上周 react 官网 发布了react@rc 版本，该版本是候选版本(Release Candidate)，这意味API已经基本稳定，跟最终版本不会有太大差别，官网也发布博客《如何升级到 react18 RC 版本》，鼓励大家尝试升级，所以我们可以在项目组中使用了！下面内容来自是官方文档的翻译。"/><meta property="og:title" content="如何升级到 React 18发布候选版 "/><meta property="og:image" content="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ca9595ccd1479f86d71903184a4d0b~tplv-k3u1fbpfcp-watermark.image?"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="如何升级到 React 18发布候选版 "/><meta name="twitter:description" content="上周 react 官网 发布了react@rc 版本，该版本是候选版本(Release Candidate)，这意味API已经基本稳定，跟最终版本不会有太大差别，官网也发布博客《如何升级到 react18 RC 版本》，鼓励大家尝试升级，所以我们可以在项目组中使用了！下面内容来自是官方文档的翻译。"/><meta name="twitter:image" content="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ca9595ccd1479f86d71903184a4d0b~tplv-k3u1fbpfcp-watermark.image?"/><meta property="article:published_time" content="2022-03-14T16:00:00.000Z"/><meta property="article:modified_time" content="2022-03-14T16:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://github.com/balac2015/blog/react-18-upgrade-guide"
  },
  "headline": "如何升级到 React 18发布候选版 ",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ca9595ccd1479f86d71903184a4d0b~tplv-k3u1fbpfcp-watermark.image?"
    }
  ],
  "datePublished": "2022-03-14T16:00:00.000Z",
  "dateModified": "2022-03-14T16:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "随风"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "随风",
    "logo": {
      "@type": "ImageObject",
      "url": "https://github.com/balac2015/static/images/logo.png"
    }
  },
  "description": "上周 react 官网 发布了react@rc 版本，该版本是候选版本(Release Candidate)，这意味API已经基本稳定，跟最终版本不会有太大差别，官网也发布博客《如何升级到 react18 RC 版本》，鼓励大家尝试升级，所以我们可以在项目组中使用了！下面内容来自是官方文档的翻译。"
}</script><meta name="next-head-count" content="20"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><meta name="referrer" content="no-referrer"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/build/static/css/143263672f95f733.css" as="style"/><link rel="stylesheet" href="/build/static/css/143263672f95f733.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/build/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/build/static/chunks/webpack-d162ed0bea313f71.js" defer=""></script><script src="/build/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/build/static/chunks/main-b4cdd9636ac3694c.js" defer=""></script><script src="/build/static/chunks/pages/_app-adb504928e1e223a.js" defer=""></script><script src="/build/static/chunks/410-dc08c716b48ef576.js" defer=""></script><script src="/build/static/chunks/606-bcfce32a938ad92d.js" defer=""></script><script src="/build/static/chunks/pages/blog/%5B...slug%5D-a12f8dbad1f7fc24.js" defer=""></script><script src="/build/static/1YpokCm8LeHo6uVUXlBkJ/_buildManifest.js" defer=""></script><script src="/build/static/1YpokCm8LeHo6uVUXlBkJ/_ssgManifest.js" defer=""></script><script src="/build/static/1YpokCm8LeHo6uVUXlBkJ/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><h1><a aria-label="随风小站" href="/"><div class="flex items-center justify-between"><span><svg width="52" height="26" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><image xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAaCAYAAADFTB7LAAAAAXNSR0IArs4c6QAAAHplWElmTU0AKgAAAAgAAwESAAMAAAABAAEAAAExAAIAAAAeAAAAModpAAQAAAABAAAAUAAAAABBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKQAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAKKADAAQAAAABAAAAGgAAAACQIupnAAAEEWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOjdFNDI1QUQ2RkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjdFNDI1QUQ1RkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOjdFNDI1QUQzRkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOjdFNDI1QUQ0RkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo0psFQAAACSElEQVRYCc2WMUhVURjH79VQEISKDAfFAqVBbHDOLcFNB0scinJrkrbarMFBEAxSQXCJWuQNurgIEoJTOBRSrdFghqZgaIWv5+8v56qvd73vnKM37gc/znnnfN//+99z73v3BYFFFAqFengB67ALc9BsUZpuCiYuwjD8hH9jk4Vb6TpIUKf5Q9g44SrPfBam4a9Z32O8myCTzhZNnxsDGvbhDbRG3Zg/gD+gkPHBaC/1kWY9EJ3QW+YtcU1Z74IdiGKESRiXe25rNLgOW6ajvghVSeLst8OaydfwCi4k1XjvIVwF70CxAjU2YuRdg48QRY5JpU2tUw6io6bDV8YGl2LyL8Oyqdcw4lJfNhdBPU967rahrWxBTAJ1NaBnViGtzpg09yWE6kDPkb6tt90VjiuM1hdGhcba413PGSIvpUY88pQoKkOnA3SxiomiTZ8PiOj0Fn1qT6tBbwgUutUdp+VZrSOgq31mlWyZhF4lLIHiM1RblpakVbDyA/ZKds6wEIZhnvJ7sAU34Cn4hbnCJ37VyVVo94LiF8S+kZIVgkAnqKtMJTjJHMJToFs87tNEBjd9Ch1qHpP7CTo5xTsOdYepMrjhWuSSzynukt8Pv2EMk00u9f/jBANMvsfUfbgCeiVavxAigwWXq/LJxeQMdfpNXIcFTM5DH1xN0gtJGCChGoHJpMTz2qOf/jPKaDfchEvwHVbhAz5eMx6F/rtps/FoJeUJBnS3lgxlu+kW68gzGzK4lll3GJPBb5DPqskKnol9YzKTHg8A2r/9Qs/XFFsAAAAASUVORK5CYII=" height="26" width="40"></image><image href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAaCAYAAADFTB7LAAAAAXNSR0IArs4c6QAAAHplWElmTU0AKgAAAAgAAwESAAMAAAABAAEAAAExAAIAAAAeAAAAModpAAQAAAABAAAAUAAAAABBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKQAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAKKADAAQAAAABAAAAGgAAAACQIupnAAAEEWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOjdFNDI1QUQ2RkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjdFNDI1QUQ1RkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOjdFNDI1QUQzRkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOjdFNDI1QUQ0RkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo0psFQAAACSElEQVRYCc2WMUhVURjH79VQEISKDAfFAqVBbHDOLcFNB0scinJrkrbarMFBEAxSQXCJWuQNurgIEoJTOBRSrdFghqZgaIWv5+8v56qvd73vnKM37gc/znnnfN//+99z73v3BYFFFAqFengB67ALc9BsUZpuCiYuwjD8hH9jk4Vb6TpIUKf5Q9g44SrPfBam4a9Z32O8myCTzhZNnxsDGvbhDbRG3Zg/gD+gkPHBaC/1kWY9EJ3QW+YtcU1Z74IdiGKESRiXe25rNLgOW6ajvghVSeLst8OaydfwCi4k1XjvIVwF70CxAjU2YuRdg48QRY5JpU2tUw6io6bDV8YGl2LyL8Oyqdcw4lJfNhdBPU967rahrWxBTAJ1NaBnViGtzpg09yWE6kDPkb6tt90VjiuM1hdGhcba413PGSIvpUY88pQoKkOnA3SxiomiTZ8PiOj0Fn1qT6tBbwgUutUdp+VZrSOgq31mlWyZhF4lLIHiM1RblpakVbDyA/ZKds6wEIZhnvJ7sAU34Cn4hbnCJ37VyVVo94LiF8S+kZIVgkAnqKtMJTjJHMJToFs87tNEBjd9Ch1qHpP7CTo5xTsOdYepMrjhWuSSzynukt8Pv2EMk00u9f/jBANMvsfUfbgCeiVavxAigwWXq/LJxeQMdfpNXIcFTM5DH1xN0gtJGCChGoHJpMTz2qOf/jPKaDfchEvwHVbhAz5eMx6F/rtps/FoJeUJBnS3lgxlu+kW68gzGzK4lll3GJPBb5DPqskKnol9YzKTHg8A2r/9Qs/XFFsAAAAASUVORK5CYII=" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAaCAYAAADFTB7LAAAAAXNSR0IArs4c6QAAAHplWElmTU0AKgAAAAgAAwESAAMAAAABAAEAAAExAAIAAAAeAAAAModpAAQAAAABAAAAUAAAAABBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKQAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAKKADAAQAAAABAAAAGgAAAACQIupnAAAEEWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOjdFNDI1QUQ2RkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjdFNDI1QUQ1RkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOjdFNDI1QUQzRkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOjdFNDI1QUQ0RkQxNzExRTg5RUUyRDA2RDA3NDUyMUM1PC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo0psFQAAACSElEQVRYCc2WMUhVURjH79VQEISKDAfFAqVBbHDOLcFNB0scinJrkrbarMFBEAxSQXCJWuQNurgIEoJTOBRSrdFghqZgaIWv5+8v56qvd73vnKM37gc/znnnfN//+99z73v3BYFFFAqFengB67ALc9BsUZpuCiYuwjD8hH9jk4Vb6TpIUKf5Q9g44SrPfBam4a9Z32O8myCTzhZNnxsDGvbhDbRG3Zg/gD+gkPHBaC/1kWY9EJ3QW+YtcU1Z74IdiGKESRiXe25rNLgOW6ajvghVSeLst8OaydfwCi4k1XjvIVwF70CxAjU2YuRdg48QRY5JpU2tUw6io6bDV8YGl2LyL8Oyqdcw4lJfNhdBPU967rahrWxBTAJ1NaBnViGtzpg09yWE6kDPkb6tt90VjiuM1hdGhcba413PGSIvpUY88pQoKkOnA3SxiomiTZ8PiOj0Fn1qT6tBbwgUutUdp+VZrSOgq31mlWyZhF4lLIHiM1RblpakVbDyA/ZKds6wEIZhnvJ7sAU34Cn4hbnCJ37VyVVo94LiF8S+kZIVgkAnqKtMJTjJHMJToFs87tNEBjd9Ch1qHpP7CTo5xTsOdYepMrjhWuSSzynukt8Pv2EMk00u9f/jBANMvsfUfbgCeiVavxAigwWXq/LJxeQMdfpNXIcFTM5DH1xN0gtJGCChGoHJpMTz2qOf/jPKaDfchEvwHVbhAz5eMx6F/rtps/FoJeUJBnS3lgxlu+kW68gzGzK4lll3GJPBb5DPqskKnol9YzKTHg8A2r/9Qs/XFFsAAAAASUVORK5CYII=" height="26" width="40" x="15"></image></svg></span><div class="hidden text-2xl font-semibold sm:block">随风小站</div></div></a></h1><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">文章</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">标签</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/projects">项目</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tool">工具</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/boilerplate">模板</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">关于</a></div><div class="ml-1 mr-1 flex items-center sm:ml-4"><a class="block p-1" title="RSS" href="/feed.xml"><svg fill="currentColor" class="h-5 w-5" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3.75 3a.75.75 0 00-.75.75v.5c0 .414.336.75.75.75H4c6.075 0 11 4.925 11 11v.25c0 .414.336.75.75.75h.5a.75.75 0 00.75-.75V16C17 8.82 11.18 3 4 3h-.25z"></path><path d="M3 8.75A.75.75 0 013.75 8H4a8 8 0 018 8v.25a.75.75 0 01-.75.75h-.5a.75.75 0 01-.75-.75V16a6 6 0 00-6-6h-.25A.75.75 0 013 9.25v-.5zM7 15a2 2 0 11-4 0 2 2 0 014 0z"></path></svg></a><button aria-label="Toggle Dark Mode" type="button" class="h-7 w-7 rounded p-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button></div><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-50 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">文章</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">标签</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">项目</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tool">工具</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/boilerplate">模板</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">关于</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div style="transform:translateX(-100%)" class="fixed top-0 left-0 h-1 w-full bg-primary-500 backdrop-blur-3xl transition-transform duration-150"></div><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-03-14T16:00:00.000Z">2022年3月15日星期二</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">如何升级到 React 18发布候选版 </h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><div class=""><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img alt="avatar" src="/static/images/avatar.jpeg" width="38px" height="38px" class="h-10 w-10 rounded-full"/><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">作者</dt><dd class="text-gray-900 dark:text-gray-100">随风</dd></dl></li></ul></dd></dl><h2 class="pt-6 text-xs font-bold uppercase tracking-wide text-gray-500 dark:text-gray-400">目录</h2><ul class="py-4 text-sm font-medium leading-relaxed xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><li class="false"><a class="text-primary-500" href="#安装">安装</a></li><li class="false"><a class="text-primary-500" href="#客户端渲染-api-的更新">客户端渲染 API 的更新</a></li><li class="ml-6"><a class="text-primary-500" href="#1-替换-render-函数为-createroot">1. 替换 render 函数为 createRoot</a></li><li class="ml-6"><a class="text-primary-500" href="#hydrate-升级到-hydrateroot">hydrate 升级到 hydrateRoot</a></li><li class="false"><a class="text-primary-500" href="#服务端渲染-api-的更新">服务端渲染 API 的更新</a></li><li class="false"><a class="text-primary-500" href="#自动批处理-automatic-batching">自动批处理 (Automatic Batching)</a></li><li class="false"><a class="text-primary-500" href="#用于第三方库的-api">用于第三方库的 API</a></li><li class="false"><a class="text-primary-500" href="#更新严格模式-strict-mode">更新严格模式 (Strict Mode)</a></li><li class="false"><a class="text-primary-500" href="#配置你的测试环境">配置你的测试环境</a></li><li class="false"><a class="text-primary-500" href="#不再支持-ie-浏览器">不再支持 IE 浏览器</a></li><li class="false"><a class="text-primary-500" href="#其他变化">其他变化</a></li></ul></div><div class="xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="mt-6"><img alt="如何升级到 React 18发布候选版 " class="w-full rounded object-cover shadow-lg" src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ca9595ccd1479f86d71903184a4d0b~tplv-k3u1fbpfcp-watermark.image?"/></div><div class="prose max-w-none break-words pt-10 pb-8 dark:prose-dark"><details open=""><summary class="ml-6 pt-2 pb-2 text-xl font-bold">目录</summary><div class="ml-6"><ul class="py-4 text-sm font-medium leading-relaxed xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><li class="false"><a class="text-primary-500" href="#安装">安装</a></li><li class="false"><a class="text-primary-500" href="#客户端渲染-api-的更新">客户端渲染 API 的更新</a></li><li class="false"><a class="text-primary-500" href="#服务端渲染-api-的更新">服务端渲染 API 的更新</a></li><li class="false"><a class="text-primary-500" href="#自动批处理-automatic-batching">自动批处理 (Automatic Batching)</a></li><li class="false"><a class="text-primary-500" href="#用于第三方库的-api">用于第三方库的 API</a></li><li class="false"><a class="text-primary-500" href="#更新严格模式-strict-mode">更新严格模式 (Strict Mode)</a></li><li class="false"><a class="text-primary-500" href="#配置你的测试环境">配置你的测试环境</a></li><li class="false"><a class="text-primary-500" href="#不再支持-ie-浏览器">不再支持 IE 浏览器</a></li><li class="false"><a class="text-primary-500" href="#其他变化">其他变化</a></li></ul></div></details><p>上周 react 官网 发布了 react@rc 版本，该版本是候选版本(Release Candidate)，这意味 API 已经基本稳定，跟最终版本不会有太大差别，官网也发布博客<a target="_blank" rel="noopener noreferrer" href="https://reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html">《如何升级到 react18 RC 版本》</a>，鼓励大家尝试升级，所以我们可以在项目组中使用了！下面内容来自是官方文档的翻译。</p><p>正文开始</p><hr/><p>如果您想帮助我们测试 React 18，请按照本升级指南中的步骤并报告您遇到的任何问题，以便我们能够在稳定版发布之前修复这些问题。</p><p>注意: React Native 用户: React 18 将发布在 React Native with the New React Native Architecture。更多信息，请参见 <em><a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=FZ0cG47msEk&amp;t=1530s">React Conf keynote here</a>.</em></p><h2 id="安装"><a href="#安装" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>安装</h2><p>安装最新的 <code>React 18 RC</code> 版本使用@rc 这个 tag</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">npm</span> <span class="token function">install</span> react@rc react-dom@rc
</span></code></pre></div><p>或是使用 yarn</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">yarn</span> <span class="token function">add</span> react@rc react-dom@rc
</span></code></pre></div><h2 id="客户端渲染-api-的更新"><a href="#客户端渲染-api-的更新" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>客户端渲染 API 的更新</h2><h3 id="1-替换-render-函数为-createroot"><a href="#1-替换-render-函数为-createroot" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>1. 替换 render 函数为 createRoot</h3><p>如果你是第一次安装 <code>React 18</code> ，会在控制台看到如下一个警告：</p><blockquote><p>Use createRoot instead. Until you switch to the new API, your app will behave as if it’s running React 17. Learn more: <a target="_blank" rel="noopener noreferrer" href="https://reactjs.org/link/switch-to-createroot">https://reactjs.org/link/switch-to-createroot</a></p></blockquote><p>这是因为用了 <code>ReactDOM.render</code> 调用的现有 API。这将创建一个在“遗留”模式下运行的 root，其工作原理与 React 17 完全相同。在发布之前，React 给这个 API 添加一个警告，指示它已被弃用，并切换到新的 <code>Root API</code>。</p><p><code>React 18</code> 中引入了一个新的 <code>Root API</code>，它支持了并发渲染的能力(concurrent renderer) ，你可以自己决定是否启用并发渲染的能力。</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// 以前</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> render <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;react-dom&#x27;</span>
</span><span class="code-line"><span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token function method property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">&#x27;app&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> tab<span class="token operator">=</span><span class="token string">&quot;home&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> container<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 现在</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createRoot <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;react-dom/client&#x27;</span>
</span><span class="code-line"><span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token function method property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">&#x27;app&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 初始渲染将节点渲染到跟节点上</span>
</span><span class="code-line">root<span class="token punctuation">.</span><span class="token function method property-access">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> tab<span class="token operator">=</span><span class="token string">&quot;home&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 之后更新，就没必要传递dom 节点了</span>
</span><span class="code-line">root<span class="token punctuation">.</span><span class="token function method property-access">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> tab<span class="token operator">=</span><span class="token string">&quot;profile&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</span></code></pre></div><p>React 更改这个 API 有以下几个原因。</p><p>首先，这修复了 API 在运行更新时的一些工程学问题。如上所示，在 Legacy API 中，你需要多次将容器元素传递给 <code>render</code>，即使它从未更改过。这也意味着我们不需要将根元素存储在 DOM 节点上，尽管我们今天仍然这样做。</p><p>其次，这一变化允许让我们可以移除 <code>hydrate</code> 方法并替换为 root 上的一个选项；删除渲染回调，这些回调在部分 hydration 中是没有意义的。</p><p>销毁 dom 的 api 也修改了，<code>unmountComponentAtNode</code> 也改为了 <code>root.unmount</code>：</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// 以前</span>
</span><span class="code-line"><span class="token function">unmountComponentAtNode</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 现在</span>
</span><span class="code-line">root<span class="token punctuation">.</span><span class="token function method property-access">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre></div><p>与此同时， <code>render</code> 函数的回调函数也没有了，因为通常在使用了 <code>Suspense</code> api 后没有达到预期的效果：</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// 以前</span>
</span><span class="code-line"><span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token function method property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">&#x27;app&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token function method property-access">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> tab<span class="token operator">=</span><span class="token string">&quot;Home&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> container<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token class-name console">console</span><span class="token punctuation">.</span><span class="token function method property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;rendered&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 现在需要 重新定义一个 函数 通过 useEffect 来回调</span>
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">AppWithCallbackAfterRender</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token class-name console">console</span><span class="token punctuation">.</span><span class="token function method property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;rendered&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> tab<span class="token operator">=</span><span class="token string">&quot;Home&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token function method property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">&#x27;app&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token function method property-access">createRoot</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span>
</span><span class="code-line">root<span class="token punctuation">.</span><span class="token function method property-access">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">AppWithCallbackAfterRender</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</span></code></pre></div><h3 id="hydrate-升级到-hydrateroot"><a href="#hydrate-升级到-hydrateroot" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>hydrate 升级到 hydrateRoot</h3><blockquote><p>hydrate 是 ReactDOM 复用 ReactDOMServer 服务端渲染的内容时尽可能保留结构，并补充事件绑定等 Client 特有内容的过程。</p></blockquote><p>将把 <code>hydrate</code> 函数移到了 <code>hydrateRoot</code> API 上。</p><p>以前：</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> <span class="token maybe-class-name">ReactDOM</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;react-dom&#x27;</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;App&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token function method property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">&#x27;app&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Render with hydration.</span>
</span><span class="code-line"><span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token function method property-access">hydrate</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> tab<span class="token operator">=</span><span class="token string">&quot;home&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> container<span class="token punctuation">)</span>
</span></code></pre></div><p>现在：</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> <span class="token maybe-class-name">ReactDOM</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;react-dom&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;App&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token function method property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">&#x27;app&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Create *and* render a root with hydration.</span>
</span><span class="code-line"><span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token function method property-access">hydrateRoot</span><span class="token punctuation">(</span>container<span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> tab<span class="token operator">=</span><span class="token string">&quot;home&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token comment">// 与createRoot不同，这里不需要单独的 root.ender()调用</span>
</span></code></pre></div><p>注意，与 createRoot 不同，hydrateRoot 接受原生 JSX 作为第二个参数。这是因为初始客户端渲染是特殊的，需要与服务器树匹配。</p><p>如果你想在 hydration 后再次更新 root，你可以将它保存到一个变量中，就像使用 createRoot 一样，然后调用 root.render()：</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token operator">*</span> <span class="token keyword module">as</span> <span class="token maybe-class-name">ReactDOM</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;react-dom&#x27;</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;App&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token function method property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">&#x27;app&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Create *and* render a root with hydration.</span>
</span><span class="code-line"><span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token function method property-access">hydrateRoot</span><span class="token punctuation">(</span>container<span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> tab<span class="token operator">=</span><span class="token string">&quot;home&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// You can later update it.</span>
</span><span class="code-line">root<span class="token punctuation">.</span><span class="token function method property-access">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> tab<span class="token operator">=</span><span class="token string">&quot;profile&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</span></code></pre></div><h2 id="服务端渲染-api-的更新"><a href="#服务端渲染-api-的更新" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>服务端渲染 API 的更新</h2><p>在这个版本中，<code>React</code> 为了完全支持服务端的 <code>Suspense</code> 和流式 SSR，改进了 <code>react-dom/server</code> 的 <code>API</code>，不支持 Suspense 的 <code>Node.js</code> 流式 <code>API</code> 将会被完全弃用：</p><ul><li><code>renderToNodeStream</code> 弃用 ⛔️️</li><li>相反，对于 Node 环境中的流媒体，使用:<code>renderToPipeableStream</code>。</li></ul><p>还引入了一个新的 API <code>renderToReadableStream</code>，用于支持流式 SSR 和 Suspense，并为现代边缘运行环境提供支持，比如 Deno 和 Cloudflare workers:</p><p><code>renderToString、renderToStaticMarkup</code> 这两个 API 还可以继续用，但是对 <code>Suspense</code> 支持就不那么友好了。</p><p>最后，<code>renderToStaticNodeStream</code>这个 API 将继续使用，拥于渲染电子邮件</p><blockquote><p>想了解更多，可以看 <a target="_blank" rel="noopener noreferrer" href="https://github.com/reactwg/react-18/discussions/5">working group discussion here</a>.</p></blockquote><h2 id="自动批处理-automatic-batching"><a href="#自动批处理-automatic-batching" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>自动批处理 (Automatic Batching)</h2><p><code>React</code> 中的批处理简单来说就是将多个状态更新合并为一次重新渲染，由于设计问题，在 <code>React 18</code> 之前，<code>React</code> 只能在组件的生命周期函数或者合成事件函数中进行批处理。默认情况下，<code>Promise、setTimeout</code> 以及其他异步回调是无法享受批处理的优化的。</p><p>批处理是指 React 将多个状态更新合并到一个重新渲染中，以此来获得更好的性能。在 React 18 之前，react 会将一个事件中的多个 setState 合并为一个，在 promises、 setTimeout、和其他异步事件的更新没有合并。</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// React 18 之前</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token operator">!</span>f<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token comment">// 在合成事件中，享受批处理优化，只会重新渲染一次</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token operator">!</span>f<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token comment">// 不会进行批处理，会触发两次重新渲染</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</span></code></pre></div><p>从 <code>React 18</code> 开始，如果你使用了 <code>createRoot</code>，所有的更新都会享受批处理的优化，包括<code>Promise、setTimeout</code> 以及其他异步回调函数中。</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// React 18</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token operator">!</span>f<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token comment">// 只会重新渲染一次</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token operator">!</span>f<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token comment">// 只会重新渲染一次</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</span></code></pre></div><p>如果你有特殊的渲染需求，不想进行批处理，也可以使用 <code>flushSync</code> 异步更新：</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> flushSync <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;react-dom&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">flushSync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token function">setCounter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token comment">// 更新 DOM</span>
</span><span class="code-line">  <span class="token function">flushSync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token operator">!</span>f<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token comment">// 更新 DOM</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><blockquote><p>想了解更多可以看 <a target="_blank" rel="noopener noreferrer" href="https://github.com/reactwg/react-18/discussions/21">Automatic batching deep dive</a></p></blockquote><h2 id="用于第三方库的-api"><a href="#用于第三方库的-api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>用于第三方库的 API</h2><p>React18 工作组合一些库的维护人员创建了新的 api，比如样式 外部存储和可访问性等方面需要用到并发渲染，一些库可能切换到以下 api 之一</p><ul><li><code>useId</code> 是一个新的 <code>Hook</code>，用于在客户端和服务端生成唯一 id，同时避免 <code>hydration</code> 的不兼容，这可以解决 <code>React 17</code> 以及更低版本的问题。</li><li><code>useSyncExternalStore</code> 是一个新的 <code>Hook</code>，允许外部存储通过强制同步更新来支持并发读取。这个新的 API 推荐用于任何与 React 外部状态集成的库。有关更多信息，请参见 useSyncExternalStore 概述文章和 useSyncExternalStore API 详细信息。</li><li><code>useInsertionEffect</code> 是一个新的 <code>Hook</code>，它可以解决 <code>CSS-in-JS</code> 库在渲染中动态注入样式的性能问题。</li></ul><p>React 18 还为并发渲染引入了新的 api，例如 <code>startTransition</code> 和 <code>useDeferredValue</code>，将在即将发布的稳定版本中分享更多相关内容。</p><h2 id="更新严格模式-strict-mode"><a href="#更新严格模式-strict-mode" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>更新严格模式 (Strict Mode)</h2><p>在未来，React 希望添加一个特性，允许 React 添加和删除 UI 的部分，同时保留状态。例如，当用户选项卡远离屏幕并返回时，React 应该能够立即显示前一个屏幕。为此，React 将使用与前面相同的组件状态卸载和重新挂载树。</p><p>这个特性将使 React 具有更好的开箱即用性能，但是需要组件对多次挂载和销毁的效果具有弹性。大多数效果不需要任何改变就可以工作，但是有些效果假设它们只被安装或者销毁一次。</p><p>为了帮助表面这些问题，react 18 引入了一个新的开发-只检查严格模式。每当一个组件第一次挂载时，这个新的检查将自动卸载和重新挂载每个组件，恢复第二次挂载时以前的状态。</p><h2 id="配置你的测试环境"><a href="#配置你的测试环境" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>配置你的测试环境</h2><p>当您第一次更新，使用了 createRoot 时，您可能会在控制台中看到这个警告:</p><blockquote><p><strong>The current testing environment is not configured to support act(…)</strong></p></blockquote><p>要解决这个问题，请在运行测试之前将 <code>globalThis.IS react act act environment</code> 设置为 <code>true</code>:</p><div class="relative"><pre><code class="language-js code-highlight"><span class="code-line">globalThis<span class="token punctuation">.</span><span class="token constant">IS_REACT_ACT_ENVIRONMENT</span> <span class="token operator">=</span> <span class="token boolean">true</span>
</span></code></pre></div><p>标志的作用是告诉 React 它在类似于单元测试的环境中运行。如果你忘记用 <code>act</code> 包裹更新，则响应将记录有用的警告信息。</p><p>您还可以将标志设置为 <code>false</code> 来告诉 React <code>act</code> 是不必要的。这对于模拟完整浏览器环境的端到端测试非常有用。</p><p>最终，我们希望测试库能够自动为您配置这个功能。例如，下一个版本的 React Testing Library 内置了对 React 18 的支持，而不需要任何额外的配置。</p><blockquote><p><code>act</code> 名称来自 <a target="_blank" rel="noopener noreferrer" href="http://wiki.c2.com/?ArrangeActAssert">Arrange-Act-Assert</a> 模式。</p></blockquote><h2 id="不再支持-ie-浏览器"><a href="#不再支持-ie-浏览器" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>不再支持 IE 浏览器</h2><p>在这个版本中，React 放弃了对 Internet Explorer 的支持，它将在 2022 年 6 月 15 日失去支持。React 做出这个改变，是因为在 React 18 中引入的新特性是使用现代浏览器的特性构建的，比如微任务，这些特性在 IE 中无法充分填充（polyfilled）。</p><h2 id="其他变化"><a href="#其他变化" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>其他变化</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/reactwg/react-18/discussions/82">更新以删除“setState on unmounted component” 警告</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/reactwg/react-18/discussions/72">Suspense 不再需要<code>fallback</code>prop 来捕捉</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/reactwg/react-18/discussions/75">组件现在可以渲染 undefined</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/react/pull/23355">弃用 renderSubtreeIntoContainer</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/reactwg/react-18/discussions/96">StrictMode 更新为默认情况下不会静默双重日志记录</a></li></ul><p>如果大家想了解更多内容，欢迎查看 <code>React</code> 官方博客：<a target="_blank" rel="noopener noreferrer" href="https://reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html">https://reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html</a></p><p>以上就是本文全部内容，希望这篇文章对大家有所帮助，也可以参考我往期的文章或者在评论区交流你的想法和心得，欢迎一起探索前端。</p><p>本文首发掘金平台，来源<a target="_blank" rel="noopener noreferrer" href="https://maqib.cn/blog/react-18-upgrade-guide%22">小马博客</a></p></div><div class="border-t border-gray-200 pt-6 pb-6 text-sm text-gray-700 dark:border-gray-700 dark:text-gray-300"><div class="mb-3"><img alt="runjs-cool" width="384" height="140" src="/static/images/runjs-cool.webp"/></div><span>关注微信公众号，获取最新原创文章（首发）</span><a target="_blank" rel="noopener noreferrer" href="https://github.com/balac2015/blob/main/data/blog/react-18-upgrade-guide.md">View on GitHub</a></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">标签</h2><div class="mt-3 flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/%E5%89%8D%E7%AB%AF">前端</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/reactjs">React.js</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">上一篇 文章</h2><div class="mt-3 text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/use-threejs-and-react-to-render-a-3d-model-of-your-self">如何使用 react 和 three.js 在网站渲染自己的3D模型</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">下一篇 文章</h2><div class="mt-3 text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/node-reptile">我用 nodejs 爬了一万多张小姐姐壁纸</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← 返回文章列表</a></div></footer></div></div></article></div></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var p=Object.create;var t=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var o=a=\u003et(a,\"__esModule\",{value:!0});var k=(a,c)=\u003e()=\u003e(c||a((c={exports:{}}).exports,c),c.exports),g=(a,c)=\u003e{for(var s in c)t(a,s,{get:c[s],enumerable:!0})},r=(a,c,s,n)=\u003e{if(c\u0026\u0026typeof c==\"object\"||typeof c==\"function\")for(let l of m(c))!u.call(a,l)\u0026\u0026(s||l!==\"default\")\u0026\u0026t(a,l,{get:()=\u003ec[l],enumerable:!(n=h(c,l))||n.enumerable});return a},f=(a,c)=\u003er(o(t(a!=null?p(N(a)):{},\"default\",!c\u0026\u0026a\u0026\u0026a.__esModule?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a),y=(a=\u003e(c,s)=\u003ea\u0026\u0026a.get(c)||(s=r(o({}),c,1),a\u0026\u0026a.set(c,s),s))(typeof WeakMap!=\"undefined\"?new WeakMap:0);var d=k((j,i)=\u003e{i.exports=_jsx_runtime});var I={};g(I,{default:()=\u003ew,frontmatter:()=\u003eb});var e=f(d()),b={title:\"\\u5982\\u4F55\\u5347\\u7EA7\\u5230 React 18\\u53D1\\u5E03\\u5019\\u9009\\u7248 \",date:\"2022/3/15\",lastmod:\"2022/3/15\",tags:[\"\\u524D\\u7AEF\",\"React.js\"],draft:!1,summary:\"\\u4E0A\\u5468 react \\u5B98\\u7F51 \\u53D1\\u5E03\\u4E86react@rc \\u7248\\u672C\\uFF0C\\u8BE5\\u7248\\u672C\\u662F\\u5019\\u9009\\u7248\\u672C(Release Candidate)\\uFF0C\\u8FD9\\u610F\\u5473API\\u5DF2\\u7ECF\\u57FA\\u672C\\u7A33\\u5B9A\\uFF0C\\u8DDF\\u6700\\u7EC8\\u7248\\u672C\\u4E0D\\u4F1A\\u6709\\u592A\\u5927\\u5DEE\\u522B\\uFF0C\\u5B98\\u7F51\\u4E5F\\u53D1\\u5E03\\u535A\\u5BA2\\u300A\\u5982\\u4F55\\u5347\\u7EA7\\u5230 react18 RC \\u7248\\u672C\\u300B\\uFF0C\\u9F13\\u52B1\\u5927\\u5BB6\\u5C1D\\u8BD5\\u5347\\u7EA7\\uFF0C\\u6240\\u4EE5\\u6211\\u4EEC\\u53EF\\u4EE5\\u5728\\u9879\\u76EE\\u7EC4\\u4E2D\\u4F7F\\u7528\\u4E86\\uFF01\\u4E0B\\u9762\\u5185\\u5BB9\\u6765\\u81EA\\u662F\\u5B98\\u65B9\\u6587\\u6863\\u7684\\u7FFB\\u8BD1\\u3002\",images:[\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ca9595ccd1479f86d71903184a4d0b~tplv-k3u1fbpfcp-watermark.image?\"],authors:[\"default\"],layout:\"PostLayout\"};function R(a={}){let{wrapper:c}=a.components||{};return c?(0,e.jsx)(c,Object.assign({},a,{children:(0,e.jsx)(s,{})})):s();function s(){let n=Object.assign({p:\"p\",a:\"a\",hr:\"hr\",em:\"em\",h2:\"h2\",span:\"span\",code:\"code\",pre:\"pre\",h3:\"h3\",blockquote:\"blockquote\",ul:\"ul\",li:\"li\",strong:\"strong\"},a.components),{TOCInline:l}=n;return l||A(\"TOCInline\",!0),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l,{toc:a.toc,toHeading:2}),(0,e.jsxs)(n.p,{children:[\"\\u4E0A\\u5468 react \\u5B98\\u7F51 \\u53D1\\u5E03\\u4E86 react@rc \\u7248\\u672C\\uFF0C\\u8BE5\\u7248\\u672C\\u662F\\u5019\\u9009\\u7248\\u672C(Release Candidate)\\uFF0C\\u8FD9\\u610F\\u5473 API \\u5DF2\\u7ECF\\u57FA\\u672C\\u7A33\\u5B9A\\uFF0C\\u8DDF\\u6700\\u7EC8\\u7248\\u672C\\u4E0D\\u4F1A\\u6709\\u592A\\u5927\\u5DEE\\u522B\\uFF0C\\u5B98\\u7F51\\u4E5F\\u53D1\\u5E03\\u535A\\u5BA2\",(0,e.jsx)(n.a,{href:\"https://reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html\",children:\"\\u300A\\u5982\\u4F55\\u5347\\u7EA7\\u5230 react18 RC \\u7248\\u672C\\u300B\"}),\"\\uFF0C\\u9F13\\u52B1\\u5927\\u5BB6\\u5C1D\\u8BD5\\u5347\\u7EA7\\uFF0C\\u6240\\u4EE5\\u6211\\u4EEC\\u53EF\\u4EE5\\u5728\\u9879\\u76EE\\u7EC4\\u4E2D\\u4F7F\\u7528\\u4E86\\uFF01\\u4E0B\\u9762\\u5185\\u5BB9\\u6765\\u81EA\\u662F\\u5B98\\u65B9\\u6587\\u6863\\u7684\\u7FFB\\u8BD1\\u3002\"]}),(0,e.jsx)(n.p,{children:\"\\u6B63\\u6587\\u5F00\\u59CB\"}),(0,e.jsx)(n.hr,{}),(0,e.jsx)(n.p,{children:\"\\u5982\\u679C\\u60A8\\u60F3\\u5E2E\\u52A9\\u6211\\u4EEC\\u6D4B\\u8BD5 React 18\\uFF0C\\u8BF7\\u6309\\u7167\\u672C\\u5347\\u7EA7\\u6307\\u5357\\u4E2D\\u7684\\u6B65\\u9AA4\\u5E76\\u62A5\\u544A\\u60A8\\u9047\\u5230\\u7684\\u4EFB\\u4F55\\u95EE\\u9898\\uFF0C\\u4EE5\\u4FBF\\u6211\\u4EEC\\u80FD\\u591F\\u5728\\u7A33\\u5B9A\\u7248\\u53D1\\u5E03\\u4E4B\\u524D\\u4FEE\\u590D\\u8FD9\\u4E9B\\u95EE\\u9898\\u3002\"}),(0,e.jsxs)(n.p,{children:[\"\\u6CE8\\u610F: React Native \\u7528\\u6237: React 18 \\u5C06\\u53D1\\u5E03\\u5728 React Native with the New React Native Architecture\\u3002\\u66F4\\u591A\\u4FE1\\u606F\\uFF0C\\u8BF7\\u53C2\\u89C1 \",(0,e.jsxs)(n.em,{children:[(0,e.jsx)(n.a,{href:\"https://www.youtube.com/watch?v=FZ0cG47msEk\u0026t=1530s\",children:\"React Conf keynote here\"}),\".\"]})]}),(0,e.jsxs)(n.h2,{id:\"\\u5B89\\u88C5\",children:[(0,e.jsx)(n.a,{href:\"#\\u5B89\\u88C5\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u5B89\\u88C5\"]}),(0,e.jsxs)(n.p,{children:[\"\\u5B89\\u88C5\\u6700\\u65B0\\u7684 \",(0,e.jsx)(n.code,{children:\"React 18 RC\"}),\" \\u7248\\u672C\\u4F7F\\u7528@rc \\u8FD9\\u4E2A tag\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"npm\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),` react@rc react-dom@rc\n`]})})}),(0,e.jsx)(n.p,{children:\"\\u6216\\u662F\\u4F7F\\u7528 yarn\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"yarn\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"add\"}),` react@rc react-dom@rc\n`]})})}),(0,e.jsxs)(n.h2,{id:\"\\u5BA2\\u6237\\u7AEF\\u6E32\\u67D3-api-\\u7684\\u66F4\\u65B0\",children:[(0,e.jsx)(n.a,{href:\"#\\u5BA2\\u6237\\u7AEF\\u6E32\\u67D3-api-\\u7684\\u66F4\\u65B0\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u5BA2\\u6237\\u7AEF\\u6E32\\u67D3 API \\u7684\\u66F4\\u65B0\"]}),(0,e.jsxs)(n.h3,{id:\"1-\\u66FF\\u6362-render-\\u51FD\\u6570\\u4E3A-createroot\",children:[(0,e.jsx)(n.a,{href:\"#1-\\u66FF\\u6362-render-\\u51FD\\u6570\\u4E3A-createroot\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"1. \\u66FF\\u6362 render \\u51FD\\u6570\\u4E3A createRoot\"]}),(0,e.jsxs)(n.p,{children:[\"\\u5982\\u679C\\u4F60\\u662F\\u7B2C\\u4E00\\u6B21\\u5B89\\u88C5 \",(0,e.jsx)(n.code,{children:\"React 18\"}),\" \\uFF0C\\u4F1A\\u5728\\u63A7\\u5236\\u53F0\\u770B\\u5230\\u5982\\u4E0B\\u4E00\\u4E2A\\u8B66\\u544A\\uFF1A\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsxs)(n.p,{children:[\"Use createRoot instead. Until you switch to the new API, your app will behave as if it\\u2019s running React 17. Learn more: \",(0,e.jsx)(n.a,{href:\"https://reactjs.org/link/switch-to-createroot\",children:\"https://reactjs.org/link/switch-to-createroot\"})]})}),(0,e.jsxs)(n.p,{children:[\"\\u8FD9\\u662F\\u56E0\\u4E3A\\u7528\\u4E86 \",(0,e.jsx)(n.code,{children:\"ReactDOM.render\"}),\" \\u8C03\\u7528\\u7684\\u73B0\\u6709 API\\u3002\\u8FD9\\u5C06\\u521B\\u5EFA\\u4E00\\u4E2A\\u5728\\u201C\\u9057\\u7559\\u201D\\u6A21\\u5F0F\\u4E0B\\u8FD0\\u884C\\u7684 root\\uFF0C\\u5176\\u5DE5\\u4F5C\\u539F\\u7406\\u4E0E React 17 \\u5B8C\\u5168\\u76F8\\u540C\\u3002\\u5728\\u53D1\\u5E03\\u4E4B\\u524D\\uFF0CReact \\u7ED9\\u8FD9\\u4E2A API \\u6DFB\\u52A0\\u4E00\\u4E2A\\u8B66\\u544A\\uFF0C\\u6307\\u793A\\u5B83\\u5DF2\\u88AB\\u5F03\\u7528\\uFF0C\\u5E76\\u5207\\u6362\\u5230\\u65B0\\u7684 \",(0,e.jsx)(n.code,{children:\"Root API\"}),\"\\u3002\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"React 18\"}),\" \\u4E2D\\u5F15\\u5165\\u4E86\\u4E00\\u4E2A\\u65B0\\u7684 \",(0,e.jsx)(n.code,{children:\"Root API\"}),\"\\uFF0C\\u5B83\\u652F\\u6301\\u4E86\\u5E76\\u53D1\\u6E32\\u67D3\\u7684\\u80FD\\u529B(concurrent renderer) \\uFF0C\\u4F60\\u53EF\\u4EE5\\u81EA\\u5DF1\\u51B3\\u5B9A\\u662F\\u5426\\u542F\\u7528\\u5E76\\u53D1\\u6E32\\u67D3\\u7684\\u80FD\\u529B\\u3002\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u4EE5\\u524D\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsxs)(n.span,{className:\"token imports\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" render \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'react-dom'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" container \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"getElementById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"render\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"}),\" tab\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"home\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" container\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u73B0\\u5728\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsxs)(n.span,{className:\"token imports\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" createRoot \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'react-dom/client'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" container \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"getElementById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" root \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"createRoot\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"container\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u521D\\u59CB\\u6E32\\u67D3\\u5C06\\u8282\\u70B9\\u6E32\\u67D3\\u5230\\u8DDF\\u8282\\u70B9\\u4E0A\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"render\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"}),\" tab\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"home\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u4E4B\\u540E\\u66F4\\u65B0\\uFF0C\\u5C31\\u6CA1\\u5FC5\\u8981\\u4F20\\u9012dom \\u8282\\u70B9\\u4E86\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"render\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"}),\" tab\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"profile\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"React \\u66F4\\u6539\\u8FD9\\u4E2A API \\u6709\\u4EE5\\u4E0B\\u51E0\\u4E2A\\u539F\\u56E0\\u3002\"}),(0,e.jsxs)(n.p,{children:[\"\\u9996\\u5148\\uFF0C\\u8FD9\\u4FEE\\u590D\\u4E86 API \\u5728\\u8FD0\\u884C\\u66F4\\u65B0\\u65F6\\u7684\\u4E00\\u4E9B\\u5DE5\\u7A0B\\u5B66\\u95EE\\u9898\\u3002\\u5982\\u4E0A\\u6240\\u793A\\uFF0C\\u5728 Legacy API \\u4E2D\\uFF0C\\u4F60\\u9700\\u8981\\u591A\\u6B21\\u5C06\\u5BB9\\u5668\\u5143\\u7D20\\u4F20\\u9012\\u7ED9 \",(0,e.jsx)(n.code,{children:\"render\"}),\"\\uFF0C\\u5373\\u4F7F\\u5B83\\u4ECE\\u672A\\u66F4\\u6539\\u8FC7\\u3002\\u8FD9\\u4E5F\\u610F\\u5473\\u7740\\u6211\\u4EEC\\u4E0D\\u9700\\u8981\\u5C06\\u6839\\u5143\\u7D20\\u5B58\\u50A8\\u5728 DOM \\u8282\\u70B9\\u4E0A\\uFF0C\\u5C3D\\u7BA1\\u6211\\u4EEC\\u4ECA\\u5929\\u4ECD\\u7136\\u8FD9\\u6837\\u505A\\u3002\"]}),(0,e.jsxs)(n.p,{children:[\"\\u5176\\u6B21\\uFF0C\\u8FD9\\u4E00\\u53D8\\u5316\\u5141\\u8BB8\\u8BA9\\u6211\\u4EEC\\u53EF\\u4EE5\\u79FB\\u9664 \",(0,e.jsx)(n.code,{children:\"hydrate\"}),\" \\u65B9\\u6CD5\\u5E76\\u66FF\\u6362\\u4E3A root \\u4E0A\\u7684\\u4E00\\u4E2A\\u9009\\u9879\\uFF1B\\u5220\\u9664\\u6E32\\u67D3\\u56DE\\u8C03\\uFF0C\\u8FD9\\u4E9B\\u56DE\\u8C03\\u5728\\u90E8\\u5206 hydration \\u4E2D\\u662F\\u6CA1\\u6709\\u610F\\u4E49\\u7684\\u3002\"]}),(0,e.jsxs)(n.p,{children:[\"\\u9500\\u6BC1 dom \\u7684 api \\u4E5F\\u4FEE\\u6539\\u4E86\\uFF0C\",(0,e.jsx)(n.code,{children:\"unmountComponentAtNode\"}),\" \\u4E5F\\u6539\\u4E3A\\u4E86 \",(0,e.jsx)(n.code,{children:\"root.unmount\"}),\"\\uFF1A\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u4EE5\\u524D\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"unmountComponentAtNode\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"container\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u73B0\\u5728\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"unmount\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\u4E0E\\u6B64\\u540C\\u65F6\\uFF0C \",(0,e.jsx)(n.code,{children:\"render\"}),\" \\u51FD\\u6570\\u7684\\u56DE\\u8C03\\u51FD\\u6570\\u4E5F\\u6CA1\\u6709\\u4E86\\uFF0C\\u56E0\\u4E3A\\u901A\\u5E38\\u5728\\u4F7F\\u7528\\u4E86 \",(0,e.jsx)(n.code,{children:\"Suspense\"}),\" api \\u540E\\u6CA1\\u6709\\u8FBE\\u5230\\u9884\\u671F\\u7684\\u6548\\u679C\\uFF1A\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u4EE5\\u524D\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" container \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"getElementById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ReactDOM\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"render\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"}),\" tab\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"Home\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" container\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token class-name console\",children:\"console\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"log\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'rendered'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u73B0\\u5728\\u9700\\u8981 \\u91CD\\u65B0\\u5B9A\\u4E49\\u4E00\\u4E2A \\u51FD\\u6570 \\u901A\\u8FC7 useEffect \\u6765\\u56DE\\u8C03\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"AppWithCallbackAfterRender\"})}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"useEffect\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token class-name console\",children:\"console\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"log\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'rendered'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"}),\" tab\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"Home\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" container \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"getElementById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" root \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ReactDOM\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"createRoot\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"container\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"render\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"AppWithCallbackAfterRender\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"hydrate-\\u5347\\u7EA7\\u5230-hydrateroot\",children:[(0,e.jsx)(n.a,{href:\"#hydrate-\\u5347\\u7EA7\\u5230-hydrateroot\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"hydrate \\u5347\\u7EA7\\u5230 hydrateRoot\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:\"hydrate \\u662F ReactDOM \\u590D\\u7528 ReactDOMServer \\u670D\\u52A1\\u7AEF\\u6E32\\u67D3\\u7684\\u5185\\u5BB9\\u65F6\\u5C3D\\u53EF\\u80FD\\u4FDD\\u7559\\u7ED3\\u6784\\uFF0C\\u5E76\\u8865\\u5145\\u4E8B\\u4EF6\\u7ED1\\u5B9A\\u7B49 Client \\u7279\\u6709\\u5185\\u5BB9\\u7684\\u8FC7\\u7A0B\\u3002\"})}),(0,e.jsxs)(n.p,{children:[\"\\u5C06\\u628A \",(0,e.jsx)(n.code,{children:\"hydrate\"}),\" \\u51FD\\u6570\\u79FB\\u5230\\u4E86 \",(0,e.jsx)(n.code,{children:\"hydrateRoot\"}),\" API \\u4E0A\\u3002\"]}),(0,e.jsx)(n.p,{children:\"\\u4EE5\\u524D\\uFF1A\"}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsxs)(n.span,{className:\"token imports\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ReactDOM\"})]}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'react-dom'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsx)(n.span,{className:\"token imports\",children:(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"})}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'App'\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" container \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"getElementById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Render with hydration.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ReactDOM\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"hydrate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"}),\" tab\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"home\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" container\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\u73B0\\u5728\\uFF1A\"}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsxs)(n.span,{className:\"token imports\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ReactDOM\"})]}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'react-dom'\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsx)(n.span,{className:\"token imports\",children:(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"})}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'App'\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" container \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"getElementById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Create *and* render a root with hydration.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" root \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ReactDOM\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"hydrateRoot\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"container\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"}),\" tab\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"home\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u4E0EcreateRoot\\u4E0D\\u540C\\uFF0C\\u8FD9\\u91CC\\u4E0D\\u9700\\u8981\\u5355\\u72EC\\u7684 root.ender()\\u8C03\\u7528\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\u6CE8\\u610F\\uFF0C\\u4E0E createRoot \\u4E0D\\u540C\\uFF0ChydrateRoot \\u63A5\\u53D7\\u539F\\u751F JSX \\u4F5C\\u4E3A\\u7B2C\\u4E8C\\u4E2A\\u53C2\\u6570\\u3002\\u8FD9\\u662F\\u56E0\\u4E3A\\u521D\\u59CB\\u5BA2\\u6237\\u7AEF\\u6E32\\u67D3\\u662F\\u7279\\u6B8A\\u7684\\uFF0C\\u9700\\u8981\\u4E0E\\u670D\\u52A1\\u5668\\u6811\\u5339\\u914D\\u3002\"}),(0,e.jsx)(n.p,{children:\"\\u5982\\u679C\\u4F60\\u60F3\\u5728 hydration \\u540E\\u518D\\u6B21\\u66F4\\u65B0 root\\uFF0C\\u4F60\\u53EF\\u4EE5\\u5C06\\u5B83\\u4FDD\\u5B58\\u5230\\u4E00\\u4E2A\\u53D8\\u91CF\\u4E2D\\uFF0C\\u5C31\\u50CF\\u4F7F\\u7528 createRoot \\u4E00\\u6837\\uFF0C\\u7136\\u540E\\u8C03\\u7528 root.render()\\uFF1A\"}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsxs)(n.span,{className:\"token imports\",children:[(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"as\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ReactDOM\"})]}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'react-dom'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsx)(n.span,{className:\"token imports\",children:(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"})}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'App'\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" container \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"getElementById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'app'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Create *and* render a root with hydration.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" root \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"ReactDOM\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"hydrateRoot\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"container\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"}),\" tab\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"home\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// You can later update it.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"root\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token function method property-access\",children:\"render\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003c\"}),(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"App\"}),\" tab\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"profile\"'}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"\u003e\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.h2,{id:\"\\u670D\\u52A1\\u7AEF\\u6E32\\u67D3-api-\\u7684\\u66F4\\u65B0\",children:[(0,e.jsx)(n.a,{href:\"#\\u670D\\u52A1\\u7AEF\\u6E32\\u67D3-api-\\u7684\\u66F4\\u65B0\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u670D\\u52A1\\u7AEF\\u6E32\\u67D3 API \\u7684\\u66F4\\u65B0\"]}),(0,e.jsxs)(n.p,{children:[\"\\u5728\\u8FD9\\u4E2A\\u7248\\u672C\\u4E2D\\uFF0C\",(0,e.jsx)(n.code,{children:\"React\"}),\" \\u4E3A\\u4E86\\u5B8C\\u5168\\u652F\\u6301\\u670D\\u52A1\\u7AEF\\u7684 \",(0,e.jsx)(n.code,{children:\"Suspense\"}),\" \\u548C\\u6D41\\u5F0F SSR\\uFF0C\\u6539\\u8FDB\\u4E86 \",(0,e.jsx)(n.code,{children:\"react-dom/server\"}),\" \\u7684 \",(0,e.jsx)(n.code,{children:\"API\"}),\"\\uFF0C\\u4E0D\\u652F\\u6301 Suspense \\u7684 \",(0,e.jsx)(n.code,{children:\"Node.js\"}),\" \\u6D41\\u5F0F \",(0,e.jsx)(n.code,{children:\"API\"}),\" \\u5C06\\u4F1A\\u88AB\\u5B8C\\u5168\\u5F03\\u7528\\uFF1A\"]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"renderToNodeStream\"}),\" \\u5F03\\u7528 \\u26D4\\uFE0F\\uFE0F\"]}),(0,e.jsxs)(n.li,{children:[\"\\u76F8\\u53CD\\uFF0C\\u5BF9\\u4E8E Node \\u73AF\\u5883\\u4E2D\\u7684\\u6D41\\u5A92\\u4F53\\uFF0C\\u4F7F\\u7528:\",(0,e.jsx)(n.code,{children:\"renderToPipeableStream\"}),\"\\u3002\"]})]}),(0,e.jsxs)(n.p,{children:[\"\\u8FD8\\u5F15\\u5165\\u4E86\\u4E00\\u4E2A\\u65B0\\u7684 API \",(0,e.jsx)(n.code,{children:\"renderToReadableStream\"}),\"\\uFF0C\\u7528\\u4E8E\\u652F\\u6301\\u6D41\\u5F0F SSR \\u548C Suspense\\uFF0C\\u5E76\\u4E3A\\u73B0\\u4EE3\\u8FB9\\u7F18\\u8FD0\\u884C\\u73AF\\u5883\\u63D0\\u4F9B\\u652F\\u6301\\uFF0C\\u6BD4\\u5982 Deno \\u548C Cloudflare workers:\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"renderToString\\u3001renderToStaticMarkup\"}),\" \\u8FD9\\u4E24\\u4E2A API \\u8FD8\\u53EF\\u4EE5\\u7EE7\\u7EED\\u7528\\uFF0C\\u4F46\\u662F\\u5BF9 \",(0,e.jsx)(n.code,{children:\"Suspense\"}),\" \\u652F\\u6301\\u5C31\\u4E0D\\u90A3\\u4E48\\u53CB\\u597D\\u4E86\\u3002\"]}),(0,e.jsxs)(n.p,{children:[\"\\u6700\\u540E\\uFF0C\",(0,e.jsx)(n.code,{children:\"renderToStaticNodeStream\"}),\"\\u8FD9\\u4E2A API \\u5C06\\u7EE7\\u7EED\\u4F7F\\u7528\\uFF0C\\u62E5\\u4E8E\\u6E32\\u67D3\\u7535\\u5B50\\u90AE\\u4EF6\"]}),(0,e.jsx)(n.blockquote,{children:(0,e.jsxs)(n.p,{children:[\"\\u60F3\\u4E86\\u89E3\\u66F4\\u591A\\uFF0C\\u53EF\\u4EE5\\u770B \",(0,e.jsx)(n.a,{href:\"https://github.com/reactwg/react-18/discussions/5\",children:\"working group discussion here\"}),\".\"]})}),(0,e.jsxs)(n.h2,{id:\"\\u81EA\\u52A8\\u6279\\u5904\\u7406-automatic-batching\",children:[(0,e.jsx)(n.a,{href:\"#\\u81EA\\u52A8\\u6279\\u5904\\u7406-automatic-batching\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u81EA\\u52A8\\u6279\\u5904\\u7406 (Automatic Batching)\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"React\"}),\" \\u4E2D\\u7684\\u6279\\u5904\\u7406\\u7B80\\u5355\\u6765\\u8BF4\\u5C31\\u662F\\u5C06\\u591A\\u4E2A\\u72B6\\u6001\\u66F4\\u65B0\\u5408\\u5E76\\u4E3A\\u4E00\\u6B21\\u91CD\\u65B0\\u6E32\\u67D3\\uFF0C\\u7531\\u4E8E\\u8BBE\\u8BA1\\u95EE\\u9898\\uFF0C\\u5728 \",(0,e.jsx)(n.code,{children:\"React 18\"}),\" \\u4E4B\\u524D\\uFF0C\",(0,e.jsx)(n.code,{children:\"React\"}),\" \\u53EA\\u80FD\\u5728\\u7EC4\\u4EF6\\u7684\\u751F\\u547D\\u5468\\u671F\\u51FD\\u6570\\u6216\\u8005\\u5408\\u6210\\u4E8B\\u4EF6\\u51FD\\u6570\\u4E2D\\u8FDB\\u884C\\u6279\\u5904\\u7406\\u3002\\u9ED8\\u8BA4\\u60C5\\u51B5\\u4E0B\\uFF0C\",(0,e.jsx)(n.code,{children:\"Promise\\u3001setTimeout\"}),\" \\u4EE5\\u53CA\\u5176\\u4ED6\\u5F02\\u6B65\\u56DE\\u8C03\\u662F\\u65E0\\u6CD5\\u4EAB\\u53D7\\u6279\\u5904\\u7406\\u7684\\u4F18\\u5316\\u7684\\u3002\"]}),(0,e.jsx)(n.p,{children:\"\\u6279\\u5904\\u7406\\u662F\\u6307 React \\u5C06\\u591A\\u4E2A\\u72B6\\u6001\\u66F4\\u65B0\\u5408\\u5E76\\u5230\\u4E00\\u4E2A\\u91CD\\u65B0\\u6E32\\u67D3\\u4E2D\\uFF0C\\u4EE5\\u6B64\\u6765\\u83B7\\u5F97\\u66F4\\u597D\\u7684\\u6027\\u80FD\\u3002\\u5728 React 18 \\u4E4B\\u524D\\uFF0Creact \\u4F1A\\u5C06\\u4E00\\u4E2A\\u4E8B\\u4EF6\\u4E2D\\u7684\\u591A\\u4E2A setState \\u5408\\u5E76\\u4E3A\\u4E00\\u4E2A\\uFF0C\\u5728 promises\\u3001 setTimeout\\u3001\\u548C\\u5176\\u4ED6\\u5F02\\u6B65\\u4E8B\\u4EF6\\u7684\\u66F4\\u65B0\\u6CA1\\u6709\\u5408\\u5E76\\u3002\"}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// React 18 \\u4E4B\\u524D\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"handleClick\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setCount\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"c\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" c \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setFlag\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"f\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u5728\\u5408\\u6210\\u4E8B\\u4EF6\\u4E2D\\uFF0C\\u4EAB\\u53D7\\u6279\\u5904\\u7406\\u4F18\\u5316\\uFF0C\\u53EA\\u4F1A\\u91CD\\u65B0\\u6E32\\u67D3\\u4E00\\u6B21\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"setTimeout\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setCount\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"c\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" c \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setFlag\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"f\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u4E0D\\u4F1A\\u8FDB\\u884C\\u6279\\u5904\\u7406\\uFF0C\\u4F1A\\u89E6\\u53D1\\u4E24\\u6B21\\u91CD\\u65B0\\u6E32\\u67D3\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\u4ECE \",(0,e.jsx)(n.code,{children:\"React 18\"}),\" \\u5F00\\u59CB\\uFF0C\\u5982\\u679C\\u4F60\\u4F7F\\u7528\\u4E86 \",(0,e.jsx)(n.code,{children:\"createRoot\"}),\"\\uFF0C\\u6240\\u6709\\u7684\\u66F4\\u65B0\\u90FD\\u4F1A\\u4EAB\\u53D7\\u6279\\u5904\\u7406\\u7684\\u4F18\\u5316\\uFF0C\\u5305\\u62EC\",(0,e.jsx)(n.code,{children:\"Promise\\u3001setTimeout\"}),\" \\u4EE5\\u53CA\\u5176\\u4ED6\\u5F02\\u6B65\\u56DE\\u8C03\\u51FD\\u6570\\u4E2D\\u3002\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// React 18\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"handleClick\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setCount\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"c\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" c \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setFlag\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"f\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u53EA\\u4F1A\\u91CD\\u65B0\\u6E32\\u67D3\\u4E00\\u6B21\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"setTimeout\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setCount\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"c\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" c \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setFlag\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"f\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u53EA\\u4F1A\\u91CD\\u65B0\\u6E32\\u67D3\\u4E00\\u6B21\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1000\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"\\u5982\\u679C\\u4F60\\u6709\\u7279\\u6B8A\\u7684\\u6E32\\u67D3\\u9700\\u6C42\\uFF0C\\u4E0D\\u60F3\\u8FDB\\u884C\\u6279\\u5904\\u7406\\uFF0C\\u4E5F\\u53EF\\u4EE5\\u4F7F\\u7528 \",(0,e.jsx)(n.code,{children:\"flushSync\"}),\" \\u5F02\\u6B65\\u66F4\\u65B0\\uFF1A\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsxs)(n.code,{className:\"language-js code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,e.jsxs)(n.span,{className:\"token imports\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" flushSync \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,e.jsx)(n.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'react-dom'\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"handleClick\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"flushSync\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setCounter\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"c\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" c \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u66F4\\u65B0 DOM\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token function\",children:\"flushSync\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token function\",children:\"setFlag\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token parameter\",children:\"f\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"!\"}),\"f\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u66F4\\u65B0 DOM\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.blockquote,{children:(0,e.jsxs)(n.p,{children:[\"\\u60F3\\u4E86\\u89E3\\u66F4\\u591A\\u53EF\\u4EE5\\u770B \",(0,e.jsx)(n.a,{href:\"https://github.com/reactwg/react-18/discussions/21\",children:\"Automatic batching deep dive\"})]})}),(0,e.jsxs)(n.h2,{id:\"\\u7528\\u4E8E\\u7B2C\\u4E09\\u65B9\\u5E93\\u7684-api\",children:[(0,e.jsx)(n.a,{href:\"#\\u7528\\u4E8E\\u7B2C\\u4E09\\u65B9\\u5E93\\u7684-api\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u7528\\u4E8E\\u7B2C\\u4E09\\u65B9\\u5E93\\u7684 API\"]}),(0,e.jsx)(n.p,{children:\"React18 \\u5DE5\\u4F5C\\u7EC4\\u5408\\u4E00\\u4E9B\\u5E93\\u7684\\u7EF4\\u62A4\\u4EBA\\u5458\\u521B\\u5EFA\\u4E86\\u65B0\\u7684 api\\uFF0C\\u6BD4\\u5982\\u6837\\u5F0F \\u5916\\u90E8\\u5B58\\u50A8\\u548C\\u53EF\\u8BBF\\u95EE\\u6027\\u7B49\\u65B9\\u9762\\u9700\\u8981\\u7528\\u5230\\u5E76\\u53D1\\u6E32\\u67D3\\uFF0C\\u4E00\\u4E9B\\u5E93\\u53EF\\u80FD\\u5207\\u6362\\u5230\\u4EE5\\u4E0B api \\u4E4B\\u4E00\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"useId\"}),\" \\u662F\\u4E00\\u4E2A\\u65B0\\u7684 \",(0,e.jsx)(n.code,{children:\"Hook\"}),\"\\uFF0C\\u7528\\u4E8E\\u5728\\u5BA2\\u6237\\u7AEF\\u548C\\u670D\\u52A1\\u7AEF\\u751F\\u6210\\u552F\\u4E00 id\\uFF0C\\u540C\\u65F6\\u907F\\u514D \",(0,e.jsx)(n.code,{children:\"hydration\"}),\" \\u7684\\u4E0D\\u517C\\u5BB9\\uFF0C\\u8FD9\\u53EF\\u4EE5\\u89E3\\u51B3 \",(0,e.jsx)(n.code,{children:\"React 17\"}),\" \\u4EE5\\u53CA\\u66F4\\u4F4E\\u7248\\u672C\\u7684\\u95EE\\u9898\\u3002\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"useSyncExternalStore\"}),\" \\u662F\\u4E00\\u4E2A\\u65B0\\u7684 \",(0,e.jsx)(n.code,{children:\"Hook\"}),\"\\uFF0C\\u5141\\u8BB8\\u5916\\u90E8\\u5B58\\u50A8\\u901A\\u8FC7\\u5F3A\\u5236\\u540C\\u6B65\\u66F4\\u65B0\\u6765\\u652F\\u6301\\u5E76\\u53D1\\u8BFB\\u53D6\\u3002\\u8FD9\\u4E2A\\u65B0\\u7684 API \\u63A8\\u8350\\u7528\\u4E8E\\u4EFB\\u4F55\\u4E0E React \\u5916\\u90E8\\u72B6\\u6001\\u96C6\\u6210\\u7684\\u5E93\\u3002\\u6709\\u5173\\u66F4\\u591A\\u4FE1\\u606F\\uFF0C\\u8BF7\\u53C2\\u89C1 useSyncExternalStore \\u6982\\u8FF0\\u6587\\u7AE0\\u548C useSyncExternalStore API \\u8BE6\\u7EC6\\u4FE1\\u606F\\u3002\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"useInsertionEffect\"}),\" \\u662F\\u4E00\\u4E2A\\u65B0\\u7684 \",(0,e.jsx)(n.code,{children:\"Hook\"}),\"\\uFF0C\\u5B83\\u53EF\\u4EE5\\u89E3\\u51B3 \",(0,e.jsx)(n.code,{children:\"CSS-in-JS\"}),\" \\u5E93\\u5728\\u6E32\\u67D3\\u4E2D\\u52A8\\u6001\\u6CE8\\u5165\\u6837\\u5F0F\\u7684\\u6027\\u80FD\\u95EE\\u9898\\u3002\"]})]}),(0,e.jsxs)(n.p,{children:[\"React 18 \\u8FD8\\u4E3A\\u5E76\\u53D1\\u6E32\\u67D3\\u5F15\\u5165\\u4E86\\u65B0\\u7684 api\\uFF0C\\u4F8B\\u5982 \",(0,e.jsx)(n.code,{children:\"startTransition\"}),\" \\u548C \",(0,e.jsx)(n.code,{children:\"useDeferredValue\"}),\"\\uFF0C\\u5C06\\u5728\\u5373\\u5C06\\u53D1\\u5E03\\u7684\\u7A33\\u5B9A\\u7248\\u672C\\u4E2D\\u5206\\u4EAB\\u66F4\\u591A\\u76F8\\u5173\\u5185\\u5BB9\\u3002\"]}),(0,e.jsxs)(n.h2,{id:\"\\u66F4\\u65B0\\u4E25\\u683C\\u6A21\\u5F0F-strict-mode\",children:[(0,e.jsx)(n.a,{href:\"#\\u66F4\\u65B0\\u4E25\\u683C\\u6A21\\u5F0F-strict-mode\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u66F4\\u65B0\\u4E25\\u683C\\u6A21\\u5F0F (Strict Mode)\"]}),(0,e.jsx)(n.p,{children:\"\\u5728\\u672A\\u6765\\uFF0CReact \\u5E0C\\u671B\\u6DFB\\u52A0\\u4E00\\u4E2A\\u7279\\u6027\\uFF0C\\u5141\\u8BB8 React \\u6DFB\\u52A0\\u548C\\u5220\\u9664 UI \\u7684\\u90E8\\u5206\\uFF0C\\u540C\\u65F6\\u4FDD\\u7559\\u72B6\\u6001\\u3002\\u4F8B\\u5982\\uFF0C\\u5F53\\u7528\\u6237\\u9009\\u9879\\u5361\\u8FDC\\u79BB\\u5C4F\\u5E55\\u5E76\\u8FD4\\u56DE\\u65F6\\uFF0CReact \\u5E94\\u8BE5\\u80FD\\u591F\\u7ACB\\u5373\\u663E\\u793A\\u524D\\u4E00\\u4E2A\\u5C4F\\u5E55\\u3002\\u4E3A\\u6B64\\uFF0CReact \\u5C06\\u4F7F\\u7528\\u4E0E\\u524D\\u9762\\u76F8\\u540C\\u7684\\u7EC4\\u4EF6\\u72B6\\u6001\\u5378\\u8F7D\\u548C\\u91CD\\u65B0\\u6302\\u8F7D\\u6811\\u3002\"}),(0,e.jsx)(n.p,{children:\"\\u8FD9\\u4E2A\\u7279\\u6027\\u5C06\\u4F7F React \\u5177\\u6709\\u66F4\\u597D\\u7684\\u5F00\\u7BB1\\u5373\\u7528\\u6027\\u80FD\\uFF0C\\u4F46\\u662F\\u9700\\u8981\\u7EC4\\u4EF6\\u5BF9\\u591A\\u6B21\\u6302\\u8F7D\\u548C\\u9500\\u6BC1\\u7684\\u6548\\u679C\\u5177\\u6709\\u5F39\\u6027\\u3002\\u5927\\u591A\\u6570\\u6548\\u679C\\u4E0D\\u9700\\u8981\\u4EFB\\u4F55\\u6539\\u53D8\\u5C31\\u53EF\\u4EE5\\u5DE5\\u4F5C\\uFF0C\\u4F46\\u662F\\u6709\\u4E9B\\u6548\\u679C\\u5047\\u8BBE\\u5B83\\u4EEC\\u53EA\\u88AB\\u5B89\\u88C5\\u6216\\u8005\\u9500\\u6BC1\\u4E00\\u6B21\\u3002\"}),(0,e.jsx)(n.p,{children:\"\\u4E3A\\u4E86\\u5E2E\\u52A9\\u8868\\u9762\\u8FD9\\u4E9B\\u95EE\\u9898\\uFF0Creact 18 \\u5F15\\u5165\\u4E86\\u4E00\\u4E2A\\u65B0\\u7684\\u5F00\\u53D1-\\u53EA\\u68C0\\u67E5\\u4E25\\u683C\\u6A21\\u5F0F\\u3002\\u6BCF\\u5F53\\u4E00\\u4E2A\\u7EC4\\u4EF6\\u7B2C\\u4E00\\u6B21\\u6302\\u8F7D\\u65F6\\uFF0C\\u8FD9\\u4E2A\\u65B0\\u7684\\u68C0\\u67E5\\u5C06\\u81EA\\u52A8\\u5378\\u8F7D\\u548C\\u91CD\\u65B0\\u6302\\u8F7D\\u6BCF\\u4E2A\\u7EC4\\u4EF6\\uFF0C\\u6062\\u590D\\u7B2C\\u4E8C\\u6B21\\u6302\\u8F7D\\u65F6\\u4EE5\\u524D\\u7684\\u72B6\\u6001\\u3002\"}),(0,e.jsxs)(n.h2,{id:\"\\u914D\\u7F6E\\u4F60\\u7684\\u6D4B\\u8BD5\\u73AF\\u5883\",children:[(0,e.jsx)(n.a,{href:\"#\\u914D\\u7F6E\\u4F60\\u7684\\u6D4B\\u8BD5\\u73AF\\u5883\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u914D\\u7F6E\\u4F60\\u7684\\u6D4B\\u8BD5\\u73AF\\u5883\"]}),(0,e.jsx)(n.p,{children:\"\\u5F53\\u60A8\\u7B2C\\u4E00\\u6B21\\u66F4\\u65B0\\uFF0C\\u4F7F\\u7528\\u4E86 createRoot \\u65F6\\uFF0C\\u60A8\\u53EF\\u80FD\\u4F1A\\u5728\\u63A7\\u5236\\u53F0\\u4E2D\\u770B\\u5230\\u8FD9\\u4E2A\\u8B66\\u544A:\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"The current testing environment is not configured to support act(\\u2026)\"})})}),(0,e.jsxs)(n.p,{children:[\"\\u8981\\u89E3\\u51B3\\u8FD9\\u4E2A\\u95EE\\u9898\\uFF0C\\u8BF7\\u5728\\u8FD0\\u884C\\u6D4B\\u8BD5\\u4E4B\\u524D\\u5C06 \",(0,e.jsx)(n.code,{children:\"globalThis.IS react act act environment\"}),\" \\u8BBE\\u7F6E\\u4E3A \",(0,e.jsx)(n.code,{children:\"true\"}),\":\"]}),(0,e.jsx)(n.pre,{className:\"language-js\",children:(0,e.jsx)(n.code,{className:\"language-js code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"globalThis\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token constant\",children:\"IS_REACT_ACT_ENVIRONMENT\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean\",children:\"true\"}),`\n`]})})}),(0,e.jsxs)(n.p,{children:[\"\\u6807\\u5FD7\\u7684\\u4F5C\\u7528\\u662F\\u544A\\u8BC9 React \\u5B83\\u5728\\u7C7B\\u4F3C\\u4E8E\\u5355\\u5143\\u6D4B\\u8BD5\\u7684\\u73AF\\u5883\\u4E2D\\u8FD0\\u884C\\u3002\\u5982\\u679C\\u4F60\\u5FD8\\u8BB0\\u7528 \",(0,e.jsx)(n.code,{children:\"act\"}),\" \\u5305\\u88F9\\u66F4\\u65B0\\uFF0C\\u5219\\u54CD\\u5E94\\u5C06\\u8BB0\\u5F55\\u6709\\u7528\\u7684\\u8B66\\u544A\\u4FE1\\u606F\\u3002\"]}),(0,e.jsxs)(n.p,{children:[\"\\u60A8\\u8FD8\\u53EF\\u4EE5\\u5C06\\u6807\\u5FD7\\u8BBE\\u7F6E\\u4E3A \",(0,e.jsx)(n.code,{children:\"false\"}),\" \\u6765\\u544A\\u8BC9 React \",(0,e.jsx)(n.code,{children:\"act\"}),\" \\u662F\\u4E0D\\u5FC5\\u8981\\u7684\\u3002\\u8FD9\\u5BF9\\u4E8E\\u6A21\\u62DF\\u5B8C\\u6574\\u6D4F\\u89C8\\u5668\\u73AF\\u5883\\u7684\\u7AEF\\u5230\\u7AEF\\u6D4B\\u8BD5\\u975E\\u5E38\\u6709\\u7528\\u3002\"]}),(0,e.jsx)(n.p,{children:\"\\u6700\\u7EC8\\uFF0C\\u6211\\u4EEC\\u5E0C\\u671B\\u6D4B\\u8BD5\\u5E93\\u80FD\\u591F\\u81EA\\u52A8\\u4E3A\\u60A8\\u914D\\u7F6E\\u8FD9\\u4E2A\\u529F\\u80FD\\u3002\\u4F8B\\u5982\\uFF0C\\u4E0B\\u4E00\\u4E2A\\u7248\\u672C\\u7684 React Testing Library \\u5185\\u7F6E\\u4E86\\u5BF9 React 18 \\u7684\\u652F\\u6301\\uFF0C\\u800C\\u4E0D\\u9700\\u8981\\u4EFB\\u4F55\\u989D\\u5916\\u7684\\u914D\\u7F6E\\u3002\"}),(0,e.jsx)(n.blockquote,{children:(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"act\"}),\" \\u540D\\u79F0\\u6765\\u81EA \",(0,e.jsx)(n.a,{href:\"http://wiki.c2.com/?ArrangeActAssert\",children:\"Arrange-Act-Assert\"}),\" \\u6A21\\u5F0F\\u3002\"]})}),(0,e.jsxs)(n.h2,{id:\"\\u4E0D\\u518D\\u652F\\u6301-ie-\\u6D4F\\u89C8\\u5668\",children:[(0,e.jsx)(n.a,{href:\"#\\u4E0D\\u518D\\u652F\\u6301-ie-\\u6D4F\\u89C8\\u5668\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u4E0D\\u518D\\u652F\\u6301 IE \\u6D4F\\u89C8\\u5668\"]}),(0,e.jsx)(n.p,{children:\"\\u5728\\u8FD9\\u4E2A\\u7248\\u672C\\u4E2D\\uFF0CReact \\u653E\\u5F03\\u4E86\\u5BF9 Internet Explorer \\u7684\\u652F\\u6301\\uFF0C\\u5B83\\u5C06\\u5728 2022 \\u5E74 6 \\u6708 15 \\u65E5\\u5931\\u53BB\\u652F\\u6301\\u3002React \\u505A\\u51FA\\u8FD9\\u4E2A\\u6539\\u53D8\\uFF0C\\u662F\\u56E0\\u4E3A\\u5728 React 18 \\u4E2D\\u5F15\\u5165\\u7684\\u65B0\\u7279\\u6027\\u662F\\u4F7F\\u7528\\u73B0\\u4EE3\\u6D4F\\u89C8\\u5668\\u7684\\u7279\\u6027\\u6784\\u5EFA\\u7684\\uFF0C\\u6BD4\\u5982\\u5FAE\\u4EFB\\u52A1\\uFF0C\\u8FD9\\u4E9B\\u7279\\u6027\\u5728 IE \\u4E2D\\u65E0\\u6CD5\\u5145\\u5206\\u586B\\u5145\\uFF08polyfilled\\uFF09\\u3002\"}),(0,e.jsxs)(n.h2,{id:\"\\u5176\\u4ED6\\u53D8\\u5316\",children:[(0,e.jsx)(n.a,{href:\"#\\u5176\\u4ED6\\u53D8\\u5316\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u5176\\u4ED6\\u53D8\\u5316\"]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://github.com/reactwg/react-18/discussions/82\",children:\"\\u66F4\\u65B0\\u4EE5\\u5220\\u9664\\u201CsetState on unmounted component\\u201D \\u8B66\\u544A\"})}),(0,e.jsx)(n.li,{children:(0,e.jsxs)(n.a,{href:\"https://github.com/reactwg/react-18/discussions/72\",children:[\"Suspense \\u4E0D\\u518D\\u9700\\u8981\",(0,e.jsx)(n.code,{children:\"fallback\"}),\"prop \\u6765\\u6355\\u6349\"]})}),(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://github.com/reactwg/react-18/discussions/75\",children:\"\\u7EC4\\u4EF6\\u73B0\\u5728\\u53EF\\u4EE5\\u6E32\\u67D3 undefined\"})}),(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://github.com/facebook/react/pull/23355\",children:\"\\u5F03\\u7528 renderSubtreeIntoContainer\"})}),(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://github.com/reactwg/react-18/discussions/96\",children:\"StrictMode \\u66F4\\u65B0\\u4E3A\\u9ED8\\u8BA4\\u60C5\\u51B5\\u4E0B\\u4E0D\\u4F1A\\u9759\\u9ED8\\u53CC\\u91CD\\u65E5\\u5FD7\\u8BB0\\u5F55\"})})]}),(0,e.jsxs)(n.p,{children:[\"\\u5982\\u679C\\u5927\\u5BB6\\u60F3\\u4E86\\u89E3\\u66F4\\u591A\\u5185\\u5BB9\\uFF0C\\u6B22\\u8FCE\\u67E5\\u770B \",(0,e.jsx)(n.code,{children:\"React\"}),\" \\u5B98\\u65B9\\u535A\\u5BA2\\uFF1A\",(0,e.jsx)(n.a,{href:\"https://reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html\",children:\"https://reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html\"})]}),(0,e.jsx)(n.p,{children:\"\\u4EE5\\u4E0A\\u5C31\\u662F\\u672C\\u6587\\u5168\\u90E8\\u5185\\u5BB9\\uFF0C\\u5E0C\\u671B\\u8FD9\\u7BC7\\u6587\\u7AE0\\u5BF9\\u5927\\u5BB6\\u6709\\u6240\\u5E2E\\u52A9\\uFF0C\\u4E5F\\u53EF\\u4EE5\\u53C2\\u8003\\u6211\\u5F80\\u671F\\u7684\\u6587\\u7AE0\\u6216\\u8005\\u5728\\u8BC4\\u8BBA\\u533A\\u4EA4\\u6D41\\u4F60\\u7684\\u60F3\\u6CD5\\u548C\\u5FC3\\u5F97\\uFF0C\\u6B22\\u8FCE\\u4E00\\u8D77\\u63A2\\u7D22\\u524D\\u7AEF\\u3002\"}),(0,e.jsxs)(n.p,{children:[\"\\u672C\\u6587\\u9996\\u53D1\\u6398\\u91D1\\u5E73\\u53F0\\uFF0C\\u6765\\u6E90\",(0,e.jsx)(n.a,{href:\"https://maqib.cn/blog/react-18-upgrade-guide%22\",children:\"\\u5C0F\\u9A6C\\u535A\\u5BA2\"})]})]})}}var w=R;function A(a,c){throw new Error(\"Expected \"+(c?\"component\":\"object\")+\" `\"+a+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return y(I);})();\n;return Component;","toc":[{"value":"安装","url":"#安装","depth":2},{"value":"客户端渲染 API 的更新","url":"#客户端渲染-api-的更新","depth":2},{"value":"1. 替换 render 函数为 createRoot","url":"#1-替换-render-函数为-createroot","depth":3},{"value":"hydrate 升级到 hydrateRoot","url":"#hydrate-升级到-hydrateroot","depth":3},{"value":"服务端渲染 API 的更新","url":"#服务端渲染-api-的更新","depth":2},{"value":"自动批处理 (Automatic Batching)","url":"#自动批处理-automatic-batching","depth":2},{"value":"用于第三方库的 API","url":"#用于第三方库的-api","depth":2},{"value":"更新严格模式 (Strict Mode)","url":"#更新严格模式-strict-mode","depth":2},{"value":"配置你的测试环境","url":"#配置你的测试环境","depth":2},{"value":"不再支持 IE 浏览器","url":"#不再支持-ie-浏览器","depth":2},{"value":"其他变化","url":"#其他变化","depth":2}],"frontMatter":{"readingTime":{"text":"7 min read","minutes":6.33,"time":379800,"words":1266},"slug":"react-18-upgrade-guide","fileName":"react-18-upgrade-guide.md","title":"如何升级到 React 18发布候选版 ","date":"2022-03-14T16:00:00.000Z","lastmod":"2022/3/15","tags":["前端","React.js"],"draft":false,"summary":"上周 react 官网 发布了react@rc 版本，该版本是候选版本(Release Candidate)，这意味API已经基本稳定，跟最终版本不会有太大差别，官网也发布博客《如何升级到 react18 RC 版本》，鼓励大家尝试升级，所以我们可以在项目组中使用了！下面内容来自是官方文档的翻译。","images":["https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ca9595ccd1479f86d71903184a4d0b~tplv-k3u1fbpfcp-watermark.image?"],"authors":["default"],"layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.19,"time":11400,"words":38},"slug":["default"],"fileName":"default.md","name":"随风","avatar":"/static/images/avatar.jpeg","occupation":"前端工程师","company":"分享 JavaScript 热门框架，记录前端工程师学习成长历程。","email":"tianping888@163.com","juejin":"https://juejin.cn","zhihu":"https://www.zhihu.com","github":"https://github.com/balac2015","date":null}],"prev":{"title":"如何使用 react 和 three.js 在网站渲染自己的3D模型","date":"2022-03-11T16:00:00.000Z","lastmod":"2022/03/12","tags":["JavaScript","React.js"],"draft":false,"summary":"在本文中，我将介绍如何在 react 项目中使用 react-three-fiber 创建的一个3D 软件程序，配置3D 参数(如 Blender 或 Maya ) 。在本文结束时，您将能够在您的网站上渲染一个3D模型 (gltf / glb)。","images":["https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/03e816da47944c2da6ed00f76e0a7419~tplv-k3u1fbpfcp-zoom-crop-mark:3024:3024:3024:1702.awebp?"],"layout":"PostLayout","slug":"use-threejs-and-react-to-render-a-3d-model-of-your-self"},"next":{"title":"我用 nodejs 爬了一万多张小姐姐壁纸","date":"2022-03-22T16:00:00.000Z","lastmod":"2022/3/23","tags":["Node.js"],"draft":false,"summary":"本文主要讲述如何使用 nodejs 爬虫，以及如何用nodejs 下载图片。为什么要下载这么多图片呢？ 前几天使用 uniapp + uniCloud 免费部署了一个壁纸小程序。","layout":"PostLayout","slug":"node-reptile"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["react-18-upgrade-guide"]},"buildId":"1YpokCm8LeHo6uVUXlBkJ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>