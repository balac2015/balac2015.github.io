<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9163539254569883" crossorigin="anonymous"></script><title>使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站</title><meta name="robots" content="follow, index"/><meta name="description" content="本文将以实现一个视频网站为例，介绍 Next.js 和 Prisma 开发的全过程，prisma 对于 Next.js 来说，可谓是如虎添翼，有了它们，我们前端工程师轻松步入了全栈开发。"/><meta property="og:url" content="https://github.com/balac2015/blog/%E4%BD%BF%E7%94%A8%20Next.js%E3%80%81%20Prisma%20%E5%92%8C%20PostgreSQL%20%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E8%A7%86%E9%A2%91%E7%BD%91%E7%AB%99"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Coding 工坊 | 随风"/><meta property="og:description" content="本文将以实现一个视频网站为例，介绍 Next.js 和 Prisma 开发的全过程，prisma 对于 Next.js 来说，可谓是如虎添翼，有了它们，我们前端工程师轻松步入了全栈开发。"/><meta property="og:title" content="使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站"/><meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f670f626e68949df8f2a0479c8ac3833~tplv-k3u1fbpfcp-watermark.image?"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站"/><meta name="twitter:description" content="本文将以实现一个视频网站为例，介绍 Next.js 和 Prisma 开发的全过程，prisma 对于 Next.js 来说，可谓是如虎添翼，有了它们，我们前端工程师轻松步入了全栈开发。"/><meta name="twitter:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f670f626e68949df8f2a0479c8ac3833~tplv-k3u1fbpfcp-watermark.image?"/><meta property="article:published_time" content="2022-10-11T15:57:14.000Z"/><meta property="article:modified_time" content="2023-01-25T03:42:57.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://github.com/balac2015/blog/使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站"
  },
  "headline": "使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f670f626e68949df8f2a0479c8ac3833~tplv-k3u1fbpfcp-watermark.image?"
    }
  ],
  "datePublished": "2022-10-11T15:57:14.000Z",
  "dateModified": "2023-01-25T03:42:57.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "随风"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "随风",
    "logo": {
      "@type": "ImageObject",
      "url": "https://github.com/balac2015/static/images/logo.png"
    }
  },
  "description": "本文将以实现一个视频网站为例，介绍 Next.js 和 Prisma 开发的全过程，prisma 对于 Next.js 来说，可谓是如虎添翼，有了它们，我们前端工程师轻松步入了全栈开发。"
}</script><meta name="next-head-count" content="21"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><meta name="referrer" content="no-referrer"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/25273f18028757eb.css" as="style"/><link rel="stylesheet" href="/_next/static/css/25273f18028757eb.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-aa6d11a2cbee1d88.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-b4cdd9636ac3694c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4836687097acf3aa.js" defer=""></script><script src="/_next/static/chunks/410-dc08c716b48ef576.js" defer=""></script><script src="/_next/static/chunks/606-cacae28ada536e4b.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-a12f8dbad1f7fc24.js" defer=""></script><script src="/_next/static/Ux8AS9faFauxpggf8Sa_-/_buildManifest.js" defer=""></script><script src="/_next/static/Ux8AS9faFauxpggf8Sa_-/_ssgManifest.js" defer=""></script><script src="/_next/static/Ux8AS9faFauxpggf8Sa_-/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><h1><a aria-label="随风小站" href="/"><div class="flex items-center justify-between"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2740%27%20height=%2726%27/%3e"/></span><img alt="logo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="logo" srcSet="/static/logo.png 1x, /static/logo.png 2x" src="/static/logo.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span><div class="hidden text-2xl font-semibold sm:block">随风小站</div></div></a></h1><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">文章</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">标签</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/projects">项目</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tool">工具</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/nav">导航</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">关于</a></div><div class="ml-1 mr-1 flex items-center sm:ml-4"><a class="block p-1" title="RSS" href="/feed.xml"><svg fill="currentColor" class="h-5 w-5" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3.75 3a.75.75 0 00-.75.75v.5c0 .414.336.75.75.75H4c6.075 0 11 4.925 11 11v.25c0 .414.336.75.75.75h.5a.75.75 0 00.75-.75V16C17 8.82 11.18 3 4 3h-.25z"></path><path d="M3 8.75A.75.75 0 013.75 8H4a8 8 0 018 8v.25a.75.75 0 01-.75.75h-.5a.75.75 0 01-.75-.75V16a6 6 0 00-6-6h-.25A.75.75 0 013 9.25v-.5zM7 15a2 2 0 11-4 0 2 2 0 014 0z"></path></svg></a><button aria-label="Toggle Dark Mode" type="button" class="h-7 w-7 rounded p-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button></div><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-50 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">文章</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">标签</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">项目</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tool">工具</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/nav">导航</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">关于</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div style="transform:translateX(-100%)" class="fixed top-0 left-0 h-1 w-full bg-primary-500 backdrop-blur-3xl transition-transform duration-150"></div><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2022-10-11T15:57:14.000Z">2022年10月11日星期二</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><div class=""><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img alt="avatar" src="/static/images/avatar.jpeg" width="38px" height="38px" class="h-10 w-10 rounded-full"/><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">作者</dt><dd class="text-gray-900 dark:text-gray-100">随风</dd></dl></li></ul></dd></dl><h2 class="pt-6 text-xs font-bold uppercase tracking-wide text-gray-500 dark:text-gray-400">目录</h2><ul class="py-4 text-sm font-medium leading-relaxed xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><li class="false"><a class="text-primary-500" href="#前言">前言</a></li><li class="false"><a class="text-primary-500" href="#阅读本文你将收获">阅读本文，你将收获：</a></li><li class="false"><a class="text-primary-500" href="#初始化项目">初始化项目</a></li><li class="false"><a class="text-primary-500" href="#开发环境">开发环境</a></li><li class="ml-6"><a class="text-primary-500" href="#安装-docker">安装 Docker</a></li><li class="ml-6"><a class="text-primary-500" href="#创建-postgresql-实例">创建 PostgreSQL 实例</a></li><li class="false"><a class="text-primary-500" href="#需求分析">需求分析</a></li><li class="false"><a class="text-primary-500" href="#数据实体关系图">数据实体关系图</a></li><li class="false"><a class="text-primary-500" href="#初始化-prisma">初始化 Prisma</a></li><li class="ml-6"><a class="text-primary-500" href="#设置环境变量">设置环境变量</a></li><li class="ml-6"><a class="text-primary-500" href="#了解-prisma-schema">了解 Prisma schema</a></li><li class="false"><a class="text-primary-500" href="#对数据建模">对数据建模</a></li><li class="false"><a class="text-primary-500" href="#迁移数据库">迁移数据库</a></li><li class="false"><a class="text-primary-500" href="#为数据库播种数据">为数据库播种数据</a></li><li class="false"><a class="text-primary-500" href="#nextjs-中实例化-prismaclient">Next.js 中实例化 PrismaClient</a></li><li class="false"><a class="text-primary-500" href="#详情页面实现">详情页面实现</a></li><li class="ml-6"><a class="text-primary-500" href="#翻页接口">翻页接口</a></li><li class="ml-6"><a class="text-primary-500" href="#滚动翻页">滚动翻页</a></li><li class="false"><a class="text-primary-500" href="#小结">小结</a></li><li class="false"><a class="text-primary-500" href="#后续">后续</a></li></ul></div><div class="xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="mt-6"><img alt="使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站" class="w-full rounded object-cover shadow-lg" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f670f626e68949df8f2a0479c8ac3833~tplv-k3u1fbpfcp-watermark.image?"/></div><div class="prose max-w-none break-words pt-10 pb-8 dark:prose-dark"><hr/><p>highlight: monokai theme: vuepress</p><hr/><blockquote><p>文章为稀土掘金技术社区首发签约文章，14 天内禁止转载，14 天后未获授权禁止转载，侵权必究！</p></blockquote><h2 id="前言"><a href="#前言" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>前言</h2><p>在前面的文章中，我们使用了 Notion 笔记作为数据库和 Next.js 开发了一个面试刷题网站，也结合了 Strapi 这款无头 CMS 系统开发了一个微博应用，Strapi 默认使用的 SQLite，SQLite 是一个基于文件的嵌入式关系数据库系统，优点是精巧、单机部署以及方便的可移植性，但缺点也是因为文件系统本身的限制，可能会在较大数据集的情况下导致性能问题。今天我们来使用另一款关系型数据库 PostgreSQL，可以轻松应对大数据集的场景，并且直接支持 JSON 数据类型存储，也是企业应用程序中最受欢迎的数据库之一，然后配合当下非常流行的 Nodejs ORM 框架 Prisma ，让 Next.js 全栈开发变得更加简单！</p><p>本文将以实现一个视频网站为例，介绍 Next.js 和 Prisma 开发的全过程。</p><h2 id="阅读本文你将收获"><a href="#阅读本文你将收获" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>阅读本文，你将收获：</h2><ul><li>如何使用 Docker 启一个数据库服务</li><li>如何使用 Prisma Schema 管理数据表</li><li>如何在 Next.js 中调用 Prisma 查询语句</li></ul><p>文中涉及代码全部托管在 <a target="_blank" rel="noopener noreferrer" href="https://github.com/maqi1520/next-prisma-video-app" title="GitHub 仓库代码">GitHub 仓库</a>中。</p><h2 id="初始化项目"><a href="#初始化项目" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>初始化项目</h2><p>首先，我们使用 create-next-app 创建一个 Next.js Typescript 工程，并且安装和初始化 Tailwindcss</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">yarn</span> create next-prisma-video-app --typescript
</span><span class="code-line"><span class="token class-name builtin">cd</span> next-prisma-video-app
</span><span class="code-line"><span class="token function">yarn</span> <span class="token function">add</span> tailwindcss postcss autoprefixer --dev
</span><span class="code-line">npx tailwindcss init -p
</span></code></pre></div><p>修改 <code>globals.css</code> 为 <code>tailwindcss</code> 默认指令</p><div class="relative"><pre><code class="code-highlight language-css"><span class="code-line"><span class="token atrule"><span class="token rule">@tailwind</span> base<span class="token punctuation">;</span></span>
</span><span class="code-line"><span class="token atrule"><span class="token rule">@tailwind</span> components<span class="token punctuation">;</span></span>
</span><span class="code-line"><span class="token atrule"><span class="token rule">@tailwind</span> utilities<span class="token punctuation">;</span></span>
</span></code></pre></div><p>运行 <code>yarn dev</code> 进入开发模式，修改页面浏览器会自动热更新，至此我们的前端工程初始化完成。</p><h2 id="开发环境"><a href="#开发环境" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>开发环境</h2><p>接下来，先来说明下本项目涉及到的开发环境</p><ul><li>安装 Docker 或 PostgreSQL。</li><li>VSCode 安装了 Prisma 扩展。</li></ul><h3 id="安装-docker"><a href="#安装-docker" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>安装 Docker</h3><blockquote><p>提示：如果您不想使用 Docker，可以在本地安装 PostgreSQL 实例或者使用云服务商提供的 PostgreSQL 数据库。</p></blockquote><p>前端同学，一般不会在自己的电脑上数据库，不同环境下安装数据库可能会是一个麻烦的过程，我们可以先安装 Docker，通过 Docker 安装一个数据库会变的非常简单。</p><p>没有 Docker 的同学先通过 <a target="_blank" rel="noopener noreferrer" href="https://www.docker.com/" title="docker 官网">docker 官网</a>安装 Docker。</p><p>默认情况下，windows 和 mac 下的 Docker 已经自带了<code>docker-compose</code> 工具，可以使用 <code>docker-compose -v</code> 命令查看。</p><h3 id="创建-postgresql-实例"><a href="#创建-postgresql-实例" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>创建 PostgreSQL 实例</h3><p>下面我们将通过 Docker 容器在您的机器上安装和运行 PostgreSQL。</p><p>首先，在项目的根文件夹中创建一个<code>docker-compose.yml</code>文件：</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">touch</span> docker-compose.yml
</span></code></pre></div><p><code>docker-compose.yml</code> 文件是一个 docker 容器的规范配置文件，包含了 PostgreSQL 初始化设置。在文件中输入以下配置：</p><div class="relative"><pre><code class="code-highlight language-yml"><span class="code-line"><span class="token comment"># docker-compose.yml</span>
</span><span class="code-line"><span class="token atrule key">version</span><span class="token punctuation">:</span> <span class="token string">&#x27;3.1&#x27;</span>
</span><span class="code-line"><span class="token atrule key">services</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">db</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">image</span><span class="token punctuation">:</span> postgres
</span><span class="code-line">    <span class="token atrule key">volumes</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> ./postgres<span class="token punctuation">:</span>/var/lib/postgresql/data
</span><span class="code-line">    <span class="token atrule key">restart</span><span class="token punctuation">:</span> always
</span><span class="code-line">    <span class="token atrule key">ports</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> 5432<span class="token punctuation">:</span><span class="token number">5432</span>
</span><span class="code-line">    <span class="token atrule key">environment</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> POSTGRES_USER=myuser
</span><span class="code-line">      <span class="token punctuation">-</span> POSTGRES_PASSWORD=mypassword
</span><span class="code-line">
</span><span class="code-line">  <span class="token atrule key">adminer</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">image</span><span class="token punctuation">:</span> adminer
</span><span class="code-line">    <span class="token atrule key">restart</span><span class="token punctuation">:</span> always
</span><span class="code-line">    <span class="token atrule key">ports</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token punctuation">-</span> 8080<span class="token punctuation">:</span><span class="token number">8080</span>
</span></code></pre></div><p>上面 yml 文件中，我们初始化了 2 个服务：</p><p>一个是 <code>postgres</code> 对应 5432 端口，volumes 卷代表文件映射，将容器中的数据库映射到当前主机，避免容器服务销毁的时候数据库丢失。</p><p>另一个 <code>adminer</code> 是一个轻量的数据库管理客户端，支持多种关系型数据库，启动在 8080 端口。</p><p>在启动之前请确保 5432 端口和 8080 端不被占用，在命令行中输入以下命令启动服务：</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">docker-compose</span> up -d
</span></code></pre></div><p><code>-d</code>参数可以确保你关闭命令行窗口，docker 服务不被停止。</p><p>此时访问 <code>http://localhost:8080/</code> 便可以使用可视化页面访问 postgres 数据库了。</p><p>输入你设置的用户名和密码便可以看到以下界面</p><p><img alt="Adminer PostgreSQL 管理界面" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/34ab754a8c594147ab5b45e633c497ad~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>当然你若不想使用数据的时候，也可以使用以下命令停止 docker 服务。</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">docker-compose</span> down
</span></code></pre></div><p>停止后，数据库数据不会丢失，因为它存在同目录下的 postgres 目录中，下次启动便可以恢复数据。</p><h2 id="需求分析"><a href="#需求分析" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>需求分析</h2><p>简单概括下需求，我们要实现的视频网站有的类似 B 站或者说是慕课网。</p><ol><li>至少 1 个列表页和一个视频详情页面</li><li>每个视频必须有一个分类</li><li>每个视频必须有一个作者</li><li>每个视频可以分为多个章节</li></ol><h2 id="数据实体关系图"><a href="#数据实体关系图" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>数据实体关系图</h2><p><img alt="数据实体关系图" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58c9e5f1fa964102a56c2f925a88ac39~tplv-k3u1fbpfcp-zoom-1.image"/></p><ol><li>一个作者可以创建多个视频：一对多</li><li>一个分类下可以有多个视频，但一个视频只能属于一个分类： 一个作者可以创建多个视频：一对多</li><li>一个视频可以有多个章节：一对多</li></ol><p>现在数据库和前端项目已经准备好了，是时候设置 Prisma 了！</p><h2 id="初始化-prisma"><a href="#初始化-prisma" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>初始化 Prisma</h2><p>首先，首先安装 Prisma CLI 作为开发依赖项。</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">yarn</span> <span class="token function">add</span> -D prisma
</span></code></pre></div><p>你可以通过运行以下命令在项目中初始化 Prisma：</p><div class="relative"><pre><code class="code-highlight"><span class="code-line">npx prisma init
</span></code></pre></div><p>这一步创建了一个 prisma 目录包含了 <code>schema.prisma</code> 文件，该文件是数据库模型的主要配置文件。此命令还会在项目中创建一个<code>.env</code> 文件。</p><h3 id="设置环境变量"><a href="#设置环境变量" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>设置环境变量</h3><p>在<code>.env</code>文件中，你会看到一个<code>DATABASE_URL</code>环境变量，将此字符串中的数据库连接信息替换为你刚才创建的 PostgreSQL 实例信息。</p><div class="relative"><pre><code class="code-highlight"><span class="code-line">// .env
</span><span class="code-line">DATABASE_URL=&quot;postgres://myuser:mypassword@localhost:5432/median-db&quot;
</span></code></pre></div><h3 id="了解-prisma-schema"><a href="#了解-prisma-schema" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>了解 Prisma schema</h3><p>Prisma Schema 可以让我们更加直观的管理数据表，当我们的数据表有改动时，可以根据 Schema 自动生成 SQl，告别编写 SQl 迁移的烦恼，<a target="_blank" rel="noopener noreferrer" href="https://www.prisma.io/migrate" title="prisma 官网">prisma 官网</a>也直观地展示了 Schem 与 Sql 的关系。</p><p><img alt="prisma 官网演示" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/798b63422b6449a882c9a16d16bfa8ff~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>打开<code>prisma/schema.prisma</code>，你会看到以下默认代码：</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line"><span class="token comment">// prisma/schema.prisma</span>
</span><span class="code-line">
</span><span class="code-line">generator client <span class="token punctuation">{</span>
</span><span class="code-line">  provider <span class="token operator">=</span> <span class="token string">&quot;prisma-client-js&quot;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">datasource db <span class="token punctuation">{</span>
</span><span class="code-line">  provider <span class="token operator">=</span> <span class="token string">&quot;postgresql&quot;</span>
</span><span class="code-line">  url      <span class="token operator">=</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token string">&quot;DATABASE_URL&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>该文件是用 <code>Prisma Schema Language</code>编写的，这是 Prisma 用来定义数据库模式的语言。该文件包含三个主要组成部分：</p><ul><li>datasource：定义数据库类型和链接地址</li><li>generator：指定哪个客户端向数据发送查询语言</li><li>model：定义数据库 Schema。每个 Model 都将映射到数据库底层中的一个表中。目前，我们还没有 model，接下来我们来定义下 model。</li></ul><h2 id="对数据建模"><a href="#对数据建模" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>对数据建模</h2><p>工欲善其事必先利其器，在 VSCode 中安装了 <a target="_blank" rel="noopener noreferrer" href="https://marketplace.visualstudio.com/items?itemName=Prisma.prisma" title="Prisma 扩展">Prisma 扩展</a>，可以让 VSCode 对 Prisma Schema 有语法高亮和输入提示。</p><div class="relative"><pre><code class="code-highlight language-js"><span class="code-line">model <span class="token maybe-class-name">Video</span> <span class="token punctuation">{</span>
</span><span class="code-line">  id         <span class="token maybe-class-name">Int</span>       @id @<span class="token keyword module">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  title      <span class="token class-name known-class-name">String</span>    @unique
</span><span class="code-line">  desc       <span class="token class-name known-class-name">String</span><span class="token operator">?</span>
</span><span class="code-line">  pic        <span class="token class-name known-class-name">String</span>
</span><span class="code-line">  authorId   <span class="token maybe-class-name">Int</span>
</span><span class="code-line">  author     <span class="token maybe-class-name">User</span><span class="token operator">?</span>     @<span class="token function">relation</span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>authorId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token property literal-property">references</span><span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">  categoryId <span class="token maybe-class-name">Int</span>
</span><span class="code-line">  category   <span class="token maybe-class-name">Category</span><span class="token operator">?</span> @<span class="token function">relation</span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>categoryId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token property literal-property">references</span><span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">  level      <span class="token maybe-class-name">Int</span>       @<span class="token keyword module">default</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">  createdAt  <span class="token maybe-class-name">DateTime</span>  @<span class="token keyword module">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  updatedAt  <span class="token maybe-class-name">DateTime</span>  @updatedAt
</span><span class="code-line">  chapter    <span class="token maybe-class-name">Chapter</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">model <span class="token maybe-class-name">Category</span> <span class="token punctuation">{</span>
</span><span class="code-line">  id    <span class="token maybe-class-name">Int</span>     @id @<span class="token keyword module">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  name  <span class="token class-name known-class-name">String</span>  @unique
</span><span class="code-line">  video <span class="token maybe-class-name">Video</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">model <span class="token maybe-class-name">Chapter</span> <span class="token punctuation">{</span>
</span><span class="code-line">  id      <span class="token maybe-class-name">Int</span>    @id @<span class="token keyword module">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  title   <span class="token class-name known-class-name">String</span>
</span><span class="code-line">  url     <span class="token class-name known-class-name">String</span>
</span><span class="code-line">  videoId <span class="token maybe-class-name">Int</span>
</span><span class="code-line">  video   <span class="token maybe-class-name">Video</span><span class="token operator">?</span> @<span class="token function">relation</span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>videoId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token property literal-property">references</span><span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">model <span class="token maybe-class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  id     <span class="token maybe-class-name">Int</span>     @id @<span class="token keyword module">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">  avatar <span class="token class-name known-class-name">String</span>
</span><span class="code-line">  name   <span class="token class-name known-class-name">String</span>
</span><span class="code-line">  video  <span class="token maybe-class-name">Video</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>这里创建了 4 个 Model，<code>Video</code>、<code>Category</code>、<code>Chapter</code>、<code>User</code> 分别对应数据库中的表。每个 Model 中的一行代表一个字段，第一个是名称（如：<code>id</code>、<code>title</code>）、第二个是类型（如：<code>Int</code>、<code>String</code>）和其他可选属性（如：<code>@id</code>、<code>@unique</code>）。在字段类型后面添加一个<code>?</code>来使字段成为可选。</p><p>属性<code>@id</code>表示该字段是模型的主键。<code>@default(autoincrement())</code>属性表示该字段应自动递增</p><p><code>@relation</code> 表示给表创建关联，比如 <code>video Video? @relation(fields: [videoId], references: [id])</code>表示使用<code>videoId</code> 为附键，关联 <code>Video</code> 表中的主键 <code>id</code>,</p><p>当我们保存时，vscode 会自动给&quot;被关联的表&quot;添加字段<code>video Video[]</code> ，并且自动格式化，让表之间的关系一目了然。</p><h2 id="迁移数据库"><a href="#迁移数据库" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>迁移数据库</h2><p>定义 Prisma Schema 后，数据库中还没有真正的表，所以我们要执行一次 migrate(迁移)，第一次迁移，请在终端中运行以下命令：</p><div class="relative"><pre><code class="code-highlight"><span class="code-line">npx prisma migrate dev --name &quot;init&quot;
</span></code></pre></div><p>这个命令会做三件事：</p><ul><li>保存迁移 SQL：Prisma Migrate 将根据 Schema 自动生成所需的 SQL 语句，并且将生成的 SQL 语句保存到新创建的<code>prisma/migrations</code>文件夹中。</li><li>执行迁移：Prisma Migrate 将执行迁移文件中的 SQL 语句，在数据库中创建基础表。</li><li>安装 <code>@prisma/client</code>：由于我们没有安装客户端库，因此 CLI 会帮我们安装它。执行完成后，我们可以在 <code>package.json</code> 中看到安装的 <code>@prisma/client</code> 包，我们将用它向数据库发送查询。</li></ul><p>执行成功后我们可以在命令行中看到以下提示</p><p><img alt="Prisma 迁移成功生成SQL" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a8f25195fe2f4c5cafafe3efd1144c6f~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>我们也可以查看 <code>prisma/migrations</code> 文件夹中的文件，了解底层执行的 SQL 语句，下面便是第一次执行后生成的 SQL。</p><p><img alt="Prisma 生成的SQL" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d15216ae5da24482aa29c6c6033bd4f5~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>此时我发现设计数据库时，少加了一个字段，每个章节的视频少加了一个封面字段，没关系，我们可以直接修改 Schema。</p><div class="relative"><pre><code class="code-highlight language-diff-js"><span class="code-line">model Chapter {
</span><span class="code-line">   id      Int    @id @default(autoincrement())
</span><span class="code-line">   title   String
</span><span class="code-line">+  cover   String
</span><span class="code-line">   url     String
</span><span class="code-line">   videoId Int
</span><span class="code-line">   video   Video? @relation(fields: [videoId], references: [id])
</span><span class="code-line">}
</span></code></pre></div><p>再次执行<code>prisma migrate dev --name added_cover</code>, 数据库中便会同步该字段， <code>prisma/migrations</code> 文件夹下便会多一个 SQL 文件。</p><div class="relative"><pre><code class="code-highlight language-sql"><span class="code-line"><span class="token comment">-- AlterTable</span>
</span><span class="code-line"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;Chapter&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">COLUMN</span>     <span class="token string">&quot;cover&quot;</span> <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</span></code></pre></div><p>如果在生产环境中，变动数据库结构，我们需要将这些生成的 SQL 文件提交到 git 中。在代码部署前执行<code>npx prisma migrate deploy</code> 来应用这些 SQL 的改动。</p><h2 id="为数据库播种数据"><a href="#为数据库播种数据" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>为数据库播种数据</h2><p>到目前为止，数据库还是为空的，因此，我们需要创建一个种子脚本，填充一些初始数据进入数据库，有些初始数据是程序必不可少的，比如货币语言信息等，有时候开发需要重置数据库，因此为数据库播种也很有必要。</p><p>首先，创建一个名为<code>prisma/seed.ts</code>。 然后粘贴以下模板代码</p><div class="relative"><pre><code class="code-highlight language-ts"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@prisma/client&#x27;</span>
</span><span class="code-line"><span class="token comment">// 初始化 Prisma Client</span>
</span><span class="code-line"><span class="token keyword">const</span> prisma <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrismaClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">//在此编写 Prisma Client 查询</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
</span><span class="code-line">    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token comment">// 关闭 Prisma Client</span>
</span><span class="code-line">    <span class="token keyword">await</span> prisma<span class="token punctuation">.</span><span class="token function">$disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre></div><p>为了能够让 nodejs 运行 typescript，我们需要安装<code>ts-node</code></p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">yarn</span> <span class="token function">add</span> ts-node --dev
</span></code></pre></div><p>然后在 <code>tsconfig.json</code> 中指定输出格式为 <code>commonjs</code></p><div class="relative"><pre><code class="code-highlight language-json"><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">&quot;ts-node&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>接下来，我们在 <code>main</code> 函数中创建一个用户</p><div class="relative"><pre><code class="code-highlight language-ts"><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    data<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      name<span class="token operator">:</span> <span class="token string">&#x27;小马&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">      avatar<span class="token operator">:</span>
</span><span class="code-line">        <span class="token string">&#x27;https://p3-passport.byteimg.com/img/user-avatar/585e1491713363bc8f67d06c485e8260~100x100.awebp&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>在该函数中，涉及数据模型（<code>prisma.user</code>）、data(<code>name, avatar</code>) 参数等，我们都可以使用<code>control + 空格键</code>来体验 typescript 带来的智能提示。</p><p>执行命令</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">npx ts-node ./prisma/seed.ts
</span></code></pre></div><p>执行后，我们就可以在数据库中看到这条添加的数据。</p><p><img alt="播种的用户数据" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ca1360f70fcb4be08f4a03468caccd28~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>视频数据我找了“译学馆”中的一个<a target="_blank" rel="noopener noreferrer" href="https://api.yxgapp.com/courses/1087" title="译学馆">API</a> 作为我的初始数据，修改 <code>main</code> 函数来填充视频数据。</p><div class="relative"><pre><code class="code-highlight language-ts"><span class="code-line"><span class="token keyword">import</span> example <span class="token keyword">from</span> <span class="token string">&#x27;./example.json&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> category <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>category<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    data<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      name<span class="token operator">:</span> <span class="token string">&#x27;数学&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">const</span> chapters <span class="token operator">=</span> example<span class="token punctuation">.</span>data<span class="token punctuation">.</span>outlines<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    item<span class="token punctuation">.</span>lectures<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lecture<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">      res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">        title<span class="token operator">:</span> lecture<span class="token punctuation">.</span>title <span class="token operator">??</span> lecture<span class="token punctuation">.</span>en_title <span class="token operator">??</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">        cover<span class="token operator">:</span> lecture<span class="token punctuation">.</span>resource<span class="token punctuation">.</span>cover_url<span class="token punctuation">,</span>
</span><span class="code-line">        url<span class="token operator">:</span> lecture<span class="token punctuation">.</span>resource<span class="token punctuation">.</span>content<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> res
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chapters<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>video<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    data<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      title<span class="token operator">:</span> example<span class="token punctuation">.</span>data<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
</span><span class="code-line">      pic<span class="token operator">:</span> example<span class="token punctuation">.</span>data<span class="token punctuation">.</span>cover_url<span class="token punctuation">,</span>
</span><span class="code-line">      desc<span class="token operator">:</span> example<span class="token punctuation">.</span>data<span class="token punctuation">.</span>brief<span class="token punctuation">,</span>
</span><span class="code-line">      categoryId<span class="token operator">:</span> category<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
</span><span class="code-line">      authorId<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
</span><span class="code-line">      chapter<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">        createMany<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">          data<span class="token operator">:</span> chapters<span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>再次执行 <code>npx ts-node prisma/seed.ts</code>, 视频数据已经添加到了我们的数据库中。</p><p><img alt="播种的视频数据" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6138ac7b77634e83a6cbc3f4e50ffdef~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>在 package.json 中添加 <code>prisma.seed</code> 字段</p><div class="relative"><pre><code class="code-highlight language-diff-json"><span class="code-line">{
</span><span class="code-line">+  &quot;prisma&quot;: {
</span><span class="code-line">+    &quot;seed&quot;: &quot;ts-node prisma/seed.ts&quot;
</span><span class="code-line">+  },
</span><span class="code-line">   &quot;devDependencies&quot;: {
</span><span class="code-line">
</span><span class="code-line">   }
</span><span class="code-line">}
</span></code></pre></div><p>在开发中如再次修改数据表，执行 <code>prisma migrate dev</code> 的时候会自动执行 <code>seed</code>播种数据，关于播种数据详情请看 <a target="_blank" rel="noopener noreferrer" href="https://www.prisma.io/docs/guides/database/seed-database" title="prisma 文档">prisma 文档</a></p><h2 id="nextjs-中实例化-prismaclient"><a href="#nextjs-中实例化-prismaclient" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Next.js 中实例化 PrismaClient</h2><p>接下来我们需要在 Next.js 中调用 Prisma 查询语言，用于服务端获取数据。</p><p>新建一个 <code>lib/prisma.ts</code></p><p>输入以下代码：</p><div class="relative"><pre><code class="code-highlight language-ts"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@prisma/client&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">let</span> prisma<span class="token operator">:</span> PrismaClient
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&#x27;production&#x27;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  prisma <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrismaClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>global<span class="token punctuation">.</span>prisma<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    global<span class="token punctuation">.</span>prisma <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrismaClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  prisma <span class="token operator">=</span> global<span class="token punctuation">.</span>prisma
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> prisma
</span></code></pre></div><p>上面代码是为了防止，在开发模式下， <code>PrismaClient</code> 耗尽数据链接数，将实例化的 <code>PrismaClient</code> 对象存到全局 <code>global</code> 中， 详情可以看官网<a target="_blank" rel="noopener noreferrer" href="https://www.prisma.io/docs/guides/database/troubleshooting-orm/help-articles/nextjs-prisma-client-dev-practices" title="最佳实践">最佳实践</a>。</p><p>PrismaClient 实例化完成，已经迫不及待要在首页渲染数据了， 先在首页打印下服务端获取的数据：</p><div class="relative"><pre><code class="code-highlight language-tsx"><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;react&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">GetServerSideProps</span> <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;next&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports">prisma</span> <span class="token keyword">from</span> <span class="token string">&#x27;../lib/prisma&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> makeSerializable <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;../lib/util&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">Video</span><span class="token punctuation">,</span> <span class="token maybe-class-name">User</span> <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;@prisma/client&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">type</span> <span class="token class-name">Props</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  data<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token maybe-class-name">Video</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    author<span class="token operator">:</span> <span class="token maybe-class-name">User</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token maybe-class-name">Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token class-name console">console</span><span class="token punctuation">.</span><span class="token function property-access method">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mx-auto max-w-5xl px-3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">首页</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> getServerSideProps<span class="token operator">:</span> <span class="token function function-variable">GetServerSideProps</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span><span class="token property-access">video</span><span class="token punctuation">.</span><span class="token function property-access method">findMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    include<span class="token operator">:</span> <span class="token punctuation">{</span> author<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="code-line">    props<span class="token operator">:</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token function">makeSerializable</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>使用 prisma Schema 生成数据模型还有一个优势就是，减少写 typescript 接口的烦恼，凡是数据模型和增删查改相关的 <code>typescript interface</code> 都可以直接从 <code>@prisma/client</code>中直接引用；</p><p>Next.js 中，服务端渲染的数据在 <code>getServerSideProps</code> 函数中获取，如果直接将数据库中的数据查出传递给 <code>props</code>，会在控制台中看到如下错误:</p><p><img alt="Next.js 渲染未序列化的数据报错" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e08bca9f78d481d9319795072a6014a~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>原因 Next.js 服务端获取的数据都是通过 JSON 的形式输出在 window 全局对象上的，而是 <code>createAt</code> 是 <code>Date</code> 类型，是一个 <code>Object</code>对象，所以无法被 JSON 序列化，因此我们需要让数据变得可序列化<code>makeSerializable</code>，代码如下：</p><div class="relative"><pre><code class="code-highlight language-ts"><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">makeSerializable</span><span class="token class-name generic"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>序列化后的数据，便可以在控制台中打印，然后就可以使用 React 愉快地渲染数据了，我们使用 Tailwindcss 中的 Grid 布局，将页面分成 2 栏，最终效果如下：</p><p><img alt="视频首页" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/501a8384679546e18247b714b928759a~tplv-k3u1fbpfcp-zoom-1.image"/></p><h2 id="详情页面实现"><a href="#详情页面实现" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>详情页面实现</h2><p>接着我们使用同样的逻辑，来实现下详情页面。新建一个<code>./pages/video/[id].tsx</code> 文件按首页的逻辑，我们写下了如下代码</p><div class="relative"><pre><code class="code-highlight language-ts"><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> getServerSideProps<span class="token operator">:</span> <span class="token function function-variable">GetServerSideProps</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>video<span class="token punctuation">.</span><span class="token function">findUnique</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    include<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      chapter<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">      author<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    where<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      id<span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="code-line">    props<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      data<span class="token operator">:</span> <span class="token function">makeSerializable</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>可以通过 <code>context.params.id</code>获取 url 上的 <code>videoId</code>，<code>findUnique</code>方法可以查询数据库中的唯一记录。此时访问 <code>http://localhost:3000/video/1</code>，我们便可以在控制台上打印出 data 参数。</p><p><img alt="全部视频章节数据" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/12d2db88086042ac92903a4918d836cf~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>由于章节数量太多，在一个页面中一次渲染 210 条数据是不合理的，比较好的办法是将“章节数据”通过接口来获取，实现滚动翻页。</p><h3 id="翻页接口"><a href="#翻页接口" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>翻页接口</h3><p>新建一个 <code>./pages/api/chapter.ts</code> 文件，用于获取视频章节数据的接口，输入以下接口代码</p><div class="relative"><pre><code class="code-highlight language-ts"><span class="code-line"><span class="token keyword">import</span> prisma <span class="token keyword">from</span> <span class="token string">&#x27;@/lib/prisma&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> makeSerializable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@/lib/util&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> NextApiRequest<span class="token punctuation">,</span> NextApiResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;next&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handler</span><span class="token punctuation">(</span>req<span class="token operator">:</span> NextApiRequest<span class="token punctuation">,</span> res<span class="token operator">:</span> NextApiResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> videoId<span class="token punctuation">,</span> cursor <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>query
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>videoId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&#x27;videoId is required&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>chapter<span class="token punctuation">.</span><span class="token function">findMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    cursor<span class="token operator">:</span> cursor <span class="token operator">&amp;&amp;</span> <span class="token punctuation">{</span>
</span><span class="code-line">      id<span class="token operator">:</span> <span class="token operator">+</span>cursor<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    take<span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
</span><span class="code-line">    where<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      videoId<span class="token operator">:</span> <span class="token operator">+</span>videoId<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    data<span class="token operator">:</span> <span class="token function">makeSerializable</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    nextCursor<span class="token operator">:</span> data<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">?.</span>id<span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>上面代码中，我们使用<code>take</code> 和 <code>cursor</code>来实现翻页，默认查询 11 条数据，但只返回前 10 条数据，将最后一条数据作为下次查询的指针。</p><p>保存代码后，访问下接口地址 <a target="_blank" rel="noopener noreferrer" href="http://localhost:3000/api/chapter?videoId=1">http://localhost:3000/api/chapter?videoId=1</a></p><p><img alt="视频章节翻页接口" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fb3bd6f0fc4d4bebbbcbd7d902ed221e~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>我们可以看到返回 10 条数据和下一个章节的指针，至此分页接口实现完成。</p><h3 id="滚动翻页"><a href="#滚动翻页" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>滚动翻页</h3><p>详情页分类 2 个部分，视频基础信息是在服务端渲染，章节信息通过接口在客户端渲染，为了方便实现滚动翻页，我们安装一个包 [swr](SWR: <a target="_blank" rel="noopener noreferrer" href="https://swr.vercel.app/),%E5%85%A8%E7%A7%B0%E6%98%AF">https://swr.vercel.app/),全称是</a> stale-while-revalidate，也是 vercel 开源的一个数据流请求库。</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">yarn</span> <span class="token function">add</span>  swr
</span></code></pre></div><p>修改 <code>./pages/video/[id].tsx</code> 中的代码为以下代码</p><div class="relative"><pre><code class="code-highlight language-tsx"><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token maybe-class-name">React</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> useRef<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;react&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">GetServerSideProps</span> <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;next&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token maybe-class-name">Link</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;next/link&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token maybe-class-name">Image</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;next/image&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports">prisma</span> <span class="token keyword">from</span> <span class="token string">&#x27;@/lib/prisma&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> makeSerializable <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;@/lib/util&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">Video</span><span class="token punctuation">,</span> <span class="token maybe-class-name">User</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Chapter</span> <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">&#x27;@prisma/client&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports">useSWRInfinite</span> <span class="token keyword">from</span> <span class="token string">&#x27;swr/infinite&#x27;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token imports">useOnScreen</span> <span class="token keyword">from</span> <span class="token string">&#x27;@/hooks/useOnScreen&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">type</span> <span class="token class-name">Props</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  video<span class="token operator">:</span> <span class="token maybe-class-name">Video</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    author<span class="token operator">:</span> <span class="token maybe-class-name">User</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token maybe-class-name">Chapter</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> nextCursor<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> <span class="token function function-variable">getKey</span> <span class="token operator">=</span> <span class="token punctuation">(</span>pageIndex<span class="token punctuation">,</span> previousPageData<span class="token punctuation">,</span> videoId<span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// reached the end</span>
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>previousPageData <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>previousPageData<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 首页，没有 `previousPageData`</span>
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>pageIndex <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">/api/chapter?videoId=</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>videoId<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 将游标添加到 API</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">/api/chapter?cursor=</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>previousPageData<span class="token punctuation">.</span>nextCursor<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">&amp;videoId=</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>videoId<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> <span class="token function function-variable">fetcher</span> <span class="token operator">=</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function property-access method">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> res<span class="token punctuation">.</span><span class="token function property-access method">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span> video <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token maybe-class-name">Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> ref<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token class-name generic"><span class="token operator">&lt;</span>HTMLDivElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">const</span> onScreen<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useOnScreen</span><span class="token class-name generic"><span class="token operator">&lt;</span>HTMLDivElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>ref<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> error<span class="token punctuation">,</span> size<span class="token punctuation">,</span> setSize <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useSWRInfinite</span><span class="token class-name generic"><span class="token operator">&lt;</span>Result<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token operator spread">...</span>args<span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token function">getKey</span><span class="token punctuation">(</span><span class="token operator spread">...</span>args<span class="token punctuation">,</span> video<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    fetcher<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">{</span>
</span><span class="code-line">      revalidateFirstPage<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> hasNext <span class="token operator">=</span> data <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">[</span>data<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">nextCursor</span>
</span><span class="code-line">  <span class="token keyword">const</span> isLoadingInitialData <span class="token operator">=</span> <span class="token operator">!</span>data <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>error
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> isLoadingMore <span class="token operator">=</span>
</span><span class="code-line">    isLoadingInitialData <span class="token operator">||</span> <span class="token punctuation">(</span>size <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> data <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> data<span class="token punctuation">[</span>size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#x27;undefined&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>onScreen <span class="token operator">&amp;&amp;</span> hasNext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token function">setSize</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>onScreen<span class="token punctuation">,</span> hasNext<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mx-auto max-w-5xl px-3 pb-5<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-4 text-center text-3xl<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>video<span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Image</span></span> <span class="token attr-name">src</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>video<span class="token punctuation">.</span><span class="token property-access">pic</span><span class="token punctuation">}</span></span> <span class="token attr-name">width</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span><span class="token number">320</span><span class="token punctuation">}</span></span> <span class="token attr-name">height</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span><span class="token number">180</span><span class="token punctuation">}</span></span> <span class="token attr-name">alt</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>video<span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>p-3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>video<span class="token punctuation">.</span><span class="token property-access">desc</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-2 text-xl<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">章节视频</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid grid-cols-2 gap-4 md:grid-cols-4 md:gap-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">          </span><span class="token punctuation">{</span>data <span class="token operator">&amp;&amp;</span>
</span><span class="code-line">            data<span class="token punctuation">.</span><span class="token function property-access method">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pageData<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">              <span class="token comment">// `data` 是每个页面 API 响应的数组。</span>
</span><span class="code-line">              <span class="token keyword">return</span> pageData<span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">.</span><span class="token function property-access method">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">(</span>
</span><span class="code-line">                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
</span></span><span class="code-line"><span class="token tag">                  <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>flex flex-col justify-center p-2 ring-1 ring-gray-200<span class="token punctuation">&quot;</span></span>
</span></span><span class="code-line"><span class="token tag">                  <span class="token attr-name">key</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">                <span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">                  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Link</span></span> <span class="token attr-name">href</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">/video/chapter/</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>item<span class="token punctuation">.</span>id<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mx-auto<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">                      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Image</span></span>
</span></span><span class="code-line"><span class="token tag">                        <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>aspect-video<span class="token punctuation">&quot;</span></span>
</span></span><span class="code-line"><span class="token tag">                        <span class="token attr-name">src</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span><span class="token property-access">cover</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">                        <span class="token attr-name">width</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span><span class="token number">160</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">                        <span class="token attr-name">height</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span><span class="token number">90</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">                        <span class="token attr-name">alt</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">                      <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">                      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mt-2 h-12 overflow-hidden text-ellipsis<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">                  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Link</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">              <span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>p-3 text-center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token language-javascript script"><span class="token punctuation script-punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">          </span><span class="token punctuation">{</span>isLoadingMore <span class="token operator">?</span> <span class="token string">&#x27;Loading...&#x27;</span> <span class="token operator">:</span> hasNext <span class="token operator">?</span> <span class="token string">&#x27;加载更多&#x27;</span> <span class="token operator">:</span> <span class="token string">&#x27;没有数据了&#x27;</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">  <span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> getServerSideProps<span class="token operator">:</span> <span class="token function function-variable">GetServerSideProps</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator arrow">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> video <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span><span class="token property-access">video</span><span class="token punctuation">.</span><span class="token function property-access method">findUnique</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    include<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      author<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    where<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      id<span class="token operator">:</span> <span class="token class-name known-class-name">Number</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token property-access">params</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="code-line">    props<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      video<span class="token operator">:</span> <span class="token function">makeSerializable</span><span class="token punctuation">(</span>video<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>该页面包含 2 部分内容，视频的基础信息是在服务端渲染的，视频的章节信息通过<code>useSWRInfinite</code>无限加载, 当底部“加更多数据”呈现在页面中的时候自动执行下一页，所以使用到一个 Hooks <code>useOnScreen</code> 用于监听 div 元素有没有在页面上显示。</p><div class="relative"><pre><code class="code-highlight language-ts"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> MutableRefObject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;react&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useOnScreen</span><span class="token class-name generic"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Element<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
</span><span class="code-line">  ref<span class="token operator">:</span> MutableRefObject<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
</span><span class="code-line">  rootMargin<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&#x27;0px&#x27;</span>
</span><span class="code-line"><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// 状态是否可见</span>
</span><span class="code-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>isIntersecting<span class="token punctuation">,</span> setIntersecting<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token class-name generic"><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>
</span><span class="code-line">      <span class="token punctuation">(</span><span class="token punctuation">[</span>entry<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token comment">// observer 回调触发跟新状态</span>
</span><span class="code-line">        <span class="token function">setIntersecting</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>isIntersecting<span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">{</span>
</span><span class="code-line">        rootMargin<span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>ref<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">      ref<span class="token punctuation">.</span>current <span class="token operator">&amp;&amp;</span> observer<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">return</span> isIntersecting
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>IntersectionObserver API，可以自动&quot;观察&quot;元素是否可见，Chrome 51+ 已经支持。由于可见（visible）的本质是，目标元素与视口产生一个交叉区，所以这个 API 叫做&quot;交叉观察器&quot;。</p><p>最终实现效果如下</p><p><img alt="视频章节页" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/453a02ef20cd45468698e2c0e4e719a9~tplv-k3u1fbpfcp-zoom-1.image"/></p><p>最后视频详情页的代码与前面都差不多，这里就不过多赘述了，感兴趣的小伙伴可以直接看 <a target="_blank" rel="noopener noreferrer" href="https://github.com/maqi1520/next-prisma-video-app">GitHub 仓库</a> 中的代码，我相信你已经学会了 prisma + Next.js 全栈开发的主要流程。</p><h2 id="小结"><a href="#小结" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>小结</h2><p>本文通过实现一个视频网站为例，介绍了 prisma 这款 Node.js ORM 框架如何在 Next.js 中使用。</p><p>整体流程是：</p><ol><li>编写 prisma Schema 设计数据库；</li><li>执行 prisma migrate 实现 Schema 到数据库的迁移；</li><li>执行 prisma seed 填充数据库；</li><li>在 Next.js 的 <code>getServerSideProps</code> 中调用 prisma 查询语言，实现服务端渲染；</li></ol><p>prisma 对于 Next.js 来说，可谓是如虎添翼，有了它们，我们前端工程师轻松步入了全栈开发。你学会了吗？若对你有帮助，记得帮我点赞。</p><h2 id="后续"><a href="#后续" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>后续</h2><p>当然我们的视频网站目前还知识一个雏形，用户是手动录入数据库的，还有登录和注册机制，接下来我将继续分享 Next.js 相关的实战文章，欢迎各位关注我的《Next.js 全栈开发实战》 专栏。</p><ul><li>使用 next-auth 来实现 Next.js 应用的鉴权与认证</li><li>使用 React query 给 Next.js 应用全局状态管理</li><li>使用 i18next 实现 Next.js 应用国际化</li><li>使用 Playwright 进行 Next.js 应用的端到端测试</li><li>使用 Github actions 给 Next.js 应用创建 CI/CD</li><li>使用 Docker 部署 Next.js 应用</li><li>将 Next.js 应用部署到腾讯云 serverless</li></ul><p>你对哪块内容比较感兴趣呢？欢迎在评论区留言，感谢您的阅读。</p></div><div class="border-t border-gray-200 pt-6 pb-6 text-sm text-gray-700 dark:border-gray-700 dark:text-gray-300"><div class="mb-3"><img alt="runjs-cool" width="384" height="140" src="/static/images/runjs-cool.webp"/></div><span>关注微信公众号，获取最新原创文章（首发）</span><a target="_blank" rel="noopener noreferrer" href="https://github.com/balac2015/blob/main/data/blog/使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站.md">View on GitHub</a></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">标签</h2><div class="mt-3 flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/%E5%89%8D%E7%AB%AF">前端</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/reactjs">React.js</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">上一篇 文章</h2><div class="mt-3 text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/%E4%BD%BF%E7%94%A8%20Notion%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9B%E8%A1%8C%20Next.js%20%E5%BA%94%E7%94%A8%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91">使用 Notion 数据库进行 Next.js 应用全栈开发</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">下一篇 文章</h2><div class="mt-3 text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/%E4%BD%BF%E7%94%A8%20NextAuth.js%20%E7%BB%99%20Next.js%20%E5%BA%94%E7%94%A8%E6%B7%BB%E5%8A%A0%E9%89%B4%E6%9D%83%E4%B8%8E%E8%AE%A4%E8%AF%81">使用 NextAuth.js 给 Next.js 应用添加鉴权与认证</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← 返回文章列表</a></div></footer></div></div></article></div></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var d=Object.create;var t=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var i=a=\u003et(a,\"__esModule\",{value:!0});var k=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),g=(a,s)=\u003e{for(var c in s)t(a,c,{get:s[c],enumerable:!0})},o=(a,s,c,e)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let l of h(s))!u.call(a,l)\u0026\u0026(c||l!==\"default\")\u0026\u0026t(a,l,{get:()=\u003es[l],enumerable:!(e=m(s,l))||e.enumerable});return a},f=(a,s)=\u003eo(i(t(a!=null?d(N(a)):{},\"default\",!s\u0026\u0026a\u0026\u0026a.__esModule?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a),y=(a=\u003e(s,c)=\u003ea\u0026\u0026a.get(s)||(c=o(i({}),s,1),a\u0026\u0026a.set(s,c),c))(typeof WeakMap!=\"undefined\"?new WeakMap:0);var p=k((j,r)=\u003e{r.exports=_jsx_runtime});var v={};g(v,{default:()=\u003ex,frontmatter:()=\u003eb});var n=f(p()),b={title:\"\\u4F7F\\u7528 Next.js\\u3001 Prisma \\u548C PostgreSQL \\u5168\\u6808\\u5F00\\u53D1\\u89C6\\u9891\\u7F51\\u7AD9\",date:\"2022/10/11 23:57:14\",lastmod:\"2023/1/25 11:42:57\",tags:[\"\\u524D\\u7AEF\",\"React.js\"],draft:!1,summary:\"\\u672C\\u6587\\u5C06\\u4EE5\\u5B9E\\u73B0\\u4E00\\u4E2A\\u89C6\\u9891\\u7F51\\u7AD9\\u4E3A\\u4F8B\\uFF0C\\u4ECB\\u7ECD Next.js \\u548C Prisma \\u5F00\\u53D1\\u7684\\u5168\\u8FC7\\u7A0B\\uFF0Cprisma \\u5BF9\\u4E8E Next.js \\u6765\\u8BF4\\uFF0C\\u53EF\\u8C13\\u662F\\u5982\\u864E\\u6DFB\\u7FFC\\uFF0C\\u6709\\u4E86\\u5B83\\u4EEC\\uFF0C\\u6211\\u4EEC\\u524D\\u7AEF\\u5DE5\\u7A0B\\u5E08\\u8F7B\\u677E\\u6B65\\u5165\\u4E86\\u5168\\u6808\\u5F00\\u53D1\\u3002\",images:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f670f626e68949df8f2a0479c8ac3833~tplv-k3u1fbpfcp-watermark.image?\",authors:[\"default\"],layout:\"PostLayout\"};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({hr:\"hr\",p:\"p\",blockquote:\"blockquote\",h2:\"h2\",a:\"a\",span:\"span\",ul:\"ul\",li:\"li\",pre:\"pre\",code:\"code\",h3:\"h3\",img:\"img\",ol:\"ol\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.hr,{}),(0,n.jsx)(e.p,{children:\"highlight: monokai theme: vuepress\"}),(0,n.jsx)(e.hr,{}),(0,n.jsx)(e.blockquote,{children:(0,n.jsx)(e.p,{children:\"\\u6587\\u7AE0\\u4E3A\\u7A00\\u571F\\u6398\\u91D1\\u6280\\u672F\\u793E\\u533A\\u9996\\u53D1\\u7B7E\\u7EA6\\u6587\\u7AE0\\uFF0C14 \\u5929\\u5185\\u7981\\u6B62\\u8F6C\\u8F7D\\uFF0C14 \\u5929\\u540E\\u672A\\u83B7\\u6388\\u6743\\u7981\\u6B62\\u8F6C\\u8F7D\\uFF0C\\u4FB5\\u6743\\u5FC5\\u7A76\\uFF01\"})}),(0,n.jsxs)(e.h2,{id:\"\\u524D\\u8A00\",children:[(0,n.jsx)(e.a,{href:\"#\\u524D\\u8A00\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u524D\\u8A00\"]}),(0,n.jsx)(e.p,{children:\"\\u5728\\u524D\\u9762\\u7684\\u6587\\u7AE0\\u4E2D\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528\\u4E86 Notion \\u7B14\\u8BB0\\u4F5C\\u4E3A\\u6570\\u636E\\u5E93\\u548C Next.js \\u5F00\\u53D1\\u4E86\\u4E00\\u4E2A\\u9762\\u8BD5\\u5237\\u9898\\u7F51\\u7AD9\\uFF0C\\u4E5F\\u7ED3\\u5408\\u4E86 Strapi \\u8FD9\\u6B3E\\u65E0\\u5934 CMS \\u7CFB\\u7EDF\\u5F00\\u53D1\\u4E86\\u4E00\\u4E2A\\u5FAE\\u535A\\u5E94\\u7528\\uFF0CStrapi \\u9ED8\\u8BA4\\u4F7F\\u7528\\u7684 SQLite\\uFF0CSQLite \\u662F\\u4E00\\u4E2A\\u57FA\\u4E8E\\u6587\\u4EF6\\u7684\\u5D4C\\u5165\\u5F0F\\u5173\\u7CFB\\u6570\\u636E\\u5E93\\u7CFB\\u7EDF\\uFF0C\\u4F18\\u70B9\\u662F\\u7CBE\\u5DE7\\u3001\\u5355\\u673A\\u90E8\\u7F72\\u4EE5\\u53CA\\u65B9\\u4FBF\\u7684\\u53EF\\u79FB\\u690D\\u6027\\uFF0C\\u4F46\\u7F3A\\u70B9\\u4E5F\\u662F\\u56E0\\u4E3A\\u6587\\u4EF6\\u7CFB\\u7EDF\\u672C\\u8EAB\\u7684\\u9650\\u5236\\uFF0C\\u53EF\\u80FD\\u4F1A\\u5728\\u8F83\\u5927\\u6570\\u636E\\u96C6\\u7684\\u60C5\\u51B5\\u4E0B\\u5BFC\\u81F4\\u6027\\u80FD\\u95EE\\u9898\\u3002\\u4ECA\\u5929\\u6211\\u4EEC\\u6765\\u4F7F\\u7528\\u53E6\\u4E00\\u6B3E\\u5173\\u7CFB\\u578B\\u6570\\u636E\\u5E93 PostgreSQL\\uFF0C\\u53EF\\u4EE5\\u8F7B\\u677E\\u5E94\\u5BF9\\u5927\\u6570\\u636E\\u96C6\\u7684\\u573A\\u666F\\uFF0C\\u5E76\\u4E14\\u76F4\\u63A5\\u652F\\u6301 JSON \\u6570\\u636E\\u7C7B\\u578B\\u5B58\\u50A8\\uFF0C\\u4E5F\\u662F\\u4F01\\u4E1A\\u5E94\\u7528\\u7A0B\\u5E8F\\u4E2D\\u6700\\u53D7\\u6B22\\u8FCE\\u7684\\u6570\\u636E\\u5E93\\u4E4B\\u4E00\\uFF0C\\u7136\\u540E\\u914D\\u5408\\u5F53\\u4E0B\\u975E\\u5E38\\u6D41\\u884C\\u7684 Nodejs ORM \\u6846\\u67B6 Prisma \\uFF0C\\u8BA9 Next.js \\u5168\\u6808\\u5F00\\u53D1\\u53D8\\u5F97\\u66F4\\u52A0\\u7B80\\u5355\\uFF01\"}),(0,n.jsx)(e.p,{children:\"\\u672C\\u6587\\u5C06\\u4EE5\\u5B9E\\u73B0\\u4E00\\u4E2A\\u89C6\\u9891\\u7F51\\u7AD9\\u4E3A\\u4F8B\\uFF0C\\u4ECB\\u7ECD Next.js \\u548C Prisma \\u5F00\\u53D1\\u7684\\u5168\\u8FC7\\u7A0B\\u3002\"}),(0,n.jsxs)(e.h2,{id:\"\\u9605\\u8BFB\\u672C\\u6587\\u4F60\\u5C06\\u6536\\u83B7\",children:[(0,n.jsx)(e.a,{href:\"#\\u9605\\u8BFB\\u672C\\u6587\\u4F60\\u5C06\\u6536\\u83B7\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u9605\\u8BFB\\u672C\\u6587\\uFF0C\\u4F60\\u5C06\\u6536\\u83B7\\uFF1A\"]}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"\\u5982\\u4F55\\u4F7F\\u7528 Docker \\u542F\\u4E00\\u4E2A\\u6570\\u636E\\u5E93\\u670D\\u52A1\"}),(0,n.jsx)(e.li,{children:\"\\u5982\\u4F55\\u4F7F\\u7528 Prisma Schema \\u7BA1\\u7406\\u6570\\u636E\\u8868\"}),(0,n.jsx)(e.li,{children:\"\\u5982\\u4F55\\u5728 Next.js \\u4E2D\\u8C03\\u7528 Prisma \\u67E5\\u8BE2\\u8BED\\u53E5\"})]}),(0,n.jsxs)(e.p,{children:[\"\\u6587\\u4E2D\\u6D89\\u53CA\\u4EE3\\u7801\\u5168\\u90E8\\u6258\\u7BA1\\u5728 \",(0,n.jsx)(e.a,{href:\"https://github.com/maqi1520/next-prisma-video-app\",title:\"GitHub \\u4ED3\\u5E93\\u4EE3\\u7801\",children:\"GitHub \\u4ED3\\u5E93\"}),\"\\u4E2D\\u3002\"]}),(0,n.jsxs)(e.h2,{id:\"\\u521D\\u59CB\\u5316\\u9879\\u76EE\",children:[(0,n.jsx)(e.a,{href:\"#\\u521D\\u59CB\\u5316\\u9879\\u76EE\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u521D\\u59CB\\u5316\\u9879\\u76EE\"]}),(0,n.jsx)(e.p,{children:\"\\u9996\\u5148\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528 create-next-app \\u521B\\u5EFA\\u4E00\\u4E2A Next.js Typescript \\u5DE5\\u7A0B\\uFF0C\\u5E76\\u4E14\\u5B89\\u88C5\\u548C\\u521D\\u59CB\\u5316 Tailwindcss\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"yarn\"}),` create next-prisma-video-app --typescript\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token class-name builtin\",children:\"cd\"}),` next-prisma-video-app\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"yarn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),` tailwindcss postcss autoprefixer --dev\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`npx tailwindcss init -p\n`})]})}),(0,n.jsxs)(e.p,{children:[\"\\u4FEE\\u6539 \",(0,n.jsx)(e.code,{children:\"globals.css\"}),\" \\u4E3A \",(0,n.jsx)(e.code,{children:\"tailwindcss\"}),\" \\u9ED8\\u8BA4\\u6307\\u4EE4\"]}),(0,n.jsx)(e.pre,{className:\"language-css\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-css\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token atrule\",children:[(0,n.jsx)(e.span,{className:\"token rule\",children:\"@tailwind\"}),\" base\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token atrule\",children:[(0,n.jsx)(e.span,{className:\"token rule\",children:\"@tailwind\"}),\" components\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token atrule\",children:[(0,n.jsx)(e.span,{className:\"token rule\",children:\"@tailwind\"}),\" utilities\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"})]}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u8FD0\\u884C \",(0,n.jsx)(e.code,{children:\"yarn dev\"}),\" \\u8FDB\\u5165\\u5F00\\u53D1\\u6A21\\u5F0F\\uFF0C\\u4FEE\\u6539\\u9875\\u9762\\u6D4F\\u89C8\\u5668\\u4F1A\\u81EA\\u52A8\\u70ED\\u66F4\\u65B0\\uFF0C\\u81F3\\u6B64\\u6211\\u4EEC\\u7684\\u524D\\u7AEF\\u5DE5\\u7A0B\\u521D\\u59CB\\u5316\\u5B8C\\u6210\\u3002\"]}),(0,n.jsxs)(e.h2,{id:\"\\u5F00\\u53D1\\u73AF\\u5883\",children:[(0,n.jsx)(e.a,{href:\"#\\u5F00\\u53D1\\u73AF\\u5883\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u5F00\\u53D1\\u73AF\\u5883\"]}),(0,n.jsx)(e.p,{children:\"\\u63A5\\u4E0B\\u6765\\uFF0C\\u5148\\u6765\\u8BF4\\u660E\\u4E0B\\u672C\\u9879\\u76EE\\u6D89\\u53CA\\u5230\\u7684\\u5F00\\u53D1\\u73AF\\u5883\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"\\u5B89\\u88C5 Docker \\u6216 PostgreSQL\\u3002\"}),(0,n.jsx)(e.li,{children:\"VSCode \\u5B89\\u88C5\\u4E86 Prisma \\u6269\\u5C55\\u3002\"})]}),(0,n.jsxs)(e.h3,{id:\"\\u5B89\\u88C5-docker\",children:[(0,n.jsx)(e.a,{href:\"#\\u5B89\\u88C5-docker\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u5B89\\u88C5 Docker\"]}),(0,n.jsx)(e.blockquote,{children:(0,n.jsx)(e.p,{children:\"\\u63D0\\u793A\\uFF1A\\u5982\\u679C\\u60A8\\u4E0D\\u60F3\\u4F7F\\u7528 Docker\\uFF0C\\u53EF\\u4EE5\\u5728\\u672C\\u5730\\u5B89\\u88C5 PostgreSQL \\u5B9E\\u4F8B\\u6216\\u8005\\u4F7F\\u7528\\u4E91\\u670D\\u52A1\\u5546\\u63D0\\u4F9B\\u7684 PostgreSQL \\u6570\\u636E\\u5E93\\u3002\"})}),(0,n.jsx)(e.p,{children:\"\\u524D\\u7AEF\\u540C\\u5B66\\uFF0C\\u4E00\\u822C\\u4E0D\\u4F1A\\u5728\\u81EA\\u5DF1\\u7684\\u7535\\u8111\\u4E0A\\u6570\\u636E\\u5E93\\uFF0C\\u4E0D\\u540C\\u73AF\\u5883\\u4E0B\\u5B89\\u88C5\\u6570\\u636E\\u5E93\\u53EF\\u80FD\\u4F1A\\u662F\\u4E00\\u4E2A\\u9EBB\\u70E6\\u7684\\u8FC7\\u7A0B\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u5148\\u5B89\\u88C5 Docker\\uFF0C\\u901A\\u8FC7 Docker \\u5B89\\u88C5\\u4E00\\u4E2A\\u6570\\u636E\\u5E93\\u4F1A\\u53D8\\u7684\\u975E\\u5E38\\u7B80\\u5355\\u3002\"}),(0,n.jsxs)(e.p,{children:[\"\\u6CA1\\u6709 Docker \\u7684\\u540C\\u5B66\\u5148\\u901A\\u8FC7 \",(0,n.jsx)(e.a,{href:\"https://www.docker.com/\",title:\"docker \\u5B98\\u7F51\",children:\"docker \\u5B98\\u7F51\"}),\"\\u5B89\\u88C5 Docker\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u9ED8\\u8BA4\\u60C5\\u51B5\\u4E0B\\uFF0Cwindows \\u548C mac \\u4E0B\\u7684 Docker \\u5DF2\\u7ECF\\u81EA\\u5E26\\u4E86\",(0,n.jsx)(e.code,{children:\"docker-compose\"}),\" \\u5DE5\\u5177\\uFF0C\\u53EF\\u4EE5\\u4F7F\\u7528 \",(0,n.jsx)(e.code,{children:\"docker-compose -v\"}),\" \\u547D\\u4EE4\\u67E5\\u770B\\u3002\"]}),(0,n.jsxs)(e.h3,{id:\"\\u521B\\u5EFA-postgresql-\\u5B9E\\u4F8B\",children:[(0,n.jsx)(e.a,{href:\"#\\u521B\\u5EFA-postgresql-\\u5B9E\\u4F8B\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u521B\\u5EFA PostgreSQL \\u5B9E\\u4F8B\"]}),(0,n.jsx)(e.p,{children:\"\\u4E0B\\u9762\\u6211\\u4EEC\\u5C06\\u901A\\u8FC7 Docker \\u5BB9\\u5668\\u5728\\u60A8\\u7684\\u673A\\u5668\\u4E0A\\u5B89\\u88C5\\u548C\\u8FD0\\u884C PostgreSQL\\u3002\"}),(0,n.jsxs)(e.p,{children:[\"\\u9996\\u5148\\uFF0C\\u5728\\u9879\\u76EE\\u7684\\u6839\\u6587\\u4EF6\\u5939\\u4E2D\\u521B\\u5EFA\\u4E00\\u4E2A\",(0,n.jsx)(e.code,{children:\"docker-compose.yml\"}),\"\\u6587\\u4EF6\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"touch\"}),` docker-compose.yml\n`]})})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"docker-compose.yml\"}),\" \\u6587\\u4EF6\\u662F\\u4E00\\u4E2A docker \\u5BB9\\u5668\\u7684\\u89C4\\u8303\\u914D\\u7F6E\\u6587\\u4EF6\\uFF0C\\u5305\\u542B\\u4E86 PostgreSQL \\u521D\\u59CB\\u5316\\u8BBE\\u7F6E\\u3002\\u5728\\u6587\\u4EF6\\u4E2D\\u8F93\\u5165\\u4EE5\\u4E0B\\u914D\\u7F6E\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-yml\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-yml\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"# docker-compose.yml\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"version\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'3.1'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"services\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"db\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"image\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` postgres\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"volumes\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" ./postgres\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`/var/lib/postgresql/data\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"restart\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` always\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"ports\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" 5432\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5432\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"environment\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` POSTGRES_USER=myuser\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),` POSTGRES_PASSWORD=mypassword\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"adminer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"image\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` adminer\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"restart\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` always\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token atrule key\",children:\"ports\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"-\"}),\" 8080\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"8080\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"\\u4E0A\\u9762 yml \\u6587\\u4EF6\\u4E2D\\uFF0C\\u6211\\u4EEC\\u521D\\u59CB\\u5316\\u4E86 2 \\u4E2A\\u670D\\u52A1\\uFF1A\"}),(0,n.jsxs)(e.p,{children:[\"\\u4E00\\u4E2A\\u662F \",(0,n.jsx)(e.code,{children:\"postgres\"}),\" \\u5BF9\\u5E94 5432 \\u7AEF\\u53E3\\uFF0Cvolumes \\u5377\\u4EE3\\u8868\\u6587\\u4EF6\\u6620\\u5C04\\uFF0C\\u5C06\\u5BB9\\u5668\\u4E2D\\u7684\\u6570\\u636E\\u5E93\\u6620\\u5C04\\u5230\\u5F53\\u524D\\u4E3B\\u673A\\uFF0C\\u907F\\u514D\\u5BB9\\u5668\\u670D\\u52A1\\u9500\\u6BC1\\u7684\\u65F6\\u5019\\u6570\\u636E\\u5E93\\u4E22\\u5931\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u53E6\\u4E00\\u4E2A \",(0,n.jsx)(e.code,{children:\"adminer\"}),\" \\u662F\\u4E00\\u4E2A\\u8F7B\\u91CF\\u7684\\u6570\\u636E\\u5E93\\u7BA1\\u7406\\u5BA2\\u6237\\u7AEF\\uFF0C\\u652F\\u6301\\u591A\\u79CD\\u5173\\u7CFB\\u578B\\u6570\\u636E\\u5E93\\uFF0C\\u542F\\u52A8\\u5728 8080 \\u7AEF\\u53E3\\u3002\"]}),(0,n.jsx)(e.p,{children:\"\\u5728\\u542F\\u52A8\\u4E4B\\u524D\\u8BF7\\u786E\\u4FDD 5432 \\u7AEF\\u53E3\\u548C 8080 \\u7AEF\\u4E0D\\u88AB\\u5360\\u7528\\uFF0C\\u5728\\u547D\\u4EE4\\u884C\\u4E2D\\u8F93\\u5165\\u4EE5\\u4E0B\\u547D\\u4EE4\\u542F\\u52A8\\u670D\\u52A1\\uFF1A\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"docker-compose\"}),` up -d\n`]})})}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"-d\"}),\"\\u53C2\\u6570\\u53EF\\u4EE5\\u786E\\u4FDD\\u4F60\\u5173\\u95ED\\u547D\\u4EE4\\u884C\\u7A97\\u53E3\\uFF0Cdocker \\u670D\\u52A1\\u4E0D\\u88AB\\u505C\\u6B62\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u6B64\\u65F6\\u8BBF\\u95EE \",(0,n.jsx)(e.code,{children:\"http://localhost:8080/\"}),\" \\u4FBF\\u53EF\\u4EE5\\u4F7F\\u7528\\u53EF\\u89C6\\u5316\\u9875\\u9762\\u8BBF\\u95EE postgres \\u6570\\u636E\\u5E93\\u4E86\\u3002\"]}),(0,n.jsx)(e.p,{children:\"\\u8F93\\u5165\\u4F60\\u8BBE\\u7F6E\\u7684\\u7528\\u6237\\u540D\\u548C\\u5BC6\\u7801\\u4FBF\\u53EF\\u4EE5\\u770B\\u5230\\u4EE5\\u4E0B\\u754C\\u9762\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"Adminer PostgreSQL \\u7BA1\\u7406\\u754C\\u9762\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/34ab754a8c594147ab5b45e633c497ad~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsx)(e.p,{children:\"\\u5F53\\u7136\\u4F60\\u82E5\\u4E0D\\u60F3\\u4F7F\\u7528\\u6570\\u636E\\u7684\\u65F6\\u5019\\uFF0C\\u4E5F\\u53EF\\u4EE5\\u4F7F\\u7528\\u4EE5\\u4E0B\\u547D\\u4EE4\\u505C\\u6B62 docker \\u670D\\u52A1\\u3002\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"docker-compose\"}),` down\n`]})})}),(0,n.jsx)(e.p,{children:\"\\u505C\\u6B62\\u540E\\uFF0C\\u6570\\u636E\\u5E93\\u6570\\u636E\\u4E0D\\u4F1A\\u4E22\\u5931\\uFF0C\\u56E0\\u4E3A\\u5B83\\u5B58\\u5728\\u540C\\u76EE\\u5F55\\u4E0B\\u7684 postgres \\u76EE\\u5F55\\u4E2D\\uFF0C\\u4E0B\\u6B21\\u542F\\u52A8\\u4FBF\\u53EF\\u4EE5\\u6062\\u590D\\u6570\\u636E\\u3002\"}),(0,n.jsxs)(e.h2,{id:\"\\u9700\\u6C42\\u5206\\u6790\",children:[(0,n.jsx)(e.a,{href:\"#\\u9700\\u6C42\\u5206\\u6790\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u9700\\u6C42\\u5206\\u6790\"]}),(0,n.jsx)(e.p,{children:\"\\u7B80\\u5355\\u6982\\u62EC\\u4E0B\\u9700\\u6C42\\uFF0C\\u6211\\u4EEC\\u8981\\u5B9E\\u73B0\\u7684\\u89C6\\u9891\\u7F51\\u7AD9\\u6709\\u7684\\u7C7B\\u4F3C B \\u7AD9\\u6216\\u8005\\u8BF4\\u662F\\u6155\\u8BFE\\u7F51\\u3002\"}),(0,n.jsxs)(e.ol,{children:[(0,n.jsx)(e.li,{children:\"\\u81F3\\u5C11 1 \\u4E2A\\u5217\\u8868\\u9875\\u548C\\u4E00\\u4E2A\\u89C6\\u9891\\u8BE6\\u60C5\\u9875\\u9762\"}),(0,n.jsx)(e.li,{children:\"\\u6BCF\\u4E2A\\u89C6\\u9891\\u5FC5\\u987B\\u6709\\u4E00\\u4E2A\\u5206\\u7C7B\"}),(0,n.jsx)(e.li,{children:\"\\u6BCF\\u4E2A\\u89C6\\u9891\\u5FC5\\u987B\\u6709\\u4E00\\u4E2A\\u4F5C\\u8005\"}),(0,n.jsx)(e.li,{children:\"\\u6BCF\\u4E2A\\u89C6\\u9891\\u53EF\\u4EE5\\u5206\\u4E3A\\u591A\\u4E2A\\u7AE0\\u8282\"})]}),(0,n.jsxs)(e.h2,{id:\"\\u6570\\u636E\\u5B9E\\u4F53\\u5173\\u7CFB\\u56FE\",children:[(0,n.jsx)(e.a,{href:\"#\\u6570\\u636E\\u5B9E\\u4F53\\u5173\\u7CFB\\u56FE\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u6570\\u636E\\u5B9E\\u4F53\\u5173\\u7CFB\\u56FE\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\\u6570\\u636E\\u5B9E\\u4F53\\u5173\\u7CFB\\u56FE\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58c9e5f1fa964102a56c2f925a88ac39~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsxs)(e.ol,{children:[(0,n.jsx)(e.li,{children:\"\\u4E00\\u4E2A\\u4F5C\\u8005\\u53EF\\u4EE5\\u521B\\u5EFA\\u591A\\u4E2A\\u89C6\\u9891\\uFF1A\\u4E00\\u5BF9\\u591A\"}),(0,n.jsx)(e.li,{children:\"\\u4E00\\u4E2A\\u5206\\u7C7B\\u4E0B\\u53EF\\u4EE5\\u6709\\u591A\\u4E2A\\u89C6\\u9891\\uFF0C\\u4F46\\u4E00\\u4E2A\\u89C6\\u9891\\u53EA\\u80FD\\u5C5E\\u4E8E\\u4E00\\u4E2A\\u5206\\u7C7B\\uFF1A \\u4E00\\u4E2A\\u4F5C\\u8005\\u53EF\\u4EE5\\u521B\\u5EFA\\u591A\\u4E2A\\u89C6\\u9891\\uFF1A\\u4E00\\u5BF9\\u591A\"}),(0,n.jsx)(e.li,{children:\"\\u4E00\\u4E2A\\u89C6\\u9891\\u53EF\\u4EE5\\u6709\\u591A\\u4E2A\\u7AE0\\u8282\\uFF1A\\u4E00\\u5BF9\\u591A\"})]}),(0,n.jsx)(e.p,{children:\"\\u73B0\\u5728\\u6570\\u636E\\u5E93\\u548C\\u524D\\u7AEF\\u9879\\u76EE\\u5DF2\\u7ECF\\u51C6\\u5907\\u597D\\u4E86\\uFF0C\\u662F\\u65F6\\u5019\\u8BBE\\u7F6E Prisma \\u4E86\\uFF01\"}),(0,n.jsxs)(e.h2,{id:\"\\u521D\\u59CB\\u5316-prisma\",children:[(0,n.jsx)(e.a,{href:\"#\\u521D\\u59CB\\u5316-prisma\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u521D\\u59CB\\u5316 Prisma\"]}),(0,n.jsx)(e.p,{children:\"\\u9996\\u5148\\uFF0C\\u9996\\u5148\\u5B89\\u88C5 Prisma CLI \\u4F5C\\u4E3A\\u5F00\\u53D1\\u4F9D\\u8D56\\u9879\\u3002\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"yarn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),` -D prisma\n`]})})}),(0,n.jsx)(e.p,{children:\"\\u4F60\\u53EF\\u4EE5\\u901A\\u8FC7\\u8FD0\\u884C\\u4EE5\\u4E0B\\u547D\\u4EE4\\u5728\\u9879\\u76EE\\u4E2D\\u521D\\u59CB\\u5316 Prisma\\uFF1A\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`npx prisma init\n`})})}),(0,n.jsxs)(e.p,{children:[\"\\u8FD9\\u4E00\\u6B65\\u521B\\u5EFA\\u4E86\\u4E00\\u4E2A prisma \\u76EE\\u5F55\\u5305\\u542B\\u4E86 \",(0,n.jsx)(e.code,{children:\"schema.prisma\"}),\" \\u6587\\u4EF6\\uFF0C\\u8BE5\\u6587\\u4EF6\\u662F\\u6570\\u636E\\u5E93\\u6A21\\u578B\\u7684\\u4E3B\\u8981\\u914D\\u7F6E\\u6587\\u4EF6\\u3002\\u6B64\\u547D\\u4EE4\\u8FD8\\u4F1A\\u5728\\u9879\\u76EE\\u4E2D\\u521B\\u5EFA\\u4E00\\u4E2A\",(0,n.jsx)(e.code,{children:\".env\"}),\" \\u6587\\u4EF6\\u3002\"]}),(0,n.jsxs)(e.h3,{id:\"\\u8BBE\\u7F6E\\u73AF\\u5883\\u53D8\\u91CF\",children:[(0,n.jsx)(e.a,{href:\"#\\u8BBE\\u7F6E\\u73AF\\u5883\\u53D8\\u91CF\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u8BBE\\u7F6E\\u73AF\\u5883\\u53D8\\u91CF\"]}),(0,n.jsxs)(e.p,{children:[\"\\u5728\",(0,n.jsx)(e.code,{children:\".env\"}),\"\\u6587\\u4EF6\\u4E2D\\uFF0C\\u4F60\\u4F1A\\u770B\\u5230\\u4E00\\u4E2A\",(0,n.jsx)(e.code,{children:\"DATABASE_URL\"}),\"\\u73AF\\u5883\\u53D8\\u91CF\\uFF0C\\u5C06\\u6B64\\u5B57\\u7B26\\u4E32\\u4E2D\\u7684\\u6570\\u636E\\u5E93\\u8FDE\\u63A5\\u4FE1\\u606F\\u66FF\\u6362\\u4E3A\\u4F60\\u521A\\u624D\\u521B\\u5EFA\\u7684 PostgreSQL \\u5B9E\\u4F8B\\u4FE1\\u606F\\u3002\"]}),(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`// .env\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`DATABASE_URL=\"postgres://myuser:mypassword@localhost:5432/median-db\"\n`})]})}),(0,n.jsxs)(e.h3,{id:\"\\u4E86\\u89E3-prisma-schema\",children:[(0,n.jsx)(e.a,{href:\"#\\u4E86\\u89E3-prisma-schema\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u4E86\\u89E3 Prisma schema\"]}),(0,n.jsxs)(e.p,{children:[\"Prisma Schema \\u53EF\\u4EE5\\u8BA9\\u6211\\u4EEC\\u66F4\\u52A0\\u76F4\\u89C2\\u7684\\u7BA1\\u7406\\u6570\\u636E\\u8868\\uFF0C\\u5F53\\u6211\\u4EEC\\u7684\\u6570\\u636E\\u8868\\u6709\\u6539\\u52A8\\u65F6\\uFF0C\\u53EF\\u4EE5\\u6839\\u636E Schema \\u81EA\\u52A8\\u751F\\u6210 SQl\\uFF0C\\u544A\\u522B\\u7F16\\u5199 SQl \\u8FC1\\u79FB\\u7684\\u70E6\\u607C\\uFF0C\",(0,n.jsx)(e.a,{href:\"https://www.prisma.io/migrate\",title:\"prisma \\u5B98\\u7F51\",children:\"prisma \\u5B98\\u7F51\"}),\"\\u4E5F\\u76F4\\u89C2\\u5730\\u5C55\\u793A\\u4E86 Schem \\u4E0E Sql \\u7684\\u5173\\u7CFB\\u3002\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"prisma \\u5B98\\u7F51\\u6F14\\u793A\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/798b63422b6449a882c9a16d16bfa8ff~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsxs)(e.p,{children:[\"\\u6253\\u5F00\",(0,n.jsx)(e.code,{children:\"prisma/schema.prisma\"}),\"\\uFF0C\\u4F60\\u4F1A\\u770B\\u5230\\u4EE5\\u4E0B\\u9ED8\\u8BA4\\u4EE3\\u7801\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-js\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// prisma/schema.prisma\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"generator client \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  provider \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"prisma-client-js\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"datasource db \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  provider \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"postgresql\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  url      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"env\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"DATABASE_URL\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u8BE5\\u6587\\u4EF6\\u662F\\u7528 \",(0,n.jsx)(e.code,{children:\"Prisma Schema Language\"}),\"\\u7F16\\u5199\\u7684\\uFF0C\\u8FD9\\u662F Prisma \\u7528\\u6765\\u5B9A\\u4E49\\u6570\\u636E\\u5E93\\u6A21\\u5F0F\\u7684\\u8BED\\u8A00\\u3002\\u8BE5\\u6587\\u4EF6\\u5305\\u542B\\u4E09\\u4E2A\\u4E3B\\u8981\\u7EC4\\u6210\\u90E8\\u5206\\uFF1A\"]}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"datasource\\uFF1A\\u5B9A\\u4E49\\u6570\\u636E\\u5E93\\u7C7B\\u578B\\u548C\\u94FE\\u63A5\\u5730\\u5740\"}),(0,n.jsx)(e.li,{children:\"generator\\uFF1A\\u6307\\u5B9A\\u54EA\\u4E2A\\u5BA2\\u6237\\u7AEF\\u5411\\u6570\\u636E\\u53D1\\u9001\\u67E5\\u8BE2\\u8BED\\u8A00\"}),(0,n.jsx)(e.li,{children:\"model\\uFF1A\\u5B9A\\u4E49\\u6570\\u636E\\u5E93 Schema\\u3002\\u6BCF\\u4E2A Model \\u90FD\\u5C06\\u6620\\u5C04\\u5230\\u6570\\u636E\\u5E93\\u5E95\\u5C42\\u4E2D\\u7684\\u4E00\\u4E2A\\u8868\\u4E2D\\u3002\\u76EE\\u524D\\uFF0C\\u6211\\u4EEC\\u8FD8\\u6CA1\\u6709 model\\uFF0C\\u63A5\\u4E0B\\u6765\\u6211\\u4EEC\\u6765\\u5B9A\\u4E49\\u4E0B model\\u3002\"})]}),(0,n.jsxs)(e.h2,{id:\"\\u5BF9\\u6570\\u636E\\u5EFA\\u6A21\",children:[(0,n.jsx)(e.a,{href:\"#\\u5BF9\\u6570\\u636E\\u5EFA\\u6A21\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u5BF9\\u6570\\u636E\\u5EFA\\u6A21\"]}),(0,n.jsxs)(e.p,{children:[\"\\u5DE5\\u6B32\\u5584\\u5176\\u4E8B\\u5FC5\\u5148\\u5229\\u5176\\u5668\\uFF0C\\u5728 VSCode \\u4E2D\\u5B89\\u88C5\\u4E86 \",(0,n.jsx)(e.a,{href:\"https://marketplace.visualstudio.com/items?itemName=Prisma.prisma\",title:\"Prisma \\u6269\\u5C55\",children:\"Prisma \\u6269\\u5C55\"}),\"\\uFF0C\\u53EF\\u4EE5\\u8BA9 VSCode \\u5BF9 Prisma Schema \\u6709\\u8BED\\u6CD5\\u9AD8\\u4EAE\\u548C\\u8F93\\u5165\\u63D0\\u793A\\u3002\"]}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-js\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"model \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Video\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  id         \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Int\"}),\"       @id @\",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"default\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"autoincrement\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  title      \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"String\"}),`    @unique\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  desc       \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"?\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  pic        \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"String\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  authorId   \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Int\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  author     \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"User\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"?\"}),\"     @\",(0,n.jsx)(e.span,{className:\"token function\",children:\"relation\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"fields\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"authorId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token property literal-property\",children:\"references\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  categoryId \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Int\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  category   \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Category\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"?\"}),\" @\",(0,n.jsx)(e.span,{className:\"token function\",children:\"relation\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"fields\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"categoryId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token property literal-property\",children:\"references\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  level      \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Int\"}),\"       @\",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"default\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  createdAt  \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"DateTime\"}),\"  @\",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"default\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"now\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  updatedAt  \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"DateTime\"}),`  @updatedAt\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  chapter    \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Chapter\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"model \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Category\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  id    \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Int\"}),\"     @id @\",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"default\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"autoincrement\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  name  \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"String\"}),`  @unique\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  video \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Video\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"model \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Chapter\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  id      \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Int\"}),\"    @id @\",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"default\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"autoincrement\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  title   \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"String\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  url     \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"String\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  videoId \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Int\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  video   \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Video\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"?\"}),\" @\",(0,n.jsx)(e.span,{className:\"token function\",children:\"relation\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"fields\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"videoId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token property literal-property\",children:\"references\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"model \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"User\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  id     \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Int\"}),\"     @id @\",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"default\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"autoincrement\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  avatar \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"String\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  name   \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"String\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  video  \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Video\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u8FD9\\u91CC\\u521B\\u5EFA\\u4E86 4 \\u4E2A Model\\uFF0C\",(0,n.jsx)(e.code,{children:\"Video\"}),\"\\u3001\",(0,n.jsx)(e.code,{children:\"Category\"}),\"\\u3001\",(0,n.jsx)(e.code,{children:\"Chapter\"}),\"\\u3001\",(0,n.jsx)(e.code,{children:\"User\"}),\" \\u5206\\u522B\\u5BF9\\u5E94\\u6570\\u636E\\u5E93\\u4E2D\\u7684\\u8868\\u3002\\u6BCF\\u4E2A Model \\u4E2D\\u7684\\u4E00\\u884C\\u4EE3\\u8868\\u4E00\\u4E2A\\u5B57\\u6BB5\\uFF0C\\u7B2C\\u4E00\\u4E2A\\u662F\\u540D\\u79F0\\uFF08\\u5982\\uFF1A\",(0,n.jsx)(e.code,{children:\"id\"}),\"\\u3001\",(0,n.jsx)(e.code,{children:\"title\"}),\"\\uFF09\\u3001\\u7B2C\\u4E8C\\u4E2A\\u662F\\u7C7B\\u578B\\uFF08\\u5982\\uFF1A\",(0,n.jsx)(e.code,{children:\"Int\"}),\"\\u3001\",(0,n.jsx)(e.code,{children:\"String\"}),\"\\uFF09\\u548C\\u5176\\u4ED6\\u53EF\\u9009\\u5C5E\\u6027\\uFF08\\u5982\\uFF1A\",(0,n.jsx)(e.code,{children:\"@id\"}),\"\\u3001\",(0,n.jsx)(e.code,{children:\"@unique\"}),\"\\uFF09\\u3002\\u5728\\u5B57\\u6BB5\\u7C7B\\u578B\\u540E\\u9762\\u6DFB\\u52A0\\u4E00\\u4E2A\",(0,n.jsx)(e.code,{children:\"?\"}),\"\\u6765\\u4F7F\\u5B57\\u6BB5\\u6210\\u4E3A\\u53EF\\u9009\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u5C5E\\u6027\",(0,n.jsx)(e.code,{children:\"@id\"}),\"\\u8868\\u793A\\u8BE5\\u5B57\\u6BB5\\u662F\\u6A21\\u578B\\u7684\\u4E3B\\u952E\\u3002\",(0,n.jsx)(e.code,{children:\"@default(autoincrement())\"}),\"\\u5C5E\\u6027\\u8868\\u793A\\u8BE5\\u5B57\\u6BB5\\u5E94\\u81EA\\u52A8\\u9012\\u589E\"]}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"@relation\"}),\" \\u8868\\u793A\\u7ED9\\u8868\\u521B\\u5EFA\\u5173\\u8054\\uFF0C\\u6BD4\\u5982 \",(0,n.jsx)(e.code,{children:\"video Video? @relation(fields: [videoId], references: [id])\"}),\"\\u8868\\u793A\\u4F7F\\u7528\",(0,n.jsx)(e.code,{children:\"videoId\"}),\" \\u4E3A\\u9644\\u952E\\uFF0C\\u5173\\u8054 \",(0,n.jsx)(e.code,{children:\"Video\"}),\" \\u8868\\u4E2D\\u7684\\u4E3B\\u952E \",(0,n.jsx)(e.code,{children:\"id\"}),\",\"]}),(0,n.jsxs)(e.p,{children:['\\u5F53\\u6211\\u4EEC\\u4FDD\\u5B58\\u65F6\\uFF0Cvscode \\u4F1A\\u81EA\\u52A8\\u7ED9\"\\u88AB\\u5173\\u8054\\u7684\\u8868\"\\u6DFB\\u52A0\\u5B57\\u6BB5',(0,n.jsx)(e.code,{children:\"video Video[]\"}),\" \\uFF0C\\u5E76\\u4E14\\u81EA\\u52A8\\u683C\\u5F0F\\u5316\\uFF0C\\u8BA9\\u8868\\u4E4B\\u95F4\\u7684\\u5173\\u7CFB\\u4E00\\u76EE\\u4E86\\u7136\\u3002\"]}),(0,n.jsxs)(e.h2,{id:\"\\u8FC1\\u79FB\\u6570\\u636E\\u5E93\",children:[(0,n.jsx)(e.a,{href:\"#\\u8FC1\\u79FB\\u6570\\u636E\\u5E93\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u8FC1\\u79FB\\u6570\\u636E\\u5E93\"]}),(0,n.jsx)(e.p,{children:\"\\u5B9A\\u4E49 Prisma Schema \\u540E\\uFF0C\\u6570\\u636E\\u5E93\\u4E2D\\u8FD8\\u6CA1\\u6709\\u771F\\u6B63\\u7684\\u8868\\uFF0C\\u6240\\u4EE5\\u6211\\u4EEC\\u8981\\u6267\\u884C\\u4E00\\u6B21 migrate(\\u8FC1\\u79FB)\\uFF0C\\u7B2C\\u4E00\\u6B21\\u8FC1\\u79FB\\uFF0C\\u8BF7\\u5728\\u7EC8\\u7AEF\\u4E2D\\u8FD0\\u884C\\u4EE5\\u4E0B\\u547D\\u4EE4\\uFF1A\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"code-highlight\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`npx prisma migrate dev --name \"init\"\n`})})}),(0,n.jsx)(e.p,{children:\"\\u8FD9\\u4E2A\\u547D\\u4EE4\\u4F1A\\u505A\\u4E09\\u4EF6\\u4E8B\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[\"\\u4FDD\\u5B58\\u8FC1\\u79FB SQL\\uFF1APrisma Migrate \\u5C06\\u6839\\u636E Schema \\u81EA\\u52A8\\u751F\\u6210\\u6240\\u9700\\u7684 SQL \\u8BED\\u53E5\\uFF0C\\u5E76\\u4E14\\u5C06\\u751F\\u6210\\u7684 SQL \\u8BED\\u53E5\\u4FDD\\u5B58\\u5230\\u65B0\\u521B\\u5EFA\\u7684\",(0,n.jsx)(e.code,{children:\"prisma/migrations\"}),\"\\u6587\\u4EF6\\u5939\\u4E2D\\u3002\"]}),(0,n.jsx)(e.li,{children:\"\\u6267\\u884C\\u8FC1\\u79FB\\uFF1APrisma Migrate \\u5C06\\u6267\\u884C\\u8FC1\\u79FB\\u6587\\u4EF6\\u4E2D\\u7684 SQL \\u8BED\\u53E5\\uFF0C\\u5728\\u6570\\u636E\\u5E93\\u4E2D\\u521B\\u5EFA\\u57FA\\u7840\\u8868\\u3002\"}),(0,n.jsxs)(e.li,{children:[\"\\u5B89\\u88C5 \",(0,n.jsx)(e.code,{children:\"@prisma/client\"}),\"\\uFF1A\\u7531\\u4E8E\\u6211\\u4EEC\\u6CA1\\u6709\\u5B89\\u88C5\\u5BA2\\u6237\\u7AEF\\u5E93\\uFF0C\\u56E0\\u6B64 CLI \\u4F1A\\u5E2E\\u6211\\u4EEC\\u5B89\\u88C5\\u5B83\\u3002\\u6267\\u884C\\u5B8C\\u6210\\u540E\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u5728 \",(0,n.jsx)(e.code,{children:\"package.json\"}),\" \\u4E2D\\u770B\\u5230\\u5B89\\u88C5\\u7684 \",(0,n.jsx)(e.code,{children:\"@prisma/client\"}),\" \\u5305\\uFF0C\\u6211\\u4EEC\\u5C06\\u7528\\u5B83\\u5411\\u6570\\u636E\\u5E93\\u53D1\\u9001\\u67E5\\u8BE2\\u3002\"]})]}),(0,n.jsx)(e.p,{children:\"\\u6267\\u884C\\u6210\\u529F\\u540E\\u6211\\u4EEC\\u53EF\\u4EE5\\u5728\\u547D\\u4EE4\\u884C\\u4E2D\\u770B\\u5230\\u4EE5\\u4E0B\\u63D0\\u793A\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"Prisma \\u8FC1\\u79FB\\u6210\\u529F\\u751F\\u6210SQL\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a8f25195fe2f4c5cafafe3efd1144c6f~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsxs)(e.p,{children:[\"\\u6211\\u4EEC\\u4E5F\\u53EF\\u4EE5\\u67E5\\u770B \",(0,n.jsx)(e.code,{children:\"prisma/migrations\"}),\" \\u6587\\u4EF6\\u5939\\u4E2D\\u7684\\u6587\\u4EF6\\uFF0C\\u4E86\\u89E3\\u5E95\\u5C42\\u6267\\u884C\\u7684 SQL \\u8BED\\u53E5\\uFF0C\\u4E0B\\u9762\\u4FBF\\u662F\\u7B2C\\u4E00\\u6B21\\u6267\\u884C\\u540E\\u751F\\u6210\\u7684 SQL\\u3002\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"Prisma \\u751F\\u6210\\u7684SQL\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d15216ae5da24482aa29c6c6033bd4f5~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsx)(e.p,{children:\"\\u6B64\\u65F6\\u6211\\u53D1\\u73B0\\u8BBE\\u8BA1\\u6570\\u636E\\u5E93\\u65F6\\uFF0C\\u5C11\\u52A0\\u4E86\\u4E00\\u4E2A\\u5B57\\u6BB5\\uFF0C\\u6BCF\\u4E2A\\u7AE0\\u8282\\u7684\\u89C6\\u9891\\u5C11\\u52A0\\u4E86\\u4E00\\u4E2A\\u5C01\\u9762\\u5B57\\u6BB5\\uFF0C\\u6CA1\\u5173\\u7CFB\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u76F4\\u63A5\\u4FEE\\u6539 Schema\\u3002\"}),(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight language-diff-js\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`model Chapter {\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`   id      Int    @id @default(autoincrement())\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`   title   String\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`+  cover   String\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`   url     String\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`   videoId Int\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`   video   Video? @relation(fields: [videoId], references: [id])\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`}\n`})]})}),(0,n.jsxs)(e.p,{children:[\"\\u518D\\u6B21\\u6267\\u884C\",(0,n.jsx)(e.code,{children:\"prisma migrate dev --name added_cover\"}),\", \\u6570\\u636E\\u5E93\\u4E2D\\u4FBF\\u4F1A\\u540C\\u6B65\\u8BE5\\u5B57\\u6BB5\\uFF0C \",(0,n.jsx)(e.code,{children:\"prisma/migrations\"}),\" \\u6587\\u4EF6\\u5939\\u4E0B\\u4FBF\\u4F1A\\u591A\\u4E00\\u4E2A SQL \\u6587\\u4EF6\\u3002\"]}),(0,n.jsx)(e.pre,{className:\"language-sql\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-sql\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"-- AlterTable\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"ALTER\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"TABLE\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"Chapter\"'}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"ADD\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"COLUMN\"}),\"     \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"cover\"'}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"TEXT\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"NOT\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"NULL\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u5982\\u679C\\u5728\\u751F\\u4EA7\\u73AF\\u5883\\u4E2D\\uFF0C\\u53D8\\u52A8\\u6570\\u636E\\u5E93\\u7ED3\\u6784\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u5C06\\u8FD9\\u4E9B\\u751F\\u6210\\u7684 SQL \\u6587\\u4EF6\\u63D0\\u4EA4\\u5230 git \\u4E2D\\u3002\\u5728\\u4EE3\\u7801\\u90E8\\u7F72\\u524D\\u6267\\u884C\",(0,n.jsx)(e.code,{children:\"npx prisma migrate deploy\"}),\" \\u6765\\u5E94\\u7528\\u8FD9\\u4E9B SQL \\u7684\\u6539\\u52A8\\u3002\"]}),(0,n.jsxs)(e.h2,{id:\"\\u4E3A\\u6570\\u636E\\u5E93\\u64AD\\u79CD\\u6570\\u636E\",children:[(0,n.jsx)(e.a,{href:\"#\\u4E3A\\u6570\\u636E\\u5E93\\u64AD\\u79CD\\u6570\\u636E\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u4E3A\\u6570\\u636E\\u5E93\\u64AD\\u79CD\\u6570\\u636E\"]}),(0,n.jsx)(e.p,{children:\"\\u5230\\u76EE\\u524D\\u4E3A\\u6B62\\uFF0C\\u6570\\u636E\\u5E93\\u8FD8\\u662F\\u4E3A\\u7A7A\\u7684\\uFF0C\\u56E0\\u6B64\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u521B\\u5EFA\\u4E00\\u4E2A\\u79CD\\u5B50\\u811A\\u672C\\uFF0C\\u586B\\u5145\\u4E00\\u4E9B\\u521D\\u59CB\\u6570\\u636E\\u8FDB\\u5165\\u6570\\u636E\\u5E93\\uFF0C\\u6709\\u4E9B\\u521D\\u59CB\\u6570\\u636E\\u662F\\u7A0B\\u5E8F\\u5FC5\\u4E0D\\u53EF\\u5C11\\u7684\\uFF0C\\u6BD4\\u5982\\u8D27\\u5E01\\u8BED\\u8A00\\u4FE1\\u606F\\u7B49\\uFF0C\\u6709\\u65F6\\u5019\\u5F00\\u53D1\\u9700\\u8981\\u91CD\\u7F6E\\u6570\\u636E\\u5E93\\uFF0C\\u56E0\\u6B64\\u4E3A\\u6570\\u636E\\u5E93\\u64AD\\u79CD\\u4E5F\\u5F88\\u6709\\u5FC5\\u8981\\u3002\"}),(0,n.jsxs)(e.p,{children:[\"\\u9996\\u5148\\uFF0C\\u521B\\u5EFA\\u4E00\\u4E2A\\u540D\\u4E3A\",(0,n.jsx)(e.code,{children:\"prisma/seed.ts\"}),\"\\u3002 \\u7136\\u540E\\u7C98\\u8D34\\u4EE5\\u4E0B\\u6A21\\u677F\\u4EE3\\u7801\"]}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-ts\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" PrismaClient \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'@prisma/client'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// \\u521D\\u59CB\\u5316 Prisma Client\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" prisma \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PrismaClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//\\u5728\\u6B64\\u7F16\\u5199 Prisma Client \\u67E5\\u8BE2\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"catch\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"e\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"console\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"e\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    process\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"exit\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"finally\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// \\u5173\\u95ED Prisma Client\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"await\"}),\" prisma\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"$disconnect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u4E3A\\u4E86\\u80FD\\u591F\\u8BA9 nodejs \\u8FD0\\u884C typescript\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u5B89\\u88C5\",(0,n.jsx)(e.code,{children:\"ts-node\"})]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"yarn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),` ts-node --dev\n`]})})}),(0,n.jsxs)(e.p,{children:[\"\\u7136\\u540E\\u5728 \",(0,n.jsx)(e.code,{children:\"tsconfig.json\"}),\" \\u4E2D\\u6307\\u5B9A\\u8F93\\u51FA\\u683C\\u5F0F\\u4E3A \",(0,n.jsx)(e.code,{children:\"commonjs\"})]}),(0,n.jsx)(e.pre,{className:\"language-json\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-json\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"ts-node\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"compilerOptions\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token property\",children:'\"module\"'}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"commonjs\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u63A5\\u4E0B\\u6765\\uFF0C\\u6211\\u4EEC\\u5728 \",(0,n.jsx)(e.code,{children:\"main\"}),\" \\u51FD\\u6570\\u4E2D\\u521B\\u5EFA\\u4E00\\u4E2A\\u7528\\u6237\"]}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-ts\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" user \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"await\"}),\" prisma\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"create\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      name\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\\u5C0F\\u9A6C'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      avatar\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'https://p3-passport.byteimg.com/img/user-avatar/585e1491713363bc8f67d06c485e8260~100x100.awebp'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"console\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"log\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u5728\\u8BE5\\u51FD\\u6570\\u4E2D\\uFF0C\\u6D89\\u53CA\\u6570\\u636E\\u6A21\\u578B\\uFF08\",(0,n.jsx)(e.code,{children:\"prisma.user\"}),\"\\uFF09\\u3001data(\",(0,n.jsx)(e.code,{children:\"name, avatar\"}),\") \\u53C2\\u6570\\u7B49\\uFF0C\\u6211\\u4EEC\\u90FD\\u53EF\\u4EE5\\u4F7F\\u7528\",(0,n.jsx)(e.code,{children:\"control + \\u7A7A\\u683C\\u952E\"}),\"\\u6765\\u4F53\\u9A8C typescript \\u5E26\\u6765\\u7684\\u667A\\u80FD\\u63D0\\u793A\\u3002\"]}),(0,n.jsx)(e.p,{children:\"\\u6267\\u884C\\u547D\\u4EE4\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsx)(e.span,{className:\"code-line\",children:`npx ts-node ./prisma/seed.ts\n`})})}),(0,n.jsx)(e.p,{children:\"\\u6267\\u884C\\u540E\\uFF0C\\u6211\\u4EEC\\u5C31\\u53EF\\u4EE5\\u5728\\u6570\\u636E\\u5E93\\u4E2D\\u770B\\u5230\\u8FD9\\u6761\\u6DFB\\u52A0\\u7684\\u6570\\u636E\\u3002\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\\u64AD\\u79CD\\u7684\\u7528\\u6237\\u6570\\u636E\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ca1360f70fcb4be08f4a03468caccd28~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsxs)(e.p,{children:[\"\\u89C6\\u9891\\u6570\\u636E\\u6211\\u627E\\u4E86\\u201C\\u8BD1\\u5B66\\u9986\\u201D\\u4E2D\\u7684\\u4E00\\u4E2A\",(0,n.jsx)(e.a,{href:\"https://api.yxgapp.com/courses/1087\",title:\"\\u8BD1\\u5B66\\u9986\",children:\"API\"}),\" \\u4F5C\\u4E3A\\u6211\\u7684\\u521D\\u59CB\\u6570\\u636E\\uFF0C\\u4FEE\\u6539 \",(0,n.jsx)(e.code,{children:\"main\"}),\" \\u51FD\\u6570\\u6765\\u586B\\u5145\\u89C6\\u9891\\u6570\\u636E\\u3002\"]}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-ts\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" example \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'./example.json'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" category \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"await\"}),\" prisma\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"category\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"create\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      name\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\\u6570\\u5B66'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" chapters \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" example\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"outlines\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"reduce\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"res\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" item\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    item\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"lectures\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"forEach\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"lecture\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      res\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"push\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        title\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" lecture\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"title \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"??\"}),\" lecture\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"en_title \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"??\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"''\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        cover\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" lecture\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"resource\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"cover_url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        url\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" lecture\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"resource\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"content\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` res\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"console\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"log\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"chapters\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"await\"}),\" prisma\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"video\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"create\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      title\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" example\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"title\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      pic\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" example\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"cover_url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      desc\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" example\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"brief\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      categoryId\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" category\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      authorId\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      chapter\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        createMany\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"          data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" chapters\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u518D\\u6B21\\u6267\\u884C \",(0,n.jsx)(e.code,{children:\"npx ts-node prisma/seed.ts\"}),\", \\u89C6\\u9891\\u6570\\u636E\\u5DF2\\u7ECF\\u6DFB\\u52A0\\u5230\\u4E86\\u6211\\u4EEC\\u7684\\u6570\\u636E\\u5E93\\u4E2D\\u3002\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\\u64AD\\u79CD\\u7684\\u89C6\\u9891\\u6570\\u636E\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6138ac7b77634e83a6cbc3f4e50ffdef~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsxs)(e.p,{children:[\"\\u5728 package.json \\u4E2D\\u6DFB\\u52A0 \",(0,n.jsx)(e.code,{children:\"prisma.seed\"}),\" \\u5B57\\u6BB5\"]}),(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight language-diff-json\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`{\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`+  \"prisma\": {\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`+    \"seed\": \"ts-node prisma/seed.ts\"\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`+  },\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`   \"devDependencies\": {\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`   }\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`}\n`})]})}),(0,n.jsxs)(e.p,{children:[\"\\u5728\\u5F00\\u53D1\\u4E2D\\u5982\\u518D\\u6B21\\u4FEE\\u6539\\u6570\\u636E\\u8868\\uFF0C\\u6267\\u884C \",(0,n.jsx)(e.code,{children:\"prisma migrate dev\"}),\" \\u7684\\u65F6\\u5019\\u4F1A\\u81EA\\u52A8\\u6267\\u884C \",(0,n.jsx)(e.code,{children:\"seed\"}),\"\\u64AD\\u79CD\\u6570\\u636E\\uFF0C\\u5173\\u4E8E\\u64AD\\u79CD\\u6570\\u636E\\u8BE6\\u60C5\\u8BF7\\u770B \",(0,n.jsx)(e.a,{href:\"https://www.prisma.io/docs/guides/database/seed-database\",title:\"prisma \\u6587\\u6863\",children:\"prisma \\u6587\\u6863\"})]}),(0,n.jsxs)(e.h2,{id:\"nextjs-\\u4E2D\\u5B9E\\u4F8B\\u5316-prismaclient\",children:[(0,n.jsx)(e.a,{href:\"#nextjs-\\u4E2D\\u5B9E\\u4F8B\\u5316-prismaclient\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Next.js \\u4E2D\\u5B9E\\u4F8B\\u5316 PrismaClient\"]}),(0,n.jsx)(e.p,{children:\"\\u63A5\\u4E0B\\u6765\\u6211\\u4EEC\\u9700\\u8981\\u5728 Next.js \\u4E2D\\u8C03\\u7528 Prisma \\u67E5\\u8BE2\\u8BED\\u8A00\\uFF0C\\u7528\\u4E8E\\u670D\\u52A1\\u7AEF\\u83B7\\u53D6\\u6570\\u636E\\u3002\"}),(0,n.jsxs)(e.p,{children:[\"\\u65B0\\u5EFA\\u4E00\\u4E2A \",(0,n.jsx)(e.code,{children:\"lib/prisma.ts\"})]}),(0,n.jsx)(e.p,{children:\"\\u8F93\\u5165\\u4EE5\\u4E0B\\u4EE3\\u7801\\uFF1A\"}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-ts\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" PrismaClient \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'@prisma/client'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"let\"}),\" prisma\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),` PrismaClient\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"process\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"env\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"NODE_ENV\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"===\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'production'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  prisma \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PrismaClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\"global\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"prisma\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    global\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"prisma \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"PrismaClient\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  prisma \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" global\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`prisma\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"default\"}),` prisma\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u4E0A\\u9762\\u4EE3\\u7801\\u662F\\u4E3A\\u4E86\\u9632\\u6B62\\uFF0C\\u5728\\u5F00\\u53D1\\u6A21\\u5F0F\\u4E0B\\uFF0C \",(0,n.jsx)(e.code,{children:\"PrismaClient\"}),\" \\u8017\\u5C3D\\u6570\\u636E\\u94FE\\u63A5\\u6570\\uFF0C\\u5C06\\u5B9E\\u4F8B\\u5316\\u7684 \",(0,n.jsx)(e.code,{children:\"PrismaClient\"}),\" \\u5BF9\\u8C61\\u5B58\\u5230\\u5168\\u5C40 \",(0,n.jsx)(e.code,{children:\"global\"}),\" \\u4E2D\\uFF0C \\u8BE6\\u60C5\\u53EF\\u4EE5\\u770B\\u5B98\\u7F51\",(0,n.jsx)(e.a,{href:\"https://www.prisma.io/docs/guides/database/troubleshooting-orm/help-articles/nextjs-prisma-client-dev-practices\",title:\"\\u6700\\u4F73\\u5B9E\\u8DF5\",children:\"\\u6700\\u4F73\\u5B9E\\u8DF5\"}),\"\\u3002\"]}),(0,n.jsx)(e.p,{children:\"PrismaClient \\u5B9E\\u4F8B\\u5316\\u5B8C\\u6210\\uFF0C\\u5DF2\\u7ECF\\u8FEB\\u4E0D\\u53CA\\u5F85\\u8981\\u5728\\u9996\\u9875\\u6E32\\u67D3\\u6570\\u636E\\u4E86\\uFF0C \\u5148\\u5728\\u9996\\u9875\\u6253\\u5370\\u4E0B\\u670D\\u52A1\\u7AEF\\u83B7\\u53D6\\u7684\\u6570\\u636E\\uFF1A\"}),(0,n.jsx)(e.pre,{className:\"language-tsx\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-tsx\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token imports\",children:(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"React\"})}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'react'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"GetServerSideProps\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'next'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token imports\",children:\"prisma\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'../lib/prisma'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" makeSerializable \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'../lib/util'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Video\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"User\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'@prisma/client'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Props\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Video\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    author\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"User\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"Page\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" data \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Props\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token class-name console\",children:\"console\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"log\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"div\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"mx-auto max-w-5xl px-3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"h1\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"\\u9996\\u9875\"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"h1\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"    \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"div\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" getServerSideProps\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function function-variable\",children:\"GetServerSideProps\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"await\"}),\" prisma\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"video\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"findMany\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    include\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" author\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    props\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"makeSerializable\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u4F7F\\u7528 prisma Schema \\u751F\\u6210\\u6570\\u636E\\u6A21\\u578B\\u8FD8\\u6709\\u4E00\\u4E2A\\u4F18\\u52BF\\u5C31\\u662F\\uFF0C\\u51CF\\u5C11\\u5199 typescript \\u63A5\\u53E3\\u7684\\u70E6\\u607C\\uFF0C\\u51E1\\u662F\\u6570\\u636E\\u6A21\\u578B\\u548C\\u589E\\u5220\\u67E5\\u6539\\u76F8\\u5173\\u7684 \",(0,n.jsx)(e.code,{children:\"typescript interface\"}),\" \\u90FD\\u53EF\\u4EE5\\u76F4\\u63A5\\u4ECE \",(0,n.jsx)(e.code,{children:\"@prisma/client\"}),\"\\u4E2D\\u76F4\\u63A5\\u5F15\\u7528\\uFF1B\"]}),(0,n.jsxs)(e.p,{children:[\"Next.js \\u4E2D\\uFF0C\\u670D\\u52A1\\u7AEF\\u6E32\\u67D3\\u7684\\u6570\\u636E\\u5728 \",(0,n.jsx)(e.code,{children:\"getServerSideProps\"}),\" \\u51FD\\u6570\\u4E2D\\u83B7\\u53D6\\uFF0C\\u5982\\u679C\\u76F4\\u63A5\\u5C06\\u6570\\u636E\\u5E93\\u4E2D\\u7684\\u6570\\u636E\\u67E5\\u51FA\\u4F20\\u9012\\u7ED9 \",(0,n.jsx)(e.code,{children:\"props\"}),\"\\uFF0C\\u4F1A\\u5728\\u63A7\\u5236\\u53F0\\u4E2D\\u770B\\u5230\\u5982\\u4E0B\\u9519\\u8BEF:\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"Next.js \\u6E32\\u67D3\\u672A\\u5E8F\\u5217\\u5316\\u7684\\u6570\\u636E\\u62A5\\u9519\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e08bca9f78d481d9319795072a6014a~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsxs)(e.p,{children:[\"\\u539F\\u56E0 Next.js \\u670D\\u52A1\\u7AEF\\u83B7\\u53D6\\u7684\\u6570\\u636E\\u90FD\\u662F\\u901A\\u8FC7 JSON \\u7684\\u5F62\\u5F0F\\u8F93\\u51FA\\u5728 window \\u5168\\u5C40\\u5BF9\\u8C61\\u4E0A\\u7684\\uFF0C\\u800C\\u662F \",(0,n.jsx)(e.code,{children:\"createAt\"}),\" \\u662F \",(0,n.jsx)(e.code,{children:\"Date\"}),\" \\u7C7B\\u578B\\uFF0C\\u662F\\u4E00\\u4E2A \",(0,n.jsx)(e.code,{children:\"Object\"}),\"\\u5BF9\\u8C61\\uFF0C\\u6240\\u4EE5\\u65E0\\u6CD5\\u88AB JSON \\u5E8F\\u5217\\u5316\\uFF0C\\u56E0\\u6B64\\u6211\\u4EEC\\u9700\\u8981\\u8BA9\\u6570\\u636E\\u53D8\\u5F97\\u53EF\\u5E8F\\u5217\\u5316\",(0,n.jsx)(e.code,{children:\"makeSerializable\"}),\"\\uFF0C\\u4EE3\\u7801\\u5982\\u4E0B\\uFF1A\"]}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-ts\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsxs)(e.span,{className:\"token generic-function\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"makeSerializable\"}),(0,n.jsxs)(e.span,{className:\"token class-name generic\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"T\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"extends\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"any\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"})]})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"o\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"T\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"T\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"JSON\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"parse\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"JSON\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"stringify\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"o\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"\\u5E8F\\u5217\\u5316\\u540E\\u7684\\u6570\\u636E\\uFF0C\\u4FBF\\u53EF\\u4EE5\\u5728\\u63A7\\u5236\\u53F0\\u4E2D\\u6253\\u5370\\uFF0C\\u7136\\u540E\\u5C31\\u53EF\\u4EE5\\u4F7F\\u7528 React \\u6109\\u5FEB\\u5730\\u6E32\\u67D3\\u6570\\u636E\\u4E86\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528 Tailwindcss \\u4E2D\\u7684 Grid \\u5E03\\u5C40\\uFF0C\\u5C06\\u9875\\u9762\\u5206\\u6210 2 \\u680F\\uFF0C\\u6700\\u7EC8\\u6548\\u679C\\u5982\\u4E0B\\uFF1A\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\\u89C6\\u9891\\u9996\\u9875\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/501a8384679546e18247b714b928759a~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsxs)(e.h2,{id:\"\\u8BE6\\u60C5\\u9875\\u9762\\u5B9E\\u73B0\",children:[(0,n.jsx)(e.a,{href:\"#\\u8BE6\\u60C5\\u9875\\u9762\\u5B9E\\u73B0\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u8BE6\\u60C5\\u9875\\u9762\\u5B9E\\u73B0\"]}),(0,n.jsxs)(e.p,{children:[\"\\u63A5\\u7740\\u6211\\u4EEC\\u4F7F\\u7528\\u540C\\u6837\\u7684\\u903B\\u8F91\\uFF0C\\u6765\\u5B9E\\u73B0\\u4E0B\\u8BE6\\u60C5\\u9875\\u9762\\u3002\\u65B0\\u5EFA\\u4E00\\u4E2A\",(0,n.jsx)(e.code,{children:\"./pages/video/[id].tsx\"}),\" \\u6587\\u4EF6\\u6309\\u9996\\u9875\\u7684\\u903B\\u8F91\\uFF0C\\u6211\\u4EEC\\u5199\\u4E0B\\u4E86\\u5982\\u4E0B\\u4EE3\\u7801\"]}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-ts\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" getServerSideProps\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function function-variable\",children:\"GetServerSideProps\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"await\"}),\" prisma\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"video\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"findUnique\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    include\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      chapter\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      author\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    where\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      id\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"Number\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"params\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    props\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"makeSerializable\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u53EF\\u4EE5\\u901A\\u8FC7 \",(0,n.jsx)(e.code,{children:\"context.params.id\"}),\"\\u83B7\\u53D6 url \\u4E0A\\u7684 \",(0,n.jsx)(e.code,{children:\"videoId\"}),\"\\uFF0C\",(0,n.jsx)(e.code,{children:\"findUnique\"}),\"\\u65B9\\u6CD5\\u53EF\\u4EE5\\u67E5\\u8BE2\\u6570\\u636E\\u5E93\\u4E2D\\u7684\\u552F\\u4E00\\u8BB0\\u5F55\\u3002\\u6B64\\u65F6\\u8BBF\\u95EE \",(0,n.jsx)(e.code,{children:\"http://localhost:3000/video/1\"}),\"\\uFF0C\\u6211\\u4EEC\\u4FBF\\u53EF\\u4EE5\\u5728\\u63A7\\u5236\\u53F0\\u4E0A\\u6253\\u5370\\u51FA data \\u53C2\\u6570\\u3002\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\\u5168\\u90E8\\u89C6\\u9891\\u7AE0\\u8282\\u6570\\u636E\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/12d2db88086042ac92903a4918d836cf~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsx)(e.p,{children:\"\\u7531\\u4E8E\\u7AE0\\u8282\\u6570\\u91CF\\u592A\\u591A\\uFF0C\\u5728\\u4E00\\u4E2A\\u9875\\u9762\\u4E2D\\u4E00\\u6B21\\u6E32\\u67D3 210 \\u6761\\u6570\\u636E\\u662F\\u4E0D\\u5408\\u7406\\u7684\\uFF0C\\u6BD4\\u8F83\\u597D\\u7684\\u529E\\u6CD5\\u662F\\u5C06\\u201C\\u7AE0\\u8282\\u6570\\u636E\\u201D\\u901A\\u8FC7\\u63A5\\u53E3\\u6765\\u83B7\\u53D6\\uFF0C\\u5B9E\\u73B0\\u6EDA\\u52A8\\u7FFB\\u9875\\u3002\"}),(0,n.jsxs)(e.h3,{id:\"\\u7FFB\\u9875\\u63A5\\u53E3\",children:[(0,n.jsx)(e.a,{href:\"#\\u7FFB\\u9875\\u63A5\\u53E3\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u7FFB\\u9875\\u63A5\\u53E3\"]}),(0,n.jsxs)(e.p,{children:[\"\\u65B0\\u5EFA\\u4E00\\u4E2A \",(0,n.jsx)(e.code,{children:\"./pages/api/chapter.ts\"}),\" \\u6587\\u4EF6\\uFF0C\\u7528\\u4E8E\\u83B7\\u53D6\\u89C6\\u9891\\u7AE0\\u8282\\u6570\\u636E\\u7684\\u63A5\\u53E3\\uFF0C\\u8F93\\u5165\\u4EE5\\u4E0B\\u63A5\\u53E3\\u4EE3\\u7801\"]}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-ts\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" prisma \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'@/lib/prisma'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" makeSerializable \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'@/lib/util'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" NextApiRequest\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" NextApiResponse \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'next'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"handler\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"req\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" NextApiRequest\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" res\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" NextApiResponse\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" videoId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" cursor \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" req\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`query\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\"videoId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    res\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"status\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"400\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"json\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" message\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'videoId is required'\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"await\"}),\" prisma\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"chapter\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"findMany\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    cursor\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" cursor \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      id\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"cursor\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    take\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"11\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    where\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      videoId\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\"videoId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  res\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"status\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"200\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"json\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"makeSerializable\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"slice\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    nextCursor\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"?.\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u4E0A\\u9762\\u4EE3\\u7801\\u4E2D\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528\",(0,n.jsx)(e.code,{children:\"take\"}),\" \\u548C \",(0,n.jsx)(e.code,{children:\"cursor\"}),\"\\u6765\\u5B9E\\u73B0\\u7FFB\\u9875\\uFF0C\\u9ED8\\u8BA4\\u67E5\\u8BE2 11 \\u6761\\u6570\\u636E\\uFF0C\\u4F46\\u53EA\\u8FD4\\u56DE\\u524D 10 \\u6761\\u6570\\u636E\\uFF0C\\u5C06\\u6700\\u540E\\u4E00\\u6761\\u6570\\u636E\\u4F5C\\u4E3A\\u4E0B\\u6B21\\u67E5\\u8BE2\\u7684\\u6307\\u9488\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u4FDD\\u5B58\\u4EE3\\u7801\\u540E\\uFF0C\\u8BBF\\u95EE\\u4E0B\\u63A5\\u53E3\\u5730\\u5740 \",(0,n.jsx)(e.a,{href:\"http://localhost:3000/api/chapter?videoId=1\",children:\"http://localhost:3000/api/chapter?videoId=1\"})]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\\u89C6\\u9891\\u7AE0\\u8282\\u7FFB\\u9875\\u63A5\\u53E3\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fb3bd6f0fc4d4bebbbcbd7d902ed221e~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsx)(e.p,{children:\"\\u6211\\u4EEC\\u53EF\\u4EE5\\u770B\\u5230\\u8FD4\\u56DE 10 \\u6761\\u6570\\u636E\\u548C\\u4E0B\\u4E00\\u4E2A\\u7AE0\\u8282\\u7684\\u6307\\u9488\\uFF0C\\u81F3\\u6B64\\u5206\\u9875\\u63A5\\u53E3\\u5B9E\\u73B0\\u5B8C\\u6210\\u3002\"}),(0,n.jsxs)(e.h3,{id:\"\\u6EDA\\u52A8\\u7FFB\\u9875\",children:[(0,n.jsx)(e.a,{href:\"#\\u6EDA\\u52A8\\u7FFB\\u9875\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u6EDA\\u52A8\\u7FFB\\u9875\"]}),(0,n.jsxs)(e.p,{children:[\"\\u8BE6\\u60C5\\u9875\\u5206\\u7C7B 2 \\u4E2A\\u90E8\\u5206\\uFF0C\\u89C6\\u9891\\u57FA\\u7840\\u4FE1\\u606F\\u662F\\u5728\\u670D\\u52A1\\u7AEF\\u6E32\\u67D3\\uFF0C\\u7AE0\\u8282\\u4FE1\\u606F\\u901A\\u8FC7\\u63A5\\u53E3\\u5728\\u5BA2\\u6237\\u7AEF\\u6E32\\u67D3\\uFF0C\\u4E3A\\u4E86\\u65B9\\u4FBF\\u5B9E\\u73B0\\u6EDA\\u52A8\\u7FFB\\u9875\\uFF0C\\u6211\\u4EEC\\u5B89\\u88C5\\u4E00\\u4E2A\\u5305 [swr](SWR: \",(0,n.jsx)(e.a,{href:\"https://swr.vercel.app/),%E5%85%A8%E7%A7%B0%E6%98%AF\",children:\"https://swr.vercel.app/),\\u5168\\u79F0\\u662F\"}),\" stale-while-revalidate\\uFF0C\\u4E5F\\u662F vercel \\u5F00\\u6E90\\u7684\\u4E00\\u4E2A\\u6570\\u636E\\u6D41\\u8BF7\\u6C42\\u5E93\\u3002\"]}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsx)(e.code,{className:\"code-highlight language-bash\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"yarn\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),`  swr\n`]})})}),(0,n.jsxs)(e.p,{children:[\"\\u4FEE\\u6539 \",(0,n.jsx)(e.code,{children:\"./pages/video/[id].tsx\"}),\" \\u4E2D\\u7684\\u4EE3\\u7801\\u4E3A\\u4EE5\\u4E0B\\u4EE3\\u7801\"]}),(0,n.jsx)(e.pre,{className:\"language-tsx\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-tsx\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"React\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" useRef\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" useEffect \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'react'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"GetServerSideProps\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'next'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token imports\",children:(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Link\"})}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'next/link'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token imports\",children:(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Image\"})}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'next/image'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token imports\",children:\"prisma\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'@/lib/prisma'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" makeSerializable \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'@/lib/util'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Video\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"User\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Chapter\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'@prisma/client'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token imports\",children:\"useSWRInfinite\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'swr/infinite'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token imports\",children:\"useOnScreen\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'@/hooks/useOnScreen'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Props\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  video\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Video\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    author\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"User\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Result\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" data\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Chapter\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" nextCursor\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"number\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function function-variable\",children:\"getKey\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"pageIndex\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" previousPageData\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" videoId\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// reached the end\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"previousPageData \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\"previousPageData\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"data\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"null\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// \\u9996\\u9875\\uFF0C\\u6CA1\\u6709 `previousPageData`\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"pageIndex \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"===\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsxs)(e.span,{className:\"token template-string\",children:[(0,n.jsx)(e.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"/api/chapter?videoId=\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"videoId\",(0,n.jsx)(e.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string template-punctuation\",children:\"`\"})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// \\u5C06\\u6E38\\u6807\\u6DFB\\u52A0\\u5230 API\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsxs)(e.span,{className:\"token template-string\",children:[(0,n.jsx)(e.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"/api/chapter?cursor=\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"previousPageData\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"nextCursor\",(0,n.jsx)(e.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string\",children:\"\u0026videoId=\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"videoId\",(0,n.jsx)(e.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string template-punctuation\",children:\"`\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function function-variable\",children:\"fetcher\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"url\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"fetch\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"url\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"then\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"res\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" res\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"json\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"Page\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" video \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Props\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" ref\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"any\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token generic-function\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"useRef\"}),(0,n.jsxs)(e.span,{className:\"token class-name generic\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\"HTMLDivElement\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"})]})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" onScreen\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"boolean\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token generic-function\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"useOnScreen\"}),(0,n.jsxs)(e.span,{className:\"token class-name generic\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\"HTMLDivElement\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"})]})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ref\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" setSize \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token generic-function\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"useSWRInfinite\"}),(0,n.jsxs)(e.span,{className:\"token class-name generic\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\"Result\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"})]})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator spread\",children:\"...\"}),\"args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"getKey\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator spread\",children:\"...\"}),\"args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" video\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    fetcher\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      revalidateFirstPage\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"false\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" hasNext \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"length\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"nextCursor\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" isLoadingInitialData \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\"data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),`error\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" isLoadingMore \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    isLoadingInitialData \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"||\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"typeof\"}),\" data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"===\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'undefined'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"useEffect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"onScreen \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" hasNext\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token function\",children:\"setSize\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"size \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"onScreen\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" hasNext\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"div\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"mx-auto max-w-5xl px-3 pb-5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"h1\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"my-4 text-center text-3xl\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"video\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"title\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"h1\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"div\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"text-center\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"        \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Image\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"src\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"video\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"pic\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"width\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"320\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"height\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"180\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"alt\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"video\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"title\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"/\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"div\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"div\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"p-3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"video\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"desc\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"div\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"h2\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"my-2 text-xl\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"\\u7AE0\\u8282\\u89C6\\u9891\"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"h2\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"div\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"        \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"main\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"grid grid-cols-2 gap-4 md:grid-cols-4 md:gap-4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"          \"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"pageData\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" index\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// `data` \\u662F\\u6BCF\\u4E2A\\u9875\\u9762 API \\u54CD\\u5E94\\u7684\\u6570\\u7EC4\\u3002\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" pageData\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"data\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"map\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"item\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"                \",(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"div\"]}),`\n`]})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token tag\",children:[\"                  \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"flex flex-col justify-center p-2 ring-1 ring-gray-200\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token tag\",children:[\"                  \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"key\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"item\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[\"                \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"                  \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Link\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"href\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsxs)(e.span,{className:\"token template-string\",children:[(0,n.jsx)(e.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"/video/chapter/\"}),(0,n.jsxs)(e.span,{className:\"token interpolation\",children:[(0,n.jsx)(e.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"item\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"id\",(0,n.jsx)(e.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"                    \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"a\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"mx-auto\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"                      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Image\"})]}),`\n`]})]}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token tag\",children:[\"                        \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"aspect-video\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token tag\",children:[\"                        \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"src\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"item\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"cover\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token tag\",children:[\"                        \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"width\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"160\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token tag\",children:[\"                        \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"height\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"90\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,n.jsx)(e.span,{className:\"code-line\",children:(0,n.jsxs)(e.span,{className:\"token tag\",children:[\"                        \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"alt\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"item\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"title\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),`\n`]})}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[\"                      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"/\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"                      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"div\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"mt-2 h-12 overflow-hidden text-ellipsis\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"item\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"title\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"div\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"                    \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"a\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"                  \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Link\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"                \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"div\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"              \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"        \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"main\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"        \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c\"}),\"div\"]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"className\"}),(0,n.jsxs)(e.span,{className:\"token attr-value\",children:[(0,n.jsx)(e.span,{className:\"token punctuation attr-equals\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'}),\"p-3 text-center\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:'\"'})]}),\" \",(0,n.jsx)(e.span,{className:\"token attr-name\",children:\"ref\"}),(0,n.jsxs)(e.span,{className:\"token language-javascript script\",children:[(0,n.jsx)(e.span,{className:\"token punctuation script-punctuation\",children:\"=\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"ref\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"          \"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"isLoadingMore \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"?\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'Loading...'\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" hasNext \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"?\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\\u52A0\\u8F7D\\u66F4\\u591A'\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'\\u6CA1\\u6709\\u6570\\u636E\\u4E86'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"        \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"div\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"      \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"div\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),(0,n.jsx)(e.span,{className:\"token plain-text\",children:`\n`})]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token plain-text\",children:\"    \"}),(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsxs)(e.span,{className:\"token tag\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003c/\"}),\"div\"]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" getServerSideProps\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function function-variable\",children:\"GetServerSideProps\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator arrow\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" video \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"await\"}),\" prisma\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"video\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"findUnique\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    include\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      author\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    where\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      id\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"Number\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"context\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"params\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"id\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    props\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      video\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"makeSerializable\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"video\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u8BE5\\u9875\\u9762\\u5305\\u542B 2 \\u90E8\\u5206\\u5185\\u5BB9\\uFF0C\\u89C6\\u9891\\u7684\\u57FA\\u7840\\u4FE1\\u606F\\u662F\\u5728\\u670D\\u52A1\\u7AEF\\u6E32\\u67D3\\u7684\\uFF0C\\u89C6\\u9891\\u7684\\u7AE0\\u8282\\u4FE1\\u606F\\u901A\\u8FC7\",(0,n.jsx)(e.code,{children:\"useSWRInfinite\"}),\"\\u65E0\\u9650\\u52A0\\u8F7D, \\u5F53\\u5E95\\u90E8\\u201C\\u52A0\\u66F4\\u591A\\u6570\\u636E\\u201D\\u5448\\u73B0\\u5728\\u9875\\u9762\\u4E2D\\u7684\\u65F6\\u5019\\u81EA\\u52A8\\u6267\\u884C\\u4E0B\\u4E00\\u9875\\uFF0C\\u6240\\u4EE5\\u4F7F\\u7528\\u5230\\u4E00\\u4E2A Hooks \",(0,n.jsx)(e.code,{children:\"useOnScreen\"}),\" \\u7528\\u4E8E\\u76D1\\u542C div \\u5143\\u7D20\\u6709\\u6CA1\\u6709\\u5728\\u9875\\u9762\\u4E0A\\u663E\\u793A\\u3002\"]}),(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-ts\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" useState\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" useEffect\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" MutableRefObject \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'react'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsxs)(e.span,{className:\"token generic-function\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"useOnScreen\"}),(0,n.jsxs)(e.span,{className:\"token class-name generic\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"T\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"extends\"}),\" Element\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"})]})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  ref\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" MutableRefObject\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"T\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  rootMargin\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'0px'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"boolean\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// \\u72B6\\u6001\\u662F\\u5426\\u53EF\\u89C1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"isIntersecting\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" setIntersecting\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsxs)(e.span,{className:\"token generic-function\",children:[(0,n.jsx)(e.span,{className:\"token function\",children:\"useState\"}),(0,n.jsxs)(e.span,{className:\"token class-name generic\",children:[(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"boolean\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\"})]})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"false\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"useEffect\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" observer \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"IntersectionObserver\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"entry\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// observer \\u56DE\\u8C03\\u89E6\\u53D1\\u8DDF\\u65B0\\u72B6\\u6001\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token function\",children:\"setIntersecting\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"entry\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"isIntersecting\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        rootMargin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ref\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"current\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      observer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"observe\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ref\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"current\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"      ref\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"current \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" observer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"unobserve\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"ref\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"current\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),` isIntersecting\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:'IntersectionObserver API\\uFF0C\\u53EF\\u4EE5\\u81EA\\u52A8\"\\u89C2\\u5BDF\"\\u5143\\u7D20\\u662F\\u5426\\u53EF\\u89C1\\uFF0CChrome 51+ \\u5DF2\\u7ECF\\u652F\\u6301\\u3002\\u7531\\u4E8E\\u53EF\\u89C1\\uFF08visible\\uFF09\\u7684\\u672C\\u8D28\\u662F\\uFF0C\\u76EE\\u6807\\u5143\\u7D20\\u4E0E\\u89C6\\u53E3\\u4EA7\\u751F\\u4E00\\u4E2A\\u4EA4\\u53C9\\u533A\\uFF0C\\u6240\\u4EE5\\u8FD9\\u4E2A API \\u53EB\\u505A\"\\u4EA4\\u53C9\\u89C2\\u5BDF\\u5668\"\\u3002'}),(0,n.jsx)(e.p,{children:\"\\u6700\\u7EC8\\u5B9E\\u73B0\\u6548\\u679C\\u5982\\u4E0B\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\\u89C6\\u9891\\u7AE0\\u8282\\u9875\",src:\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/453a02ef20cd45468698e2c0e4e719a9~tplv-k3u1fbpfcp-zoom-1.image\"})}),(0,n.jsxs)(e.p,{children:[\"\\u6700\\u540E\\u89C6\\u9891\\u8BE6\\u60C5\\u9875\\u7684\\u4EE3\\u7801\\u4E0E\\u524D\\u9762\\u90FD\\u5DEE\\u4E0D\\u591A\\uFF0C\\u8FD9\\u91CC\\u5C31\\u4E0D\\u8FC7\\u591A\\u8D58\\u8FF0\\u4E86\\uFF0C\\u611F\\u5174\\u8DA3\\u7684\\u5C0F\\u4F19\\u4F34\\u53EF\\u4EE5\\u76F4\\u63A5\\u770B \",(0,n.jsx)(e.a,{href:\"https://github.com/maqi1520/next-prisma-video-app\",children:\"GitHub \\u4ED3\\u5E93\"}),\" \\u4E2D\\u7684\\u4EE3\\u7801\\uFF0C\\u6211\\u76F8\\u4FE1\\u4F60\\u5DF2\\u7ECF\\u5B66\\u4F1A\\u4E86 prisma + Next.js \\u5168\\u6808\\u5F00\\u53D1\\u7684\\u4E3B\\u8981\\u6D41\\u7A0B\\u3002\"]}),(0,n.jsxs)(e.h2,{id:\"\\u5C0F\\u7ED3\",children:[(0,n.jsx)(e.a,{href:\"#\\u5C0F\\u7ED3\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u5C0F\\u7ED3\"]}),(0,n.jsx)(e.p,{children:\"\\u672C\\u6587\\u901A\\u8FC7\\u5B9E\\u73B0\\u4E00\\u4E2A\\u89C6\\u9891\\u7F51\\u7AD9\\u4E3A\\u4F8B\\uFF0C\\u4ECB\\u7ECD\\u4E86 prisma \\u8FD9\\u6B3E Node.js ORM \\u6846\\u67B6\\u5982\\u4F55\\u5728 Next.js \\u4E2D\\u4F7F\\u7528\\u3002\"}),(0,n.jsx)(e.p,{children:\"\\u6574\\u4F53\\u6D41\\u7A0B\\u662F\\uFF1A\"}),(0,n.jsxs)(e.ol,{children:[(0,n.jsx)(e.li,{children:\"\\u7F16\\u5199 prisma Schema \\u8BBE\\u8BA1\\u6570\\u636E\\u5E93\\uFF1B\"}),(0,n.jsx)(e.li,{children:\"\\u6267\\u884C prisma migrate \\u5B9E\\u73B0 Schema \\u5230\\u6570\\u636E\\u5E93\\u7684\\u8FC1\\u79FB\\uFF1B\"}),(0,n.jsx)(e.li,{children:\"\\u6267\\u884C prisma seed \\u586B\\u5145\\u6570\\u636E\\u5E93\\uFF1B\"}),(0,n.jsxs)(e.li,{children:[\"\\u5728 Next.js \\u7684 \",(0,n.jsx)(e.code,{children:\"getServerSideProps\"}),\" \\u4E2D\\u8C03\\u7528 prisma \\u67E5\\u8BE2\\u8BED\\u8A00\\uFF0C\\u5B9E\\u73B0\\u670D\\u52A1\\u7AEF\\u6E32\\u67D3\\uFF1B\"]})]}),(0,n.jsx)(e.p,{children:\"prisma \\u5BF9\\u4E8E Next.js \\u6765\\u8BF4\\uFF0C\\u53EF\\u8C13\\u662F\\u5982\\u864E\\u6DFB\\u7FFC\\uFF0C\\u6709\\u4E86\\u5B83\\u4EEC\\uFF0C\\u6211\\u4EEC\\u524D\\u7AEF\\u5DE5\\u7A0B\\u5E08\\u8F7B\\u677E\\u6B65\\u5165\\u4E86\\u5168\\u6808\\u5F00\\u53D1\\u3002\\u4F60\\u5B66\\u4F1A\\u4E86\\u5417\\uFF1F\\u82E5\\u5BF9\\u4F60\\u6709\\u5E2E\\u52A9\\uFF0C\\u8BB0\\u5F97\\u5E2E\\u6211\\u70B9\\u8D5E\\u3002\"}),(0,n.jsxs)(e.h2,{id:\"\\u540E\\u7EED\",children:[(0,n.jsx)(e.a,{href:\"#\\u540E\\u7EED\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u540E\\u7EED\"]}),(0,n.jsx)(e.p,{children:\"\\u5F53\\u7136\\u6211\\u4EEC\\u7684\\u89C6\\u9891\\u7F51\\u7AD9\\u76EE\\u524D\\u8FD8\\u77E5\\u8BC6\\u4E00\\u4E2A\\u96CF\\u5F62\\uFF0C\\u7528\\u6237\\u662F\\u624B\\u52A8\\u5F55\\u5165\\u6570\\u636E\\u5E93\\u7684\\uFF0C\\u8FD8\\u6709\\u767B\\u5F55\\u548C\\u6CE8\\u518C\\u673A\\u5236\\uFF0C\\u63A5\\u4E0B\\u6765\\u6211\\u5C06\\u7EE7\\u7EED\\u5206\\u4EAB Next.js \\u76F8\\u5173\\u7684\\u5B9E\\u6218\\u6587\\u7AE0\\uFF0C\\u6B22\\u8FCE\\u5404\\u4F4D\\u5173\\u6CE8\\u6211\\u7684\\u300ANext.js \\u5168\\u6808\\u5F00\\u53D1\\u5B9E\\u6218\\u300B \\u4E13\\u680F\\u3002\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"\\u4F7F\\u7528 next-auth \\u6765\\u5B9E\\u73B0 Next.js \\u5E94\\u7528\\u7684\\u9274\\u6743\\u4E0E\\u8BA4\\u8BC1\"}),(0,n.jsx)(e.li,{children:\"\\u4F7F\\u7528 React query \\u7ED9 Next.js \\u5E94\\u7528\\u5168\\u5C40\\u72B6\\u6001\\u7BA1\\u7406\"}),(0,n.jsx)(e.li,{children:\"\\u4F7F\\u7528 i18next \\u5B9E\\u73B0 Next.js \\u5E94\\u7528\\u56FD\\u9645\\u5316\"}),(0,n.jsx)(e.li,{children:\"\\u4F7F\\u7528 Playwright \\u8FDB\\u884C Next.js \\u5E94\\u7528\\u7684\\u7AEF\\u5230\\u7AEF\\u6D4B\\u8BD5\"}),(0,n.jsx)(e.li,{children:\"\\u4F7F\\u7528 Github actions \\u7ED9 Next.js \\u5E94\\u7528\\u521B\\u5EFA CI/CD\"}),(0,n.jsx)(e.li,{children:\"\\u4F7F\\u7528 Docker \\u90E8\\u7F72 Next.js \\u5E94\\u7528\"}),(0,n.jsx)(e.li,{children:\"\\u5C06 Next.js \\u5E94\\u7528\\u90E8\\u7F72\\u5230\\u817E\\u8BAF\\u4E91 serverless\"})]}),(0,n.jsx)(e.p,{children:\"\\u4F60\\u5BF9\\u54EA\\u5757\\u5185\\u5BB9\\u6BD4\\u8F83\\u611F\\u5174\\u8DA3\\u5462\\uFF1F\\u6B22\\u8FCE\\u5728\\u8BC4\\u8BBA\\u533A\\u7559\\u8A00\\uFF0C\\u611F\\u8C22\\u60A8\\u7684\\u9605\\u8BFB\\u3002\"})]})}}var x=w;return y(v);})();\n;return Component;","toc":[{"value":"前言","url":"#前言","depth":2},{"value":"阅读本文，你将收获：","url":"#阅读本文你将收获","depth":2},{"value":"初始化项目","url":"#初始化项目","depth":2},{"value":"开发环境","url":"#开发环境","depth":2},{"value":"安装 Docker","url":"#安装-docker","depth":3},{"value":"创建 PostgreSQL 实例","url":"#创建-postgresql-实例","depth":3},{"value":"需求分析","url":"#需求分析","depth":2},{"value":"数据实体关系图","url":"#数据实体关系图","depth":2},{"value":"初始化 Prisma","url":"#初始化-prisma","depth":2},{"value":"设置环境变量","url":"#设置环境变量","depth":3},{"value":"了解 Prisma schema","url":"#了解-prisma-schema","depth":3},{"value":"对数据建模","url":"#对数据建模","depth":2},{"value":"迁移数据库","url":"#迁移数据库","depth":2},{"value":"为数据库播种数据","url":"#为数据库播种数据","depth":2},{"value":"Next.js 中实例化 PrismaClient","url":"#nextjs-中实例化-prismaclient","depth":2},{"value":"详情页面实现","url":"#详情页面实现","depth":2},{"value":"翻页接口","url":"#翻页接口","depth":3},{"value":"滚动翻页","url":"#滚动翻页","depth":3},{"value":"小结","url":"#小结","depth":2},{"value":"后续","url":"#后续","depth":2}],"frontMatter":{"readingTime":{"text":"18 min read","minutes":17.61,"time":1056600,"words":3522},"slug":"使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站","fileName":"使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站.md","title":"使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站","date":"2022-10-11T15:57:14.000Z","lastmod":"2023/1/25 11:42:57","tags":["前端","React.js"],"draft":false,"summary":"本文将以实现一个视频网站为例，介绍 Next.js 和 Prisma 开发的全过程，prisma 对于 Next.js 来说，可谓是如虎添翼，有了它们，我们前端工程师轻松步入了全栈开发。","images":"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f670f626e68949df8f2a0479c8ac3833~tplv-k3u1fbpfcp-watermark.image?","authors":["default"],"layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.19,"time":11400,"words":38},"slug":["default"],"fileName":"default.md","name":"随风","avatar":"/static/images/avatar.jpeg","occupation":"前端工程师","company":"分享 JavaScript 热门框架，记录前端工程师学习成长历程。","email":"tianping888@163.com","juejin":"https://juejin.cn","zhihu":"https://www.zhihu.com","github":"https://github.com/balac2015","date":null}],"prev":{"title":"使用 Notion 数据库进行 Next.js 应用全栈开发","date":"2022-09-27T15:49:28.000Z","lastmod":"2023/1/25 11:42:59","tags":["React.js","数据库"],"draft":false,"summary":"今天我就得带大家来白嫖一下 Notion 数据库，让我们的个人应用轻松上线，本文记录了利用 Next.js 和 Notion API 编写了一个前端刷题网站的全过程。","images":"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e025d77556e4073989114847ff39959~tplv-k3u1fbpfcp-watermark.image?","authors":["default"],"layout":"PostLayout","slug":"使用 Notion 数据库进行 Next.js 应用全栈开发"},"next":{"title":"使用 NextAuth.js 给 Next.js 应用添加鉴权与认证","date":"2022-10-17T16:12:49.000Z","lastmod":"2023/1/25 11:42:55","tags":["React.js"],"draft":false,"summary":"在上一篇文章中，我们使用 prisma 和 Next.js，创建了一个视频网站，本文将继续开发视频网站，实现邮箱登录、 Github 授权登录，以及密码登录。","images":"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fca150f8a98e4692ba770f4523171bf5~tplv-k3u1fbpfcp-watermark.image?","authors":["default"],"layout":"PostLayout","slug":"使用 NextAuth.js 给 Next.js 应用添加鉴权与认证"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["使用 Next.js、 Prisma 和 PostgreSQL 全栈开发视频网站"]},"buildId":"Ux8AS9faFauxpggf8Sa_-","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>